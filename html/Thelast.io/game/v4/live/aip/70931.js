"use strict";(self.__VM_WPK_C_LR__m=self.__VM_WPK_C_LR__m||[]).push([[70931],{57930:(e,o,t)=>{t.r(o),t.d(o,{criteoIdSubmodule:()=>h,storage:()=>p});var n=t(90740),r=t(63013),a=t(53897),i=t(21251),c=t(34944),l=t(85075),d=t(11456),u=t(93177),s="criteo",p=(0,l.vM)({moduleType:d.fW,moduleName:s}),g="cto_bidid",v="cto_bundle",m="html5",f="cookie",b=new Date(0).toString(),I=new Date((0,r.timestamp)()+33696e6).toString();function y(e){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=(0,r.parseUrl)(e,{noDecodeWholeURL:!0});return o?"".concat(t.hostname):"".concat(t.protocol,"://").concat(t.hostname).concat(t.port?":"+t.port:"","/")}function S(e,o){var t,n;return(null==e||null===(t=e.storage)||void 0===t?void 0:t.type)===m?p.getDataFromLocalStorage(o):(null==e||null===(n=e.storage)||void 0===n?void 0:n.type)===f?p.getCookie(o):p.getCookie(o)||p.getDataFromLocalStorage(o)}function _(e,o,t,n){var r,a;o&&t&&((null==e||null===(r=e.storage)||void 0===r?void 0:r.type)===m?p.setDataInLocalStorage(o,t):((null==e||null===(a=e.storage)||void 0===a?void 0:a.type)===f||p.setDataInLocalStorage(o,t),C(o,t,I,n,!0)))}function C(e,o,t,n,r){for(var a=n.split("."),i=0;i<a.length;++i){var c=a.slice(a.length-i-1,a.length).join(".");try{if(p.setCookie(e,o,t,null,"."+c),r){var l=p.getCookie(e);if(l&&l===o)break}}catch(e){}}}var h={name:s,gvlid:91,decode:function(e){return e},getId:function(e){var o=function(e){return{bundle:S(e,v),dnaBundle:S(e,"cto_dna_bundle"),bidId:S(e,g)}}(e);return{id:o.bidId?{criteoId:o.bidId}:void 0,callback:function(t){return function(e,o,t){var n,c,l,d,s=(void 0===(null==e||null===(n=e.storage)||void 0===n?void 0:n.type)||(null==e||null===(c=e.storage)||void 0===c?void 0:c.type)===f)&&p.cookiesAreEnabled(),I=(void 0===(null==e||null===(l=e.storage)||void 0===l?void 0:l.type)||(null==e||null===(d=e.storage)||void 0===d?void 0:d.type)===m)&&p.localStorageIsEnabled(),S=y((0,i.EN)().page),h=y(document.location.href,!0),U="undefined"!=typeof criteo_pubtag,D=function(e,o,t,n,r,a,i){var c="https://gum.criteo.com/sid/json?origin=prebid"+"".concat(e?"&topUrl="+encodeURIComponent(e):"")+"".concat(o?"&domain="+encodeURIComponent(o):"")+"".concat(t?"&bundle="+encodeURIComponent(t):"")+"".concat(n?"&info="+encodeURIComponent(n):"")+"".concat(r?"&cw=1":"")+"".concat(i?"&pbt=1":"")+"".concat(a?"&lsw=1":""),l=u.t6.getConsentData();l&&(c+="&us_privacy=".concat(encodeURIComponent(l)));var d=u.mW.getConsentData();d&&(c+="".concat(d.consentString?"&gdprString="+encodeURIComponent(d.consentString):""),c+="&gdpr=".concat(!0===d.gdprApplies?1:0));var s=u.ad.getConsentData();return s&&(c+="".concat(s.gppString?"&gpp="+encodeURIComponent(s.gppString):""),c+="".concat(s.applicableSections?"&gpp_sid="+encodeURIComponent(s.applicableSections):"")),c}(S,h,o.bundle,o.dnaBundle,s,I,U),R={success:function(o){var n,i=JSON.parse(o);if(i.pixels&&i.pixels.forEach(function(o){return function(e,o,t){t.writeBundleInStorage&&t.bundlePropertyName&&t.storageKeyName?(0,a.RD)(t.pixelUrl,{success:function(n){if(n){var r=JSON.parse(n);r&&r[t.bundlePropertyName]&&_(e,t.storageKeyName,r[t.bundlePropertyName],o)}},error:function(e){(0,r.logError)("criteoIdSystem: unable to sync user id",e)}},void 0,{method:"GET",withCredentials:!0}):(0,r.triggerPixel)(t.pixelUrl)}(e,h,o)}),i.acwsUrl?("string"==typeof i.acwsUrl?[i.acwsUrl]:i.acwsUrl).forEach(function(e){return(0,r.triggerPixel)(e)}):i.bundle&&_(e,v,i.bundle,h),i.bidId){_(e,g,i.bidId,h);var c={criteoId:i.bidId};t(c)}else C(n=g,"",b,h,!0),p.removeDataFromLocalStorage(n),t()},error:function(e){(0,r.logError)("criteoIdSystem: unable to sync user id",e),t()}};(0,a.RD)(D,R,void 0,{method:"GET",contentType:"application/json",withCredentials:!0})}(e,o,t)}}},eids:{criteoId:{source:"criteo.com",atype:1}}};(0,c.bz)("userId",h),(0,n.E)("criteoIdSystem")}}]);