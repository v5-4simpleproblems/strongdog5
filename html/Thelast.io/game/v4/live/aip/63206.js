"use strict";(self.__VM_WPK_C_LR__m=self.__VM_WPK_C_LR__m||[]).push([[63206],{46699:(e,t,r)=>{r.d(t,{FE:()=>c,GR:()=>l});var o=r(45458),i=r(80296),n=r(70433),a=r(63172),d=r(63013),s=Object.freeze([].concat((0,o.A)(["device.sua","source.schain","regs.gdpr","regs.us_privacy","regs.gpp","regs.gpp_sid","user.consent","user.eids"].map(function(e){return function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return"".concat(e,".ext.").concat(t)},o=[(t=e.split(".")).slice(0,t.length-1).join("."),t[t.length-1]],d=(0,i.A)(o,2),s=d[0],c=d[1];return r=r(s,c),function(e){var t=(0,n.A)(e,s);if(null!=(null==t?void 0:t[c]))return(0,a.J)(e,r,t[c]),function(){return delete t[c]}}}(e)})),(0,o.A)(["app","content","site","user"].map(function(e){return function(t){var r,i=null===(r=t[e])||void 0===r?void 0:r.kwarray;if(null!=i){var n=(t[e].keywords||"").split(",");return Array.isArray(i)&&n.push.apply(n,(0,o.A)(i)),t[e].keywords=n.join(","),function(){return delete t[e].kwarray}}}}))));function c(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s;return function(r){return t.forEach(function(t){try{var o=t(r);"function"==typeof o&&e&&o()}catch(e){(0,d.logError)("Error translating request to ORTB 2.5",e)}}),r}}var l=c()},93861:(e,t,r)=>{r.r(t),r.d(t,{defaultSize:()=>x,getRoundedBid:()=>R,getWidthAndHeightFromVideoObject:()=>B,injectAdIdsIntoAllBidResponses:()=>_,ozoneAddStandardProperties:()=>S,ozoneGetAllBidsForBidId:()=>O,ozoneGetWinnerForRequestBid:()=>w,spec:()=>A});var o=r(82284),i=r(90740),n=r(70433),a=r(63013),d=r(63172),s=r(67436),c=r(55074),l=r(75181),u=r(31860),g=r(98936),p=r(21251),f=r(46699);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=Array(t);r<t;r++)o[r]=e[r];return o}var b,h="ozone",v="https://elb.the-ozone-project.com",y="oz",I="4.0.0",A={gvlid:524,version:I,code:h,supportedMediaTypes:[c.G_,c.D4],cookieSyncBag:{publisherId:null,siteId:null,userIdObject:{}},propertyBag:{pageId:null,buildRequestsStart:0,buildRequestsEnd:0},getAuctionUrl:function(){var e=l.$W.getConfig("ozone.endpointOverride")||{};return e.auctionUrl?e.auctionUrl:(e.origin||v)+"/openrtb2/auction"},getCookieSyncUrl:function(){var e=l.$W.getConfig("ozone.endpointOverride")||{};return e.cookieSyncUrl?e.cookieSyncUrl:(e.origin||v)+"/static/load-cookie.html"},getRendererUrl:function(){return(l.$W.getConfig("ozone.endpointOverride")||{}).rendererUrl||"https://prebid.the-ozone-project.com/ozone-renderer.js"},getVideoPlacementValue:function(e){return["instream","outstream"].indexOf(e)<0?null:(0,n.A)(l.$W.getConfig("ozone.videoParams"),e)},getBatchRequests:function(){var e=this.getGetParametersAsObject();if(e.batchRequests&&e.batchRequests.toString().match(/^[0-9]+$/))return parseInt(e.batchRequests);var t=l.$W.getConfig("ozone.batchRequests");return!0===t?10:"number"==typeof t&&t>0&&t},isBidRequestValid:function(e){var t="VALIDATION FAILED";(0,a.logInfo)("isBidRequestValid : ",l.$W.getConfig(),e);var r=e.adUnitCode,i="".concat(t," : missing {param} : siteId, placementId and publisherId are REQUIRED");if(!(0,a.getBidIdParameter)("placementId",e.params))return(0,a.logError)(i.replace("{param}","placementId"),r),!1;if(!this.isValidPlacementId(e.params.placementId))return(0,a.logError)("".concat(t," : placementId must be exactly 10 numbers"),r),!1;if(!(0,a.getBidIdParameter)("publisherId",e.params))return(0,a.logError)(i.replace("{param}","publisherId"),r),!1;if(!e.params.publisherId.toString().match(/^[a-zA-Z0-9\-]{12}$/))return(0,a.logError)("".concat(t," : publisherId must be /^[a-zA-Z0-9\\-]{12}$/"),r),!1;if(!(0,a.getBidIdParameter)("siteId",e.params))return(0,a.logError)(i.replace("{param}","siteId"),r),!1;if(!e.params.siteId.toString().match(/^[0-9]{10}$/))return(0,a.logError)("".concat(t," : siteId must be /^[0-9]{10}$/"),r),!1;if(e.params.hasOwnProperty("customParams"))return(0,a.logError)("".concat(t," : customParams should be renamed: customData"),r),!1;if(e.params.hasOwnProperty("customData")){if(!(0,a.isArray)(e.params.customData))return(0,a.logError)("".concat(t," : customData is not an Array"),r),!1;if(e.params.customData.length<1)return(0,a.logError)("".concat(t," : empty customData"),r),!1;if(!e.params.customData[0].hasOwnProperty("targeting"))return(0,a.logError)("".concat(t," :no customData[0].targeting"),r),!1;if("object"!=(0,o.A)(e.params.customData[0].targeting))return(0,a.logError)("".concat(t," : customData[0].targeting is not an Object"),r),!1}if(e.hasOwnProperty("mediaTypes")&&e.mediaTypes.hasOwnProperty(c.G_)){var n,d;if(null===(n=e.mediaTypes)||void 0===n||null===(n=n[c.G_])||void 0===n||!n.context)return(0,a.logError)("".concat(t," No video context key/value")),!1;if(["instream","outstream"].indexOf(null===(d=e.mediaTypes)||void 0===d||null===(d=d[c.G_])||void 0===d?void 0:d.context)<0)return(0,a.logError)("".concat(t," video.context is invalid.")),!1}return!0},isValidPlacementId:function(e){return e.toString().match(/^[0-9]{10}$/)},buildRequests:function(e,t){var r,i,s=this;this.propertyBag.buildRequestsStart=(new Date).getTime();var u=h,g=y;if((0,a.logInfo)("buildRequests time: ".concat(this.propertyBag.buildRequestsStart," v ").concat(I," validBidRequests"),(0,a.deepClone)(e),"bidderRequest",(0,a.deepClone)(t)),this.blockTheRequest())return[];var m=!!t.fledgeEnabled,b={publisherId:"",siteId:""};e.length>0&&(Object.assign(this.cookieSyncBag.userIdObject,this.findAllUserIdsFromEids(e[0])),this.cookieSyncBag.siteId=(0,n.A)(e[0],"params.siteId"),this.cookieSyncBag.publisherId=(0,n.A)(e[0],"params.publisherId"),b=e[0].params),(0,a.logInfo)("cookie sync bag",this.cookieSyncBag);var v=l.$W.getConfig("ozone.singleRequest");v=!1!==v;var A={},_=(0,n.A)(t,"ortb2",null);(0,a.logInfo)("got ortb2 fpd: ",_),_&&(0,n.A)(_,"user")&&((0,a.logInfo)("added FPD user object"),A.user=_.user);var x=this.getGetParametersAsObject(),w="oztestmode",O=x[w]||null;A.device=(null==t||null===(r=t.ortb2)||void 0===r?void 0:r.device)||{};var R=this.getPlacementIdOverrideFromGetParam(),S=null,C=(0,n.A)(e,"0.ortb2.source.tid");"0"===C&&(C=null);var P=e.map(function(e){var t={},r=R||s.getPlacementId(e);t.id=e.bidId,t.tagid=r,t.secure="https"===(0,a.parseUrl)((0,p.EN)().page).protocol?1:0;var i=[];if(e.hasOwnProperty("mediaTypes")){if(e.mediaTypes.hasOwnProperty(c.D4)&&(i=e.mediaTypes[c.D4].sizes,(0,a.logInfo)("setting banner size from mediaTypes.banner for bidId "+t.id+": ",i)),e.mediaTypes.hasOwnProperty(c.G_)){if((0,a.logInfo)("openrtb 2.5 compliant video"),"object"==(0,o.A)(e.mediaTypes[c.G_])){var l=(0,n.A)(e,"params.video",{});t.video=s.unpackVideoConfigIntoIABformat(e.mediaTypes[c.G_],l),t.video=s.addVideoDefaults(t.video,e.mediaTypes[c.G_],l)}var g=B(t.video);(0,a.logInfo)("setting video object ".concat(t.id," from mediaTypes.video: "),t.video,"wh=",g);var f="setting obj.video.format to be ";if(g&&"object"===(0,o.A)(g)){t.video.w=g.w,t.video.h=g.h;var b=T(t.video);b&&Array.isArray(b[0])?((0,a.logInfo)("".concat(f," an array of objects")),t.video.ext.format=[g]):((0,a.logInfo)("".concat(f," an object")),t.video.ext.format=g)}else(0,a.logWarn)("Failed ".concat(f," anything - bad config"))}e.mediaTypes.hasOwnProperty(c.s6)&&(t.native=e.mediaTypes[c.s6],(0,a.logInfo)("setting native object ".concat(t.id," from mediaTypes.native element:"),t.native)),e.hasOwnProperty("getFloor")?(t.floor=s.getFloorObjectForAuction(e),(0,a.logInfo)("obj.floor is : ",t.floor)):(0,a.logInfo)("no getFloor property")}else e.hasOwnProperty("sizes")?i=e.sizes:(0,a.logInfo)("no mediaTypes or sizes array. Cannot set sizes for banner type");if(i.length>0&&(t.banner={topframe:1,w:i[0][0]||0,h:i[0][1]||0,format:i.map(function(e){return{w:e[0],h:e[1]}})}),t.placementId=r,(0,d.J)(t,"ext.prebid",{storedrequest:{id:r}}),t.ext[u]={},t.ext[u].adUnitCode=e.adUnitCode,e.params.hasOwnProperty("customData")&&(t.ext[u].customData=e.params.customData),e.params.hasOwnProperty("ozFloor")){var h=parseFloat(e.params.ozFloor);isNaN(h)?(0,a.logError)("Ignoring invalid ozFloor value for adunit code: ".concat(e.adUnitCode)):t.ext[u].ozFloor=h}if((0,a.logInfo)("obj.ext.".concat(u," is "),t.ext[u]),null!=O)if((0,a.logInfo)("setting isTestMode: ".concat(O)),t.ext[u].hasOwnProperty("customData"))for(var v=0;v<t.ext[u].customData.length;v++)t.ext[u].customData[v].targeting[w]=O;else t.ext[u].customData=[{settings:{},targeting:{}}],t.ext[u].customData[0].targeting[w]=O;_&&(0,n.A)(_,"site")&&((0,a.logInfo)("adding fpd.site"),(0,n.A)(t,"ext.".concat(u,".customData.0.targeting"),!1)?Object.assign(t.ext[u].customData[0].targeting,_.site):(0,d.J)(t,"ext.".concat(u,".customData.0.targeting"),_.site)),!S&&(0,n.A)(e,"schain")&&(S=e.schain);var y=(0,n.A)(e,"ortb2Imp.ext.gpid");y&&(0,d.J)(t,"ext.gpid",y);var I=(0,n.A)(e,"ortb2Imp.ext.tid");if(I&&(t.ext.tid=I),C&&(t.ext.auctionId=C),m){var A=(0,n.A)(e,"ortb2Imp.ext.ae");(0,a.isInteger)(A)?(0,d.J)(t,"ext.ae",A):(0,a.logError)("ignoring ortb2Imp.ext.ae - not an integer for obj.id=".concat(t.id))}return t}),j={};if(j[u]={},j[u]["".concat(g,"_pb_v")]=I,j[u]["".concat(g,"_rw")]=R?1:0,e.length>0){var E=this.cookieSyncBag.userIdObject;E.hasOwnProperty("pubcid.org")&&(j[u].pubcid=E["pubcid.org"])}j[u].pv=this.getPageId();var z=l.$W.getConfig("ozone.oz_omp_floor");(0,a.logInfo)("".concat(g,"_omp_floor dollar value = "),z),"number"==typeof z?j[u]["".concat(g,"_omp_floor")]=z:void 0!==z&&(0,a.logError)("IF set, ".concat(g,"_omp_floor must be a number eg. 1.55. Found:")+(0,o.A)(z));var D=l.$W.getConfig("ozone.oz_whitelist_adserver_keys"),q=(0,a.isArray)(D)&&D.length>0;j[u][g+"_kvp_rw"]=q?1:0;var k=l.$W.getConfig("ozone.endpointOverride");(null!=k&&k.origin||null!=k&&k.auctionUrl)&&(j[u].origin=k.auctionUrl||k.origin);var F=(0,n.A)(e,"0.userIdAsEids",[]);if(A.site={publisher:{id:b.publisherId},page:(0,p.EN)().page,id:b.siteId},t&&t.gdprConsent){(0,a.logInfo)("ADDING GDPR");var U=(0,n.A)(t,"gdprConsent.apiVersion",1);A.regs={ext:{gdpr:t.gdprConsent.gdprApplies?1:0,apiVersion:U}},(0,n.A)(A,"regs.ext.gdpr")?(0,d.J)(A,"user.ext.consent",t.gdprConsent.consentString):(0,a.logWarn)("**** Strange CMP info: bidderRequest.gdprConsent exists BUT bidderRequest.gdprConsent.gdprApplies is false. See bidderRequest logged above. ****")}else(0,a.logInfo)("WILL NOT ADD GDPR info; no bidderRequest.gdprConsent object");t&&t.uspConsent?((0,a.logInfo)("ADDING USP consent info"),(0,d.J)(A,"regs.ext.us_privacy",t.uspConsent)):(0,a.logInfo)("WILL NOT ADD USP consent info; no bidderRequest.uspConsent."),null!=t&&null!==(i=t.ortb2)&&void 0!==i&&null!==(i=i.regs)&&void 0!==i&&i.gpp&&((0,d.J)(A,"regs.gpp",t.ortb2.regs.gpp),(0,d.J)(A,"regs.gpp_sid",t.ortb2.regs.gpp_sid)),S&&((0,a.logInfo)("schain found"),(0,d.J)(A,"source.ext.schain",S)),!0===l.$W.getConfig("coppa")&&(0,d.J)(A,"regs.coppa",1),j[u].cookieDeprecationLabel=(0,n.A)(t,"ortb2.device.ext.cdep","none"),(0,a.logInfo)("cookieDeprecationLabel ortb2.device.ext.cdep = ".concat(j[u].cookieDeprecationLabel));var W=this.getBatchRequests();if("number"==typeof W){(0,a.logInfo)("Batching = ".concat(W));for(var G=[],V=0;V<P.length;V+=W)A.id=(0,a.generateUUID)(),(0,d.J)(A,"user.ext.eids",F),C&&(0,d.J)(A,"source.tid",C),A.imp=P.slice(V,V+W),A.ext=j,(0,f.GR)(A),A.imp.length>0&&G.push({method:"POST",url:this.getAuctionUrl(),data:JSON.stringify(A),bidderRequest:t});return(0,a.logInfo)("batch request going to return : ",G),G}if(v){(0,a.logInfo)("single request starting"),A.id=(0,a.generateUUID)(),A.imp=P,A.ext=j,(0,f.GR)(A),(0,d.J)(A,"user.ext.eids",F),C&&(0,d.J)(A,"source.tid",C);var $={method:"POST",url:this.getAuctionUrl(),data:JSON.stringify(A),bidderRequest:t};return this.propertyBag.buildRequestsEnd=(new Date).getTime(),(0,a.logInfo)("buildRequests going to return for single at time ".concat(this.propertyBag.buildRequestsEnd," (took ").concat(this.propertyBag.buildRequestsEnd-this.propertyBag.buildRequestsStart,"ms): "),(0,a.deepClone)($)),$}var N=P.map(function(e){(0,a.logInfo)("non-single response, working on imp : ",e);var r=Object.assign({},A);return r.id=(0,a.generateUUID)(),r.imp=[e],r.ext=j,(0,d.J)(r,"user.ext.eids",F),C&&(0,d.J)(r,"source.tid",C),(0,f.GR)(r),{method:"POST",url:s.getAuctionUrl(),data:JSON.stringify(r),bidderRequest:t}});return this.propertyBag.buildRequestsEnd=(new Date).getTime(),(0,a.logInfo)("buildRequests going to return for non-single at time ".concat(this.propertyBag.buildRequestsEnd," (took ").concat(this.propertyBag.buildRequestsEnd-this.propertyBag.buildRequestsStart,"ms): "),N),N},getFloorObjectForAuction:function(e){var t={banner:(0,n.A)(e,"mediaTypes.banner.sizes",null),video:(0,n.A)(e,"mediaTypes.video.playerSize",null),native:(0,n.A)(e,"mediaTypes.native.image.sizes",null)};(0,a.logInfo)("getFloorObjectForAuction mediaTypesSizes : ",t);var r={};return t.banner&&(r.banner=e.getFloor({mediaType:"banner",currency:"USD",size:t.banner[0]})),t.video&&(r.video=e.getFloor({mediaType:"video",currency:"USD",size:t.video[0]})),t.native&&(r.native=e.getFloor({mediaType:"native",currency:"USD",size:t.native[0]})),(0,a.logInfo)("getFloorObjectForAuction returning : ",(0,a.deepClone)(r)),r},interpretResponse:function(e,t){var r=this,i=(new Date).getTime(),d=h,s=y;(0,a.logInfo)("interpretResponse time: ".concat(i," . Time between buildRequests done and interpretResponse start was ").concat(i-this.propertyBag.buildRequestsEnd,"ms")),(0,a.logInfo)("serverResponse, request",(0,a.deepClone)(e),(0,a.deepClone)(t));var u=(e=e.body||{}).id;if(!e.hasOwnProperty("seatbid"))return[];if("object"!==(0,o.A)(e.seatbid))return[];var g,p=[],f=l.$W.getConfig("ozone.enhancedAdserverTargeting");(0,a.logInfo)("enhancedAdserverTargeting",f),void 0===f&&(f=!0),(0,a.logInfo)("enhancedAdserverTargeting",f),e.seatbid=_(e.seatbid),e.seatbid=this.removeSingleBidderMultipleBids(e.seatbid);for(var m=l.$W.getConfig("ozone.oz_omp_floor"),b="number"==typeof m,v=l.$W.getConfig("ozone.oz_whitelist_adserver_keys"),A=(0,a.isArray)(v)&&v.length>0,B=0;B<e.seatbid.length;B++)for(var T=e.seatbid[B],P=function(){var o=r.getBidRequestForBidId(T.bid[j].impid,t.bidderRequest.bids);(0,a.logInfo)("seatbid:".concat(B,", bid:").concat(j," Going to set default w h for seatbid/bidRequest"),T.bid[j],o);var i=x(o),l=i.defaultWidth,h=i.defaultHeight,y=S(T.bid[j],l,h);y.meta={advertiserDomains:y.adomain||[]};var _=null,P=!1,E=(0,n.A)(y,"ext.prebid.type");(0,a.logInfo)("this bid type is : ".concat(E));var z={};if(E===c.G_)if(P=!0,r.setBidMediaTypeIfNotExist(y,c.G_),"outstream"===(_=r.getVideoContextForBidId(y.bidId,t.bidderRequest.bids)))(0,a.logInfo)("setting thisBid.mediaType = VIDEO & attach a renderer to OUTSTREAM video"),y.renderer=C(y.bidId),y.vastUrl="https://".concat((0,n.A)(y,"ext.prebid.targeting.hb_cache_host","missing_host")).concat((0,n.A)(y,"ext.prebid.targeting.hb_cache_path","missing_path"),"?uuid=").concat((0,n.A)(y,"ext.prebid.targeting.hb_uuid","missing_uuid")),y.vastXml=y.adm;else if((0,a.logInfo)("not an outstream video (presumably instream), will set thisBid.mediaType = VIDEO and thisBid.vastUrl and not attach a renderer"),y.vastUrl="https://".concat((0,n.A)(y,"ext.prebid.targeting.hb_cache_host","missing_host")).concat((0,n.A)(y,"ext.prebid.targeting.hb_cache_path","missing_path"),"?uuid=").concat((0,n.A)(y,"ext.prebid.targeting.hb_uuid","missing_uuid")),y.hasOwnProperty("videoCacheKey"))(0,a.logInfo)("videoCacheKey already exists on the bid object, will not add it");else{var D=(0,n.A)(y,"ext.prebid.targeting.hb_uuid","no_hb_uuid");(0,a.logInfo)("Adding videoCacheKey: ".concat(D)),y.videoCacheKey=D}else r.setBidMediaTypeIfNotExist(y,c.D4);if(z=Object.assign(z,(0,n.A)(y,"ext.prebid.targeting",{})),f){var q=O(y.bidId,e.seatbid,l,h);(0,a.logInfo)("Going to iterate allBidsForThisBidId",(0,a.deepClone)(q)),Object.keys(q).forEach(function(e,t,r){(0,a.logInfo)("adding adserverTargeting for ".concat(e," for bidId ").concat(y.bidId)),z[s+"_"+e]=e,z[s+"_"+e+"_crid"]=String(q[e].crid),z[s+"_"+e+"_adv"]=String(q[e].adomain),z[s+"_"+e+"_adId"]=String(q[e].adId),z[s+"_"+e+"_pb_r"]=R(q[e].price,q[e].ext.prebid.type),z[s+"_"+e+"_size"]=String(q[e].width)+"x"+String(q[e].height),q[e].hasOwnProperty("dealid")&&(z[s+"_"+e+"_dealid"]=String(q[e].dealid)),b&&(z[s+"_"+e+"_omp"]=q[e].price>=m?"1":"0"),P&&(z[s+"_"+e+"_vid"]=_);var o=(0,n.A)(q[e],"ext.bidder.".concat(d,".floor"),null);null!=o&&(z[s+"_"+e+"_flr"]=o);var i=(0,n.A)(q[e],"ext.bidder.".concat(d,".ruleId"),null);null!=i&&(z[s+"_"+e+"_rid"]=i),e.match(/^ozappnexus/)&&(z[s+"_"+e+"_sid"]=String(q[e].cid)),(g=(0,n.A)(q[e],"ext.prebid.labels",null))&&(z[s+"_"+e+"_labels"]=g.join(","))})}else{var k="".concat(d,".enhancedAdserverTargeting is set to false. No per-bid keys will be sent to adserver.");A?(0,a.logWarn)("Your adserver keys whitelist will be ignored - ".concat(k)):(0,a.logInfo)(k)}var F=w(y.bidId,e.seatbid),U=F.seat,W=F.bid;W=S(W,l,h),z[s+"_auc_id"]=String(u),z[s+"_winner"]=String(U),z[s+"_bid"]="true",z[s+"_cache_id"]=(0,n.A)(y,"ext.prebid.targeting.hb_cache_id","no-id"),z[s+"_uuid"]=(0,n.A)(y,"ext.prebid.targeting.hb_uuid","no-id"),f&&((g=(0,n.A)(W,"ext.prebid.labels",null))&&(z[s+"_labels"]=g.join(",")),z[s+"_imp_id"]=String(W.impid),z[s+"_pb_v"]=I,z[s+"_pb"]=W.price,z[s+"_pb_r"]=R(W.price,E),z[s+"_adId"]=String(W.adId),z[s+"_size"]="".concat(W.width,"x").concat(W.height)),A&&((0,a.logInfo)("Filtering out adserver targeting keys not in the whitelist: ",v),Object.keys(z).forEach(function(e){-1===v.indexOf(e)&&delete z[e]})),y.adserverTargeting=z,p.push(y)},j=0;j<T.bid.length;j++)P();var E=p,z=(0,n.A)(e,"ext.igi")||[];(0,a.isArray)(z)&&z.length>0&&(z=z.filter(function(e){return"object"===(0,o.A)(e)&&null!==e||((0,a.logWarn)("Removing malformed fledge auction config:",e),!1)}),E={bids:p,fledgeAuctionConfigs:z});var D=(new Date).getTime();return(0,a.logInfo)("interpretResponse going to return at time ".concat(D," (took ").concat(D-i,"ms) Time from buildRequests Start -> interpretRequests End = ").concat(D-this.propertyBag.buildRequestsStart,"ms")),(0,a.logInfo)("will return: ",(0,a.deepClone)(E)),E},setBidMediaTypeIfNotExist:function(e,t){e.hasOwnProperty("mediaType")?(0,a.logInfo)("found value for thisBid.mediaType: ".concat(e.mediaType)):((0,a.logInfo)("setting thisBid.mediaType = ".concat(t)),e.mediaType=t)},removeSingleBidderMultipleBids:function(e){for(var t=[],r=0;r<e.length;r++){for(var o=e[r],i={seat:o.seat,bid:[]},n=[],a=0;a<o.bid.length;a++){var d=o.bid[a];if(!n.includes(d.impid)){n.push(d.impid);for(var s=a+1;s<o.bid.length;s++)o.bid[s].impid===d.impid&&o.bid[s].price>d.price&&(d=o.bid[s]);i.bid.push(d)}}t.push(i)}return t},getUserSyncs:function(e,t,r,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if((0,a.logInfo)("getUserSyncs optionsType",e,"serverResponse",t,"gdprConsent",r,"usPrivacy",o,"cookieSyncBag",this.cookieSyncBag),!t||0===t.length)return[];var d=i.gppString,s=void 0===d?"":d,c=i.applicableSections,u=void 0===c?[]:c;if(e.iframeEnabled){var g=[];for(var p in l.$W.getConfig("debug")&&g.push("pbjs_debug=true"),g.push("gdpr="+((0,n.A)(r,"gdprApplies",!1)?"1":"0")),g.push("gdpr_consent="+(0,n.A)(r,"consentString","")),g.push("usp_consent="+(o||"")),g.push("gpp="+s),Array.isArray(u)&&g.push("gpp_sid=".concat(u.join())),this.cookieSyncBag.userIdObject)g.push(p+"="+this.cookieSyncBag.userIdObject[p]);g.push("publisherId="+this.cookieSyncBag.publisherId),g.push("siteId="+this.cookieSyncBag.siteId),g.push("cb="+Date.now()),g.push("bidder="+h);var f=g.join("&");return f.length>0&&(f="?"+f),(0,a.logInfo)("getUserSyncs going to return cookie sync url : "+this.getCookieSyncUrl()+f),[{type:"iframe",url:this.getCookieSyncUrl()+f}]}},getBidRequestForBidId:function(e,t){for(var r=0;r<t.length;r++)if(t[r].bidId===e)return t[r];return null},getVideoContextForBidId:function(e,t){var r=this.getBidRequestForBidId(e,t);return null!=r?(0,n.A)(r,"mediaTypes.video.context","unknown"):null},findAllUserIdsFromEids:function(e){var t={};if(!e.hasOwnProperty("userIdAsEids"))return(0,a.logInfo)("findAllUserIdsFromEids - no bidRequest.userIdAsEids object was found on the bid!"),this.tryGetPubCidFromOldLocation(t,e),t;try{var r,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return m(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a=!0,d=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){d=!0,n=e},f:function(){try{a||null==r.return||r.return()}finally{if(d)throw n}}}}(e.userIdAsEids);try{for(o.s();!(r=o.n()).done;){var i=r.value;t[i.source]=(0,n.A)(i,"uids.0.id")}}catch(e){o.e(e)}finally{o.f()}this.tryGetPubCidFromOldLocation(t,e)}catch(e){(0,a.logError)("findAllUserIdsFromEids - error while processing bidRequest.userIdAsEids",e)}return t},tryGetPubCidFromOldLocation:function(e,t){if(!e.hasOwnProperty("pubcid")){var r=(0,n.A)(t,"crumbs.pubcid");r&&(e["pubcid.org"]=r)}},getPlacementId:function(e){return e.params.placementId.toString()},getPlacementIdOverrideFromGetParam:function(){var e=this.getGetParametersAsObject();if(e.hasOwnProperty(y+"storedrequest")){if(this.isValidPlacementId(e[y+"storedrequest"]))return(0,a.logInfo)("using GET ".concat(y,"storedrequest=")+e[y+"storedrequest"]+" to replace placementId"),e[y+"storedrequest"];(0,a.logError)("GET ".concat(y,"storedrequest FAILED VALIDATION - will not use it"))}return null},getGetParametersAsObject:function(){var e=(0,a.parseUrl)((0,p.EN)().location);return(0,a.logInfo)("getGetParametersAsObject found:",e.search),e.search},blockTheRequest:function(){return!1===l.$W.getConfig("ozone.oz_request")&&((0,a.logWarn)("Will not allow the auction : oz_request is set to false"),!0)},getPageId:function(){if(null==this.propertyBag.pageId){for(var e="",t=20;t>0;t--)e+="0123456789abcdefghijklmnopqrstuvwxyz"[Math.floor(36*Math.random())];this.propertyBag.pageId=(new Date).getTime()+"_"+e}return this.propertyBag.pageId},unpackVideoConfigIntoIABformat:function(e,t){var r={ext:{}};return r=this._unpackVideoConfigIntoIABformat(r,e),this._unpackVideoConfigIntoIABformat(r,t)},_unpackVideoConfigIntoIABformat:function(e,t){var r,i=["mimes","minduration","maxduration","protocols","w","h","startdelay","placement","plcmt","linearity","skip","skipmin","skipafter","sequence","battr","maxextended","minbitrate","maxbitrate","boxingallowed","playbackmethod","playbackend","delivery","pos","companionad","api","companiontype"],n=function(o){r=!1,i.forEach(function(i){i===o&&(e[o]=t[o],r=!0)}),r||(e.ext[o]=t[o])};for(var d in t)n(d);return t.hasOwnProperty("ext")&&"object"===(0,o.A)(t.ext)&&(e.hasOwnProperty("ext")?e.ext=(0,a.mergeDeep)(e.ext,t.ext):e.ext=t.ext),e},addVideoDefaults:function(e,t,r){var o=this,i=function(t,r){if(t){var i=o.getVideoPlacementValue((0,n.A)(t,"context"));i&&(e.placement=i);var a=(0,n.A)(t,"skippable",null);null==a?r&&!e.hasOwnProperty("skip")&&(e.skip=0):e.skip=a?1:0}};return i(t,!1),i(r,!0),e},getLoggableBidObject:function(e){var t={ad:e.ad,adId:e.adId,adUnitCode:e.adUnitCode,adm:e.adm,adomain:e.adomain,adserverTargeting:e.adserverTargeting,auctionId:e.auctionId,bidId:e.bidId,bidder:e.bidder,bidderCode:e.bidderCode,cpm:e.cpm,creativeId:e.creativeId,crid:e.crid,currency:e.currency,h:e.h,w:e.w,impid:e.impid,mediaType:e.mediaType,params:e.params,price:e.price,transactionId:e.transactionId,ttl:e.ttl,ortb2:(0,n.A)(e,"ortb2"),ortb2Imp:(0,n.A)(e,"ortb2Imp")};return e.hasOwnProperty("floorData")&&(t.floorData=e.floorData),t}};function _(e){(0,a.logInfo)("injectAdIdsIntoAllBidResponses",(0,a.deepClone)(e));for(var t=0;t<e.length;t++)for(var r=e[t],o=0;o<r.bid.length;o++)r.bid[o].adId="".concat(r.bid[o].impid,"-").concat(t,"-").concat(y,"-").concat(o);return e}function x(e){if(!e)return(0,a.logInfo)("defaultSize received empty bid obj! going to return fixed default size"),{defaultHeight:250,defaultWidth:300};var t=e.sizes||[],r=Array.isArray(t[0])?t[0]:t;return{defaultWidth:r[0],defaultHeight:r[1]}}function w(e,t){for(var r=null,o=null,i=0;i<t.length;i++)for(var n=t[i].bid,a=t[i].seat,d=0;d<n.length;d++)if(n[d].impid===e&&(null==r||r.price<n[d].price)){r=n[d],o=a;break}return{seat:o,bid:r}}function O(e,t,r,o){for(var i={},n=0;n<t.length;n++)for(var a=t[n].bid,d=t[n].seat,s=0;s<a.length;s++)a[s].impid===e&&(i.hasOwnProperty(d)?i[d].price<a[s].price&&(i[d]=S(a[s],r,o)):(i[d]=a[s],i[d]=S(a[s],r,o)));return i}function R(e,t){var r=l.$W.getConfig("mediaTypePriceGranularity.".concat(t)),i="auto",n=l.$W.getConfig("customPriceBucket");if("string"==typeof r)i=r;else if("object"===(0,o.A)(r))i="custom",n=r;else{var d=l.$W.getConfig("priceGranularity");"string"==typeof d&&(i=d),"custom"===d&&(i="custom")}var s=(0,u.j)(e,n,l.$W.getConfig("currency.granularityMultiplier"));return(0,a.logInfo)("getRoundedBid price:",e,"mediaType:",t,"bucketKey:",i),s[{medium:"med",custom:"custom",high:"high",low:"low",dense:"dense"}[i]||"auto"]}function S(e,t,r){return e.cpm=e.price,e.bidId=e.impid,e.requestId=e.impid,e.width=e.w||t,e.height=e.h||r,e.ad=e.adm,e.netRevenue=!0,e.creativeId=e.crid,e.currency="USD",e.ttl=300,e}function B(e){var t=T(e);return t?t[0]&&"object"===(0,o.A)(t[0])&&((0,a.logInfo)("getWidthAndHeightFromVideoObject found nested array inside playerSize.",t[0]),"number"!=typeof(t=t[0])[0]&&"string"!=typeof t[0])?((0,a.logError)("getWidthAndHeightFromVideoObject found non-number/string type inside the INNER array in playerSize. This is totally wrong - cannot continue.",t[0]),null):2!==t.length?((0,a.logError)("getWidthAndHeightFromVideoObject found playerSize with length of "+t.length+". This is totally wrong - cannot continue."),null):{w:t[0],h:t[1]}:null}function T(e){(0,a.logInfo)("getPlayerSizeFromObject received object",e);var t=(0,n.A)(e,"playerSize");return t||(t=(0,n.A)(e,"ext.playerSize")),t?"object"!==(0,o.A)(t)?((0,a.logError)("getPlayerSizeFromObject FAILED: playerSize is not an object/array",e),null):t:((0,a.logError)("getPlayerSizeFromObject FAILED: no playerSize in video object or ext",e),null)}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!b){b=g.A4.install({url:A.getRendererUrl(),config:t,loaded:!1,adUnitCode:e});try{b.setRender(P)}catch(e){(0,a.logError)("Prebid Error calling renderer.setRender",b,e)}(0,a.logInfo)("created renderer object")}return b}function P(e){(0,a.logInfo)("outstreamRender got",(0,a.deepClone)(e)),e.renderer.push(function(){(0,a.logInfo)("outstreamRender: Going to execute window.ozoneVideo.outstreamRender"),window.ozoneVideo.outstreamRender(e)})}(0,s.a$)(A),(0,a.logInfo)("*BidAdapter ".concat(I," was loaded")),(0,i.E)("ozoneBidAdapter")}}]);