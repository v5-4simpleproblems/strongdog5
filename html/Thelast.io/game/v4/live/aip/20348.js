"use strict";(self.__VM_WPK_C_LR__m=self.__VM_WPK_C_LR__m||[]).push([[20348],{20348:(e,r,t)=>{t.d(r,{T:()=>m,A:()=>v});var i=t(80296),n=new WeakMap,o=t(63013),a=t(64467),s=t(55074),d=t(35564),u=t(84988),p=t(98757),l=t(37001),c=(0,a.A)((0,a.A)((0,a.A)({},p.S3,{fpd:{priority:99,fn:function(e,r){(0,o.mergeDeep)(e,r.ortb2)}},onlyOneClient:{priority:-99,fn:(0,l.i8)("ORTB request")},props:{fn:function(e,r){Object.assign(e,{id:e.id||(0,o.generateUUID)(),test:e.test||0});var t=parseInt(r.timeout,10);isNaN(t)||(e.tmax=t)}}}),p.Tb,{fpd:{priority:99,fn:function(e,r){(0,o.mergeDeep)(e,r.ortb2Imp)}},id:{fn:function(e,r){e.id=r.bidId}},banner:{fn:function(e,r,t){var i;if(!t.mediaType||t.mediaType===s.D4){var n=null==r||null===(i=r.mediaTypes)||void 0===i?void 0:i.banner;if(n){var a,d={topframe:!0===(0,o.inIframe)()?0:1};n.sizes&&null==(null===(a=r.ortb2Imp)||void 0===a||null===(a=a.banner)||void 0===a?void 0:a.format)&&(d.format=(0,o.sizesToSizeTuples)(n.sizes).map(o.sizeTupleToRtbSize)),n.hasOwnProperty("pos")&&(d.pos=n.pos),e.banner=(0,o.mergeDeep)(d,e.banner)}}}},pbadslot:{fn:function(e){var r,t,i=null===(r=e.ext)||void 0===r||null===(r=r.data)||void 0===r?void 0:r.pbadslot;i&&"string"==typeof i||null===(t=e.ext)||void 0===t||null===(t=t.data)||void 0===t||delete t.pbadslot}},secure:{fn:function(e,r){var t;e.secure=null!==(t=e.secure)&&void 0!==t?t:1}}}),p.WR,{mediaType:{priority:99,fn:u.K},banner:{fn:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).createPixel,r=void 0===e?function(e){return(0,o.createTrackPixelHtml)(decodeURIComponent(e),o.encodeMacroURI)}:e;return function(e,t){e.mediaType===s.D4&&(t.adm&&t.nurl?e.ad=r(t.nurl)+t.adm:t.adm?e.ad=t.adm:t.nurl&&(e.adUrl=t.nurl))}}()},props:{fn:function(e,r,t){var n,o,a,s;Object.entries({requestId:null===(n=t.bidRequest)||void 0===n?void 0:n.bidId,seatBidId:r.id,cpm:r.price,currency:t.ortbResponse.cur||t.currency,width:r.w,height:r.h,wratio:r.wratio,hratio:r.hratio,dealId:r.dealid,creative_id:r.crid,creativeId:r.crid,burl:r.burl,ttl:r.exp||t.ttl,netRevenue:t.netRevenue}).filter(function(e){var r=(0,i.A)(e,2);return r[0],void 0!==r[1]}).forEach(function(r){var t=(0,i.A)(r,2),n=t[0],o=t[1];return e[n]=o}),e.meta||(e.meta={}),r.adomain&&(e.meta.advertiserDomains=r.adomain),null!==(o=r.ext)&&void 0!==o&&o.dsa&&(e.meta.dsa=r.ext.dsa),r.cat&&(e.meta.primaryCatId=r.cat[0],e.meta.secondaryCatIds=r.cat.slice(1)),r.attr&&(e.meta.attr=r.attr),null!==(a=r.ext)&&void 0!==a&&a.eventtrackers&&(e.eventtrackers=(null!==(s=e.eventtrackers)&&void 0!==s?s:[]).concat(r.ext.eventtrackers))}}});c[p.Tb].native={fn:function(e,r,t){if(!t.mediaType||t.mediaType===s.s6){var i,n=r.nativeOrtbRequest;n&&(null!==(i=(n=Object.assign({},t.nativeRequest,n)).assets)&&void 0!==i&&i.length?e.native=(0,o.mergeDeep)({},{request:JSON.stringify(n),ver:n.ver},e.native):(0,o.logWarn)("mediaTypes.native is set, but no assets were specified. Native request skipped.",r))}}},c[p.WR].native={fn:function(e,r){if(e.mediaType===s.s6){var t;if(t="string"==typeof r.adm?JSON.parse(r.adm):r.adm,!(0,o.isPlainObject)(t)||!Array.isArray(t.assets))throw new Error("ORTB native response contained no assets");e.native={ortb:t}}}},c[p.Tb].video={fn:function(e,r,t){var n;if(!t.mediaType||t.mediaType===s.G_){var a=null==r||null===(n=r.mediaTypes)||void 0===n?void 0:n.video;if(!(0,o.isEmpty)(a)){var u=Object.fromEntries(Object.entries(a).filter(function(e){var r=(0,i.A)(e,1)[0];return d.Zy.has(r)}));if(a.playerSize){var p=(0,o.sizesToSizeTuples)(a.playerSize).map(o.sizeTupleToRtbSize);p.length>1&&(0,o.logWarn)("video request specifies more than one playerSize; all but the first will be ignored"),Object.assign(u,p[0])}e.video=(0,o.mergeDeep)(u,e.video)}}}},c[p.WR].video={fn:function(e,r,t){if(e.mediaType===s.G_){var i,n;if(null!=t&&null!==(i=t.imp)&&void 0!==i&&null!==(i=i.video)&&void 0!==i&&i.w&&null!=t&&null!==(n=t.imp)&&void 0!==n&&null!==(n=n.video)&&void 0!==n&&n.h){var o=[t.imp.video.w,t.imp.video.h];e.playerWidth=o[0],e.playerHeight=o[1]}r.adm&&(e.vastXml=r.adm),r.nurl&&(e.vastUrl=r.nurl)}}};var f=t(33981);function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.context,t=void 0===r?{}:r,a=e.processors,s=void 0===a?m:a,d=e.overrides,u=void 0===d?{}:d,l=e.imp,c=e.request,f=e.bidResponse,v=e.response,b=new WeakMap;function y(e,r,t,o){var a;return function(){return null==a&&(a=function(){var a=t.bind(this,function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!n.has(e)){var t=Object.entries(e);t.sort(function(e,r){return(e=e[1].priority||0)===(r=r[1].priority||0)?0:e>r?-1:1}),n.set(e,t.map(function(e){var r=(0,i.A)(e,2);return[r[0],r[1].fn]}))}var o=n.get(e).filter(function(e){var t=(0,i.A)(e,1)[0];return!r.hasOwnProperty(t)||r[t]}).map(function(e){var t=(0,i.A)(e,2),n=t[0],o=t[1];return r.hasOwnProperty(n)?r[n].bind(this,o):o});return function(){var e=this,r=Array.from(arguments);o.forEach(function(t){t.apply(e,r)})}}(s()[e]||{},u[e]||{}));return r&&(a=r.bind(this,a)),function(){try{return a.apply(this,arguments)}catch(e){o.call.apply(o,[this,e].concat(Array.prototype.slice.call(arguments)))}}}()),a.apply(this,arguments)}}var h=y(p.Tb,l,function(e,r,t){var i={};return e(i,r,t),i},function(e,r,t){(0,o.logError)("Error while converting bidRequest to ORTB imp; request skipped.",{error:e,bidRequest:r,context:t})}),g=y(p.S3,c,function(e,r,t,i){var n={imp:r};return e(n,t,i),n},function(e,r,t,i){throw(0,o.logError)("Error while converting to ORTB request",{error:e,imps:r,bidderRequest:t,context:i}),e}),R=y(p.WR,f,function(e,r,t){var i={};return e(i,r,t),i},function(e,r,t){(0,o.logError)("Error while converting ORTB seatbid.bid to bidResponse; bid skipped.",{error:e,bid:r,context:t})}),T=y(p.Cf,v,function(e,r,t,i){var n={bids:r};return e(n,t,i),n},function(e,r,t,i){throw(0,o.logError)("Error while converting from ORTB response",{error:e,bidResponses:r,ortbResponse:t,context:i}),e});return{toORTB:function(e){var r=e.bidderRequest,i=e.bidRequests,n=e.context,a=void 0===n?{}:n;i=i||r.bids;var s={req:Object.assign({bidRequests:i},t,a),imp:{}};s.req.impContext=s.imp;var d=i.map(function(e){var i=Object.assign({bidderRequest:r,reqContext:s.req},t,a),n=h(e,i);if(null!=n){if(n.hasOwnProperty("id"))return Object.assign(i,{bidRequest:e,imp:n}),s.imp[n.id]=i,n;(0,o.logError)("Converted ORTB imp does not specify an id, ignoring bid request",e,n)}}).filter(Boolean),u=g(d,r,s.req);return s.req.bidderRequest=r,null!=u&&b.set(u,s),u},fromORTB:function(e){var r=e.request,t=e.response,i=b.get(r);if(null==i)throw new Error("ortbRequest passed to `fromORTB` must be the same object returned by `toORTB`");function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.assign(e,{ortbRequest:r},t)}var a=Object.fromEntries((r.imp||[]).map(function(e){return[e.id,e]})),s=(t.seatbid||[]).flatMap(function(e){return(e.bid||[]).map(function(r){if(a.hasOwnProperty(r.impid)&&i.imp.hasOwnProperty(r.impid))return R(r,n(i.imp[r.impid],{imp:a[r.impid],seatbid:e,ortbResponse:t}));(0,o.logError)("ORTB response seatbid[].bid[].impid does not match any imp in request; ignoring bid",r)})}).filter(Boolean);return T(s,t,n(i.req))}}}var m=(0,o.memoize)(function(){return(0,f.U)(c,(0,p.yB)(p.qN))})},33981:(e,r,t)=>{t.d(r,{U:()=>n});var i=t(98757);function n(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];var o=r.shift(),a=r.length>1?n.apply(void 0,r):r[0];return Object.fromEntries(i.zt.map(function(e){return[e,Object.assign({},o[e],a[e])]}))}},84988:(e,r,t)=>{t.d(r,{K:()=>o,X:()=>n});var i=t(55074),n={1:i.D4,2:i.G_,4:i.s6};function o(e,r,t){if(!e.mediaType){var i=t.mediaType;if(!i&&!n.hasOwnProperty(r.mtype))throw new Error("Cannot determine mediaType for response");e.mediaType=i||n[r.mtype]}}},98757:(e,r,t)=>{t.d(r,{Cf:()=>u,S3:()=>a,Tb:()=>s,WR:()=>d,e4:()=>l,pS:()=>v,qN:()=>p,yB:()=>m,zt:()=>n});var i,n=["request","imp","bidResponse","response"],o=["default","pbs"],a=n[0],s=n[1],d=n[2],u=n[3],p=o[0],l=o[1],c=new Set(n),f=(i={},{registerOrtbProcessor:function(e){var r=e.type,t=e.name,o=e.fn,a=e.priority,s=void 0===a?0:a,d=e.dialects,u=void 0===d?[p]:d;if(!c.has(r))throw new Error("ORTB processor type must be one of: ".concat(n.join(", ")));u.forEach(function(e){i.hasOwnProperty(e)||(i[e]={}),i[e].hasOwnProperty(r)||(i[e][r]={}),i[e][r][t]={priority:s,fn:o}})},getProcessors:function(e){return i[e]||{}}}),v=f.registerOrtbProcessor,m=f.getProcessors}}]);