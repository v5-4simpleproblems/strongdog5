var t,mcan=document.createElement("canvas"),mctx=(mcan.width=100,mcan.height=100,mcan.getContext("2d"));mctx.save();let params=window.adParams||{};var k={VER:"9.18",trkHost:"//"+params.trkHost,DynImgCdnHost:"//"+params.dynImgHost,cdnHost:"//"+params.cdnHost,pxlDims:params.dims,crossOrigin:"true"===(null==(t=params.custom)?void 0:t.exported)?null:"anonymous",view_n:!1,inView:!1,clkCount:0,engageCount:0,initParams:function(){var t;window.adParams&&(k.trkHost="//"+adParams.trkHost,k.DynImgCdnHost="//"+adParams.dynImgHost,k.cdnHost="//"+adParams.cdnHost,k.pxlDims=adParams.dims,k.crossOrigin="true"===(null==(t=adParams.custom)?void 0:t.exported)?null:"anonymous")},initViewability:function(t){k.clinchViewability={};try{k.clinchViewability=new ClinchViewability}catch(t){}try{k.clinchViewability.init(t,1e3)}catch(t){}if(k.clinchViewability._undetermined)k.view_n=!0;else try{k.clinchViewability.listen("viewable.impression",function(t){void 0!==k&&k.reportViewability&&k.reportViewability()})}catch(t){}},reportImp:function(){if(!k.isDisableTrackingPixels()){(new Image).src=k.trkHost+"/imp?"+k.pxlDims+(k.view_n?"&view_n=true":"")+"&a="+Date.now();for(var t=0;t<adParams.impPixels.length;t++){var e=adParams.impPixels[t].replace("http:","").replace("https:","");(new Image).src=k.expandCacheBusterMacroInUrl(e)}}},reportViewability:function(){k.pxlDims&&((new Image).src=k.trkHost+"/view_y?"+k.pxlDims+"&a="+Date.now(),Array.isArray(adParams.viewPixels))&&adParams.viewPixels.forEach(t=>{(new Image).src=k.expandCacheBusterMacroInUrl(t)})},reportClick:function(t,e,i,s,a,r){if(e=e||"",i=i||"",a=a||k.getClkPos(r),k.isVpaid())({x:r,y:n}=k.getClkPos()),vpaidAd.callEvent_("AdClickThru",t,33,!0,e,r,n),k.clkCount++;else if(!(k.isDisableTrackingPixels()||9<k.clkCount)){var r=k.getClickedItem(e),n=k.getClickedItemParameter(r),o=((new Image).src=k.trkHost+"/clk?"+k.pxlDims+"&ctaid="+e+(i?"&utags="+encodeURIComponent(i):"")+"&x="+a.x+"&y="+a.y+"&cnt="+k.clkCount+"&lp="+encodeURIComponent(t)+n+"&a="+Date.now(),[]);if(Array.isArray(adParams.clkPixels))for(var l=0;l<adParams.clkPixels.length;l++)o.push(adParams.clkPixels[l]);if(Array.isArray(s))for(l=0;l<s.length;l++)o.push(s[l]);for(l=0;l<o.length;l++)(new Image).src=k.expandMacrosInClickTrackerUrl(k.expandCacheBusterMacroInUrl(o[l]).replace(/{{click_type}}/g,e).replace(/{{click_tags}}/g,i),e);k.clkCount++}},reportEngage:function(t,e,i,s){if(k.isVpaid())vpaidAd.callEvent_("AdInteraction",t);else if(!k.isDisableTrackingPixels()){(new Image).src=k.trkHost+"/engage?"+k.pxlDims+"&type="+t+(e?"&utags="+encodeURIComponent(e):"")+"&x="+s.x+"&y="+s.y+"&cnt="+k.engageCount+"&a="+Date.now();var a=[];if(Array.isArray(i))for(var r=0;r<i.length;r++)a.push(i[r]);for(r=0;r<a.length;r++)(new Image).src=k.expandCacheBusterMacroInUrl(a[r]).replace(/{{engage_type}}/g,t).replace(/{{engage_tags}}/g,e);k.engageCount++}},reportBlock:function(){k.isDisableTrackingPixels()||k.isBlockEventSent||(k.isBlockEventSent=!0,(new Image).src=k.trkHost+"/blk?"+k.pxlDims+"&a="+Date.now())},errorsSent:{},reportExceptionError:function(t,e){k.reportError("exception_in_"+t,e)},reportError:function(t,e){if(!k.isDisableTrackingPixels())if(void 0!==k.errorsSent[t])k.errorsSent[t]++;else{k.errorsSent[t]=1;if(e)for(var i in e)"function"!=typeof e[i]&&0}},sendEvent:function(t){adParams.isProd},click:function(t,e,i){try{k.cancelBubbling(i),"undefined"!=typeof cp_&&cp_.fire("click",{url:t,type:e,event:i}),!0!==i.stopClickProcess&&(t=(t="default"===t?"":t)||adParams.clickUrl||adParams.fbClickUrl)&&(t=k.genClkChain(t,e),k.reportClick(t,e,null,null,null,i),k.isVpaid()||(k.isMraid()?k.sendMsgToHost("open,"+t):window.open(t,t.startsWith("tel")?"_top":"_blank")))}catch(i){k.reportExceptionError("click",i)}},expandCacheBusterMacroInUrl:function(t){return t=0<=t.indexOf("{{cache_buster}}")?t.replace(/{{cache_buster}}/g,Date.now()):t},expandMacrosInClickTrackerUrl:function(e,t){try{var i=k.getClickedItem(t);return e=(e=(e=(e=(e=e.replace(/{{clicked_product_id}}/g,i.id)).replace(/{{clicked_product_category}}/g,i.catName||"")).replace(/{{clicked_product_custom1}}/g,i.custom.custom1||"")).replace(/{{clicked_product_custom2}}/g,i.custom.custom2||"")).replace(/{{clicked_product_custom3}}/g,i.custom.custom3||"")}catch(t){return e}},getClickedItem:function(t){return-1<(t=t.toLowerCase()).indexOf("item_")?(t=parseInt(t.replace("item_",""))-1,items[t]):{id:"",catName:"",custom:{}}},getClickedItemParameter:function(t){var params="";return t.id&&(params="&clkItemId="+encodeURIComponent(t.id),t.catName&&(params+="&clkItemCat="+encodeURIComponent(t.catName)),t.custom.custom1&&(params+="&clkItemCustom1="+encodeURIComponent(t.custom.custom1)),t.custom.custom2&&(params+="&clkItemCustom2="+encodeURIComponent(t.custom.custom2)),t.custom.custom3)&&(params+="&clkItemCustom3="+encodeURIComponent(t.custom.custom3)),params},getClkPos:function(t){var{left:e,top:i,width:s,height:a}=("undefined"!=typeof cp_?comp.innerContainer:document.getElementById("innerContainer")).getBoundingClientRect();try{var r=0,n=0;return((t=t||window.event).clientX||t.clientY)&&(r=Math.round((t.clientX-e)/s*100),n=Math.round((t.clientY-i)/a*100)),{x:r,y:n}}catch(t){return{x:0,y:0}}},genClkChain:function(t,e){var i,s=t;adParams.utmParams&&!t.startsWith("tel")&&(t=adParams.utmParams,t=-1==s.indexOf("?")?"?"+t:"&"+t,s.includes("#")&&!s.includes("/#/")?(i=s.indexOf("#"),s=s.slice(0,i)+t+s.slice(i)):s+=t),s=k.expandMacrosInClickTrackerUrl(s,e);for(var a=adParams.clkTrackers.length-1;0<=a;a--){var r=adParams.clkTrackers[a];if(0<=r.toUpperCase().indexOf("AD.DOUBLECLICK.NET/DDM"))s=r+(r.endsWith("?")?"":"?")+s;else{if(!r.toLowerCase().includes("amazon-adsystem.com")){var n=parseInt(adParams.custom.clkenclvl);0==a&&!isNaN(n)||(n=1);for(var o=0;o<n;o++)s=encodeURIComponent(s)}s=r+s}}return s},sendMsgToHost:function(t){window.parent&&window.parent.postMessage(t,"*")},getParamByName:function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");t=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},isBrowserSupported:function(){return!!(document.createElement("canvas").getContext&&Array.prototype.indexOf&&CSSStyleDeclaration.prototype.getPropertyValue&&Element.prototype.addEventListener)},isIos:function(){return/iPhone|iPod|iPad/i.test(navigator.userAgent)},isIE:function(){return/Trident/i.test(navigator.userAgent)},isIpad:function(){return/iPad/i.test(navigator.userAgent)},isAndroid:function(){return/Android/i.test(navigator.userAgent)},isTablet:function(){return this.isIpad()||this.isAndroid()&&!/Mobile/i.test(navigator.userAgent)},isDesktop:function(){return!this.isMobile()&&!this.isTablet()},isMobile:function(){return/Android|webOS|iPhone|iPod|Blackberry|Windows Phone/i.test(navigator.userAgent)},isMraid:function(){return"true"==k.getParamByName("mraid")||"inapp"==k.getParamByName("env")},isVpaid:function(){return"true"===adParams.custom.isVpaid},isDisableTrackingPixels:function(){return!k.pxlDims||k.isVpaid()},isShowClickAreas:function(){return"true"===k.getParamByName("showclickareas")},isEmpty:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},hashCode:function(t){var e,i=0;if(0!==t.length)for(e=0;e<t.length;e++)i=(i<<5)-i+t.charCodeAt(e),i|=0;return i},hash64:function(t){for(var e="",i="",s=0;s<t.length;s++)s%2==0?e+=t[s]:i+=t[s];var a=this.hashCode(e),r=this.hashCode(i);return a.toString()+r.toString()},base64UrlEncode:function(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},getDynImgUrl:function(t,e,i,s,a,r,n){var o;return void 0!==window.devicePixelRatio&&1.3<window.devicePixelRatio&&(e*=2,i*=2),"true"===adParams.custom.exported?t:(o=[],adParams.ctx&&o.push("ctx="+adParams.ctx),r&&1!==r&&o.push("va="+r),n&&1!==n&&o.push("ha="+n),r=0<o.length?"?"+o.join("&"):"",k.DynImgCdnHost+"/resize/"+adParams.clientEncId+"/"+k.base64UrlEncode(t)+"/"+e+"/"+i+"/"+s+"/"+a+r)},isExtImg:function(t){return-1==t.indexOf(this.cdnHost)},hexToRgb:function(t,e){t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return t?"rgba("+parseInt(t[1],16)+","+parseInt(t[2],16)+","+parseInt(t[3],16)+","+e+")":"rgba(0,0,0,0)"},cancelBubbling:function(t){(t=t||window.event).stopPropagation?t.stopPropagation():t.cancelBubble=!0},htmlEncode:function(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\s/g,"&nbsp;")},insertAndExecute:function(t,e){var i;t.innerHTML=e;for(i of Array.prototype.slice.call(t.getElementsByTagName("script"))){var s=document.createElement("script");s.async=!1,i.type&&(s.type=i.type),""!=i.src?s.src=i.src:s.innerHTML=i.innerHTML,document.getElementsByTagName("head")[0].appendChild(s)}},receiveMsg:function(t){var e,i,s,a=t.data;if("blockAd"===a)k.hideAd(),k.reportBlock(),k.sendMsgToReciever(t.source,"adBlocked");else if("showAd"===a)k.showAd(),k.sendMsgToReciever(t.source,"adShown");else if("initSubLoad"===a&&"undefined"!=typeof cp_&&cp_.initSubLoad(),!adParams.isProd||-1!=t.origin.indexOf("//cdn.clinch.co"))if("getDynamicData"===a.type){if(biz)for(var r in biz.custom)biz[r]=biz.custom[r];var n={items:items||[],biz:biz||null,style:style,cidEnc:adParams.clientEncId,dynImgCdnHost:adParams.dynImgHost,adFormat:adParams.adFormatStr};k.sendMsgToReciever(t.source,"dynamicData",n)}else"click"===a.type?(t=a.params.type||"",n=a.params.tags||"",i=a.params.clickPixels||a.params.pixels||[],s=null,adParams.InAdclk&&(e=adParams.InAdclk.trkPerLabel[t||"main"])&&e.lp&&(s=e.lp),e=a.params.url||s||adParams.clickUrl||adParams.fbClickUrl,s={x:a.params.x||0,y:a.params.y||0},e=k.genClkChain(e,t),k.reportClick(e,t,n,i,s),k.isVpaid()||(k.isMraid()?k.sendMsgToHost("open,"+e):window.open(e,e.startsWith("tel")?"_top":"_blank"))):"engage"===a.type&&(t=a.params.type||"",n=a.params.tags||"",i=a.params.clickPixels||a.params.pixels||[],s={x:a.params.x||0,y:a.params.y||0},k.reportEngage(t,n,i,s))},sendMsgToReciever:function(t,e,params){t.postMessage({type:e,params:params},"*")},log:function(t){adParams.isDebug||adParams.custom.isPreview},hideAd:function(){document.body.style.visibility="hidden"},showAd:function(){document.body.style.visibility="visible"},measureCan:mcan,measureCtx:mctx,measureText:function(e,t,i,s,a,r,n,o){var l=k.measureCtx;l.font=k.getCtxFont(a,s,i,t);let h=0;if(0==r||!0!==o||void 0!==l.letterSpacing)h=l.measureText(e).width;else for(let t=0;t<e.length;t++)h+=l.measureText(e[t]).width;return 0!=r&&(a=e.length-1,!0===n&&(a+=1),h+=i*r/1e3*a),h},getFontShorthandString:function(t){return"10px "+t},loadFontByFamily(t){var e=k.getCurrentDoc();e.fonts&&e.fonts.load&&e.fonts.load(k.getFontShorthandString(t))},getCtxFont:function(t,e,i,s){var style="";return 1!==t&&!0!==t&&"italic"!==t||(style+="italic "),(style+=e+" ")+i+"px '"+s+"'"},getCurrentDoc(){var t;return"undefined"!=typeof cp_&&(null==(t=null==cp_?void 0:cp_.containerDiv)?void 0:t.ownerDocument)||document},loadFonts(t){var e=this.getCurrentDoc();if(e.fonts&&e.fonts.load){var i,s=e.createElement("style"),a=adParams.language,r=Array.from(e.fonts).map(t=>t.family);e.head.appendChild(s);for(i of t){var n,o=k.getCtxFont(i.italic,i.weight,10,i.family);i.url&&!r.includes(i.family)&&(n=`@font-face {font-family: "${i.family}";src: url('${i.url.replace(/\.[^.]+$/,`_${a}.woff2`)}') format('woff2'), url('${i.url.replace(/\.[^.]+$/,`_${a}.woff`)}') format('woff');font-weight: ${i.weight};font-style: ${i.italic?"italic":"normal"};}`,s.sheet.insertRule(n),e.fonts.load(o))}}},extractEncodedFontKeyFromFontUrl:function(t){return encodeURIComponent(t.slice(t.indexOf("/",8)+1))},deepEqual:function(e,i,s){if("object"==typeof e&&null!==e||e instanceof Float32Array)try{return Object.keys(e).every(t=>this.deepEqual(e[t],i[t],s))}catch(t){return!1}return(e=void 0===e?null:e)===(i=void 0===i?null:i)},wrapText:function(t,e,i,s,a){i*=.98;for(var r={lines:[],status:"ok"},n=e.split(" "),o="",l=0;l<n.length;l++){var h=o+n[l]+" ";if(t.measureText(h).width<i)o=h;else{if(!(0<o.trim().length)){if(0<r.lines.length){o="",r.status="otherLineFail";break}return r.status="line1Fail",r}if(r.lines.push(o.trim()),o="",0<s&&r.lines.length>=s){r.status="partial";break}if(o=n[l]+" ",t.measureText(o).width>i){r.status="otherLineFail",o="";break}}}if(0<o.trim().length&&r.lines.push(o.trim()),r.lines[r.lines.length-1]=r.lines[r.lines.length-1].trim(),("partial"==r.status||"otherLineFail"==r.status)&&a)for(var c=0;c<6;c++){if(t.measureText(r.lines[r.lines.length-1]+"...").width<=i){r.lines[r.lines.length-1]+="...";break}r.lines[r.lines.length-1]=r.lines[r.lines.length-1].slice(0,-1)}return r}};window.FB=k;class PlayerBase{constructor(){this._listeners={},this.avgFps=0,this.fps=0,this.frameCount=0,this.movPerc=0,this.lastMovPerc=0,this.timer=0,this.timelineUpdate=null,this.prevTime=0,this.isReadyForPlay=!1,this.isStarted=!1,this.IsPaused=!1,this.isMuted=!1,this.volume=1,this.currentFrameDrawCount=0,this.percentLoaded=0,this.IsStopRequested=!1,this.isMovieEnded=!1,this.isFirstRun=!0,this.playbackrate=1,this.reqAnim=null,this.comp=null,this.percentageReportInterval=null,this.assetLoadingStartTime=null,this.indexLoaded=0,this.getMovRespose={};let t="hidden",e="visibilitychange";var i=["moz","ms","webkit"].find(t=>void 0!==document[t+"Hidden"]),i=(i&&(t=i+"Hidden",e=""+i+e),new URLSearchParams(document.location.search));adParams.drawDebugBoxes="true"===i.get("drawDebugBoxes"),document.addEventListener(e,()=>this.handleVisibilityChange(t),!1)}addListener(t,e){void 0===this._listeners[t]&&(this._listeners[t]=[]),this._listeners[t].push(e)}fire(i,t){if((i={type:i,obj:t}).target||(i.target=this),!i.type)throw new Error("Event object missing 'type' property.");if(this._listeners[i.type]instanceof Array){var s=this._listeners[i.type];for(let t=0,e=s.length;t<e;t++)s[t].call(this,i)}}removeListener(t,i){if(this._listeners[t]instanceof Array){var s=this._listeners[t];for(let t=0,e=s.length;t<e;t++)if(s[t]===i){s.splice(t,1);break}}}timeInSeconds(){return this.timer/1e3}getStatus(){let t;return{status:t=this.isReadyForPlay?this.isStarted?this.IsPaused||this.isMovieEnded?this.IsPaused&&!this.isMovieEnded?"paused":"ended":"play":"ready":"init",currentTime:this.timeInSeconds(),volume:this.volume,mute:this.isMuted}}Mute(t){void 0!==this.comp&&(this.isMuted=t,this.comp.mute(this.isMuted))}isMute(){return this.isMuted}Volume(t){(t=1<t?1:t)<0&&(t=0),void 0!==this.comp&&(!0===this.isMuted&&0<t&&this.Mute(!1),this.comp.vol(t),0===(this.volume=t)&&this.Mute(!0),this.fire("volumeChange",{volume:t}))}report_percentage(){var t=this.comp.getFootageStatus(!1),e=(this.firstFrameLoaded||0!==this.comp.getFootageStatus(!0).pending.length||(this.fire("initial_load_completed"),this.firstFrameLoaded=!0),this.isLoadingTimeout(2e4));0!==t.pending.length&&!e||(clearInterval(this.percentageReportInterval),0<t.failed.length?k.reportError("footage_failed"):0<t.pending.length&&k.reportError("footage_timeout"),t.failed.length+t.pending.length!==0)||this.MovReady()}isLoadingTimeout(t){return(new Date).getTime()-this.assetLoadingStartTime.getTime()>t}MovReady(){try{k.log("MovReady() called"),this.isReadyForPlay=!0,adParams.autoPlay?(this.start(),this.fire("ready_for_play"),this.fire("play")):(this.fire("ready_for_play"),this.IsPaused=!0)}catch(t){k.reportExceptionError("MovReady_func",t)}}start(){try{this.drawCurrentFrameInLoopTimeout&&window.clearTimeout(this.drawCurrentFrameInLoopTimeout),this.comp.drawFrame(this.timer,!0),this.timelineUpdate=setInterval(()=>{try{this.movPerc=this.timer/(1e3*this.comp.dur)*100,100<this.movPerc&&(this.movPerc=100),this.lastMovPerc=this.movPerc,this.IsPaused||this.fire("progress",{time:this.timeInSeconds()})}catch(t){}},50),this.prevTime=Date.now(),this.comp.durationStr_=this.milisecTotime(1e3*this.comp.dur),this.isStarted=!0,this.IsPaused=!1,this.Mute(this.isMuted),this.comp.play(this.timer),this.fire("start"),this.animate()}catch(t){k.reportExceptionError("start_func",t)}}movieEnded(){this.isMovieEnded=!0,this.Pause(),this.fire("end"),this.isFirstRun=!1}windowResized(){let t=0,e=0,i=1,s="";this.comp.setSize(this.comp.w,this.comp.h);var a,r,n=this.comp.innerContainer.style,o=this.containerDiv.offsetWidth,l=this.containerDiv.offsetHeight,h=(-1!==[9055,8855,8999,9059,9060].indexOf(adParams.campaignId)&&"true"!==adParams.custom.isPreview||o===comp.w&&l===comp.h||(r=comp.w/comp.h,a=o/l,s="top left",h=Math.abs(1-o/comp.w/(l/comp.h))<.01,r<=a&&!h||a<r&&h?(i=l/comp.h,a=comp.w*i,t=0,e=Math.round((o-a)/2)):(i=o/comp.w,r=comp.h*i,e=0,t=Math.round((l-r)/2))),"scale("+i+")");n.WebkitTransform=h,n.MozTransform=h,n.oTransform=h,n.transform=h,n.msTransform=h,n.WebkitTransformOrigin=s,n.MozTransformOrigin=s,n.oTransformOrigin=s,n.transformOrigin=s,n.msTransformOrigin=s,n.top=t+"px",n.left=e+"px",!0===this.IsPaused&&this.comp.drawFrame(this.timer,this.IsPaused),this.scale=i,this.fire("resize",i)}animate(){var t,e=Date.now();!0===this.IsStopRequested?(this.IsStopRequested=!1,this.isStarted=!1):(!1===this.IsPaused&&null!=this.comp&&(this.timer+=(e-this.prevTime)*this.playbackrate,this.timer>1e3*this.comp.dur&&(this.timer=1e3*this.comp.dur),this.timer!==1e3*this.comp.dur||this.isMovieEnded||this.movieEnded(),null!=(t=this.comp)&&t.drawFrame(this.timer,this.IsPaused),this.fps=1e3/(e-this.prevTime),this.avgFps=(this.avgFps*this.frameCount+this.fps)/(this.frameCount+1),this.frameCount++),this.prevTime=e,this.reqAnim=requestAnimationFrame(this.animate.bind(this)))}Play(){this.isStarted?this.isMovieEnded?this.replay():(this.IsPaused=!1,this.comp.play(this.timer),this.fire("play")):adParams.autoPlay||this.isStarted||(this.IsPaused=!1,this.start(),this.fire("play"))}Pause(){this.IsPaused=!0,this.isMovieEnded||this.fire("pause",{time:this.timeInSeconds()}),this.isStarted&&this.comp.pause(this.timer,this.isMovieEnded)}GetMovieDuration(){if(null!=this.comp)return this.comp.dur}stop(){null!=this.comp&&this.comp.stop(),this.IsStopRequested=!0}goTo(t){t=Math.min(1e3*this.comp.dur,Math.max(0,t)),this.timer=t,this.comp.goTo(t,this.IsPaused),this.fire("goto",{time:this.timeInSeconds()})}replay(){this.comp.stop(),this.prevTime=Date.now(),this.timer=0,this.isMovieEnded=!1,this.Play(),this.fire("play")}TogglePlaybackRate(){1===this.playbackrate?(this.playbackrate=.1,this.comp.setRate(.1)):(this.playbackrate=1,this.comp.setRate(1))}handleVisibilityChange(t){null!=this.comp&&(document[t]?(k.log("Clinch:hide"),this.fire("hide"),this.reqAnim&&(this.IsPaused||(this.Pause(),this._pausedDueVisChange=!0),cancelAnimationFrame(this.reqAnim))):(k.log("Clinch:visible"),this.fire("visible"),!0===this._pausedDueVisChange&&(this.Play(),this._pausedDueVisChange=!1),this.prevTime=Date.now()-30,null!=this.reqAnim?(cancelAnimationFrame(this.reqAnim),this.timer>=1e3*this.comp.dur?(this.timer=1e3*this.comp.dur,k.log("Clinch:drawFrame at:"+this.timer),this.comp.goTo(this.timer,this.IsPaused),this.comp.drawFrame(this.timer,this.IsPaused),this.animate()):!0===this.IsPaused?(k.log("Clinch:drawFrame at:"+this.timer),this.comp.goTo(this.timer,this.IsPaused),this.comp.drawFrame(this.timer,this.IsPaused),this.animate(),this.Pause()):(this.animate(),k.log("Clinch:resume Play at:"+this.timer),this.Play())):this.comp.drawFrame(this.timer,this.IsPaused)))}currentTime(){return this.timer}milisecTotime(t){var t=Math.floor(t/1e3),e=Math.floor(t/60);let i=t-60*e;return e+":"+(i=i<10?"0"+i:i)}drawCurrentFrameInLoop(){this.comp.drawFrame(this.timer,!0),this.currentFrameDrawCount++,this.drawCurrentFrameInLoopTimeout=window.setTimeout(this.drawCurrentFrameInLoop.bind(this),100)}init(t,r,n,o){this.firstFrameLoaded=!1,this.footageTiming=r.loadFootageTiming;try{function l(e,t){var i=document.createElement("div");t=t.trim(),i.innerHTML=t;for(let t=i.childNodes.length-1;0<=t;t--)e.appendChild(i.childNodes[t])}o?(r.custom.isVpaid="true",this.isVpaid=!0,this.options=o,this.isMuted=r.isMute||!1===o.videoCanAutoplay):this.isMuted=!0,"true"===r.custom.startAdHidden&&k.hideAd(),n.setAttribute("compId",this.comp.id),this.containerDiv=n,this.B.COMP.call(this.comp,this),void 0===r.custom.subLoadDelay?r.subLoadDelay=0:r.subLoadDelay=parseFloat(r.custom.subLoadDelay),this.containerDiv.appendChild(this.comp.innerContainer);let t=r.format.w,e=r.format.h,i=(null==style?void 0:style.Background_framecolor)||(null==style?void 0:style.frame_color)||"#B3B3B3";if(null!=style&&style.General_BorderColor){let t=eval(style.General_BorderColor)(0);t.startsWith("#")&&(i=t)}let s=this.comp.innerContainer,a=(s.style.position="absolute",s.style.top="0px",s.style.left="0px",s.style.cursor="pointer",s.style.overflow="hidden",s.style.width=t+"px",s.style.height=e+"px",'<div style="position:absolute;z-index:100000;background:'+i+';top:0;left:0;width:100%;height:1px"></div><div style="position:absolute;z-index:100000;background:'+i+';bottom:0;left:0;width:100%;height:1px"></div><div style="position:absolute;z-index:100000;background:'+i+';top:0;left:0;width:1px;height:100%"></div><div style="position:absolute;z-index:100000;background:'+i+';top:0;right:0;width:1px;height:100%"></div>');l(s,a),window.addEventListener("resize",this.windowResized.bind(this)),r.isProd||n.addEventListener("contextmenu",this.TogglePlaybackRate),this.windowResized.bind(this)(),this.containerDiv.addEventListener("click",function(t){return k.click(null,"default",t),!1}),this.timer=1e3*r.startTime,this.drawCurrentFrameInLoop(),this.assetLoadingStartTime=new Date,this.percentageReportInterval=setInterval(this.report_percentage.bind(this),100),this.fire("init")}catch(t){k.reportExceptionError("Init",{adParams:JSON.stringify(r),stage:"",exception:JSON.stringify(t)})}}dispose(){if(this.containerDiv.innerHTML="",this.comp)for(let t=0;t<this.comp.l.length;t++)this.comp.l[t].dispose&&this.comp.l[t].dispose();this.comp=null}}let V={},j=1e-6;function E(){var P=Math,g=Math.pow,v=Math.sqrt,c=Math.floor;function y(t,e,i,s,a,r){a=t*s+e*a+i*r-a*s-r*t-i*e;return-.001<a&&a<.001}var d=function(t,e,i,s){for(var a,r,n,o,l=0,h=[],c=[],d=bezierLengthPool.newElement(),u=i.length,p=0;p<50;p+=1){for(n=p/49,a=o=0;a<u;a+=1)r=g(1-n,3)*t[a]+3*g(1-n,2)*n*i[a]+3*(1-n)*g(n,2)*s[a]+g(n,3)*e[a],h[a]=r,null!==c[a]&&(o+=g(h[a]-c[a],2)),c[a]=h[a];o&&(l+=o=v(o)),d.percents[p]=n,d.lengths[p]=l}return d.addedLength=l,d};function x(t){this.segmentLength=0,this.points=new Array(t)}function w(t,e){this.partialLength=t,this.point=e}function t(t,e,i,s){var a=(t[0]+"_"+t[1]+"_"+e[0]+"_"+e[1]+"_"+i[0]+"_"+i[1]+"_"+s[0]+"_"+s[1]).replace(/\./g,"p");if(!b[a]){for(var r,n,o,l,h,c=50,d=0,u=null,p=new x(c=2===t.length&&(t[0]!==e[0]||t[1]!==e[1])&&y(t[0],t[1],e[0],e[1],t[0]+i[0],t[1]+i[1])&&y(t[0],t[1],e[0],e[1],e[0]+s[0],e[1]+s[1])?2:c),m=i.length,f=0;f<c;f+=1){for(h=C(m),o=f/(c-1),r=l=0;r<m;r+=1)n=g(1-o,3)*t[r]+3*g(1-o,2)*o*(t[r]+i[r])+3*(1-o)*g(o,2)*(e[r]+s[r])+g(o,3)*e[r],h[r]=n,null!==u&&(l+=g(h[r]-u[r],2));d+=l=v(l),p.points[f]=new w(l,h),u=h}p.segmentLength=d,b[a]=p}return b[a]}var b;b={};function M(t,e){var i=e.percents,s=e.lengths,a=i.length,r=c((a-1)*t),n=t*e.addedLength,o=0;if(r===a-1||0===r||n===s[r])return i[r];for(var l=s[r]>n?-1:1,h=!0;h;)if(s[r]<=n&&s[r+1]>n?(o=(n-s[r])/(s[r+1]-s[r]),h=!1):r+=l,r<0||a-1<=r){if(r===a-1)return i[r];h=!1}return i[r]+(i[r+1]-i[r])*o}var S=R("float32",8);return{getSegmentsLength:function(t){for(var e=segmentsLengthPool.newElement(),i=t.c,s=t.v,a=t.o,r=t.i,n=t._length,o=e.lengths,l=0,h=0;h<n-1;h+=1)o[h]=d(s[h],s[h+1],a[h],r[h+1]),l+=o[h].addedLength;return i&&n&&(o[h]=d(s[h],s[0],a[h],r[0]),l+=o[h].addedLength),e.totalLength=l,e},getNewSegment:function(t,e,i,s,a,r,n){a<0?a=0:1<a&&(a=1);for(var a=M(a,n),r=M(r=1<r?1:r,n),o=t.length,l=1-r,h=(n=1-a)*n*n,c=a*n*n*3,d=a*a*n*3,u=a*a*a,p=n*n*l,m=a*n*l+n*a*l+n*n*r,f=a*a*l+n*a*r+a*n*r,g=a*a*r,v=n*l*l,y=a*l*l+n*r*l+n*l*r,x=a*r*l+n*r*r+a*l*r,w=a*r*r,b=l*l*l,C=r*l*l+l*r*l+l*l*r,T=r*r*l+l*r*r+r*l*r,_=r*r*r,k=0;k<o;k+=1)S[4*k]=P.round(1e3*(h*t[k]+c*i[k]+d*s[k]+u*e[k]))/1e3,S[4*k+1]=P.round(1e3*(p*t[k]+m*i[k]+f*s[k]+g*e[k]))/1e3,S[4*k+2]=P.round(1e3*(v*t[k]+y*i[k]+x*s[k]+w*e[k]))/1e3,S[4*k+3]=P.round(1e3*(b*t[k]+C*i[k]+T*s[k]+_*e[k]))/1e3;return S},getPointInSegment:function(t,e,i,s,a,r){return a=M(a,r),r=1-a,[P.round(1e3*(r*r*r*t[0]+(a*r*r+r*a*r+r*r*a)*i[0]+(a*a*r+r*a*a+a*r*a)*s[0]+a*a*a*e[0]))/1e3,P.round(1e3*(r*r*r*t[1]+(a*r*r+r*a*r+r*r*a)*i[1]+(a*a*r+r*a*a+a*r*a)*s[1]+a*a*a*e[1]))/1e3]},buildBezierData:t,pointOnLine2D:y,pointOnLine3D:function(t,e,i,s,a,r,n,o,l){var h;return 0===i&&0===r&&0===l?y(t,e,s,a,n,o):(h=P.sqrt(P.pow(s-t,2)+P.pow(a-e,2)+P.pow(r-i,2)),t=P.sqrt(P.pow(n-t,2)+P.pow(o-e,2)+P.pow(l-i,2)),e=P.sqrt(P.pow(n-s,2)+P.pow(o-a,2)+P.pow(l-r,2)),-1e-4<(i=t<h?e<h?h-t-e:e-t-h:t<e?e-t-h:t-h-e)&&i<1e-4)}}}var R=(()=>{function i(t,e){var i,s=0,a=[];switch(t){case"int16":case"uint8c":i=1;break;default:i=1.1}for(s=0;s<e;s+=1)a.push(i);return a}return"function"==typeof Uint8ClampedArray&&"function"==typeof Float32Array?function(t,e){return"float32"===t?new Float32Array(e):"int16"===t?new Int16Array(e):"uint8c"===t?new Uint8ClampedArray(e):i(t,e)}:i})();function C(t){return Array.apply(null,{length:t})}var H=E(),e,s,i,a,r,n,o;V.BezierFactory=(()=>{var t={getBezierEasing:function(t,e,i,s,a){a=a||("bez_"+t+"_"+e+"_"+i+"_"+s).replace(/\./g,"p");if(r[a])return r[a];t=new n([t,e,i,s]);return r[a]=t}},r={},T=11,_=1/(T-1),e="function"==typeof Float32Array;function s(t,e){return 1-3*e+3*t}function B(t,e){return 3*e-6*t}function k(t,e,i){return((s(e,i)*t+B(e,i))*t+3*e)*t}function P(t,e,i){return 3*s(e,i)*t*t+2*B(e,i)*t+3*e}function n(t){this._p=t,this._mSampleValues=new(e?Float32Array:Array)(T),this._precomputed=!1,this.get=this.get.bind(this)}return n.prototype={get:function(t){var e=this._p[0],i=this._p[1],s=this._p[2],a=this._p[3];return this._precomputed||this._precompute(),e===i&&s===a?t:0===t?0:1===t?1:k(this._getTForX(t),i,a)},_precompute:function(){var t=this._p[0],e=this._p[1],i=this._p[2],s=this._p[3];this._precomputed=!0,t===e&&i===s||this._calcSampleValues()},_calcSampleValues:function(){for(var t=this._p[0],e=this._p[2],i=0;i<T;++i)this._mSampleValues[i]=k(i*_,t,e)},_getTForX:function(t){for(var e=this._p[0],i=this._p[2],s=this._mSampleValues,a=0,r=1,n=T-1;r!==n&&s[r]<=t;++r)a+=_;var o=a+(t-s[--r])/(s[r+1]-s[r])*_,l=P(o,e,i);if(.001<=l){for(var h=t,c=o,d=e,u=i,p=0;p<4;++p){var m=P(c,d,u);if(0===m)return c;c-=(k(c,d,u)-h)/m}return c}if(0===l)return o;for(var f,g,v=t,y=a,x=a+_,w=e,b=i,C=0;0<(f=k(g=y+(x-y)/2,w,b)-v)?x=g:y=g,1e-7<Math.abs(f)&&++C<10;);return g}},t})(),V.PropertyFactory=(()=>{var h=-999999;function c(t,e){for(var i,s,a,r,n=this.offsetTime,o=("multidimensional"===this.propType&&(i=R("float32",this.pv.length)),e.lastIndex),l=o,h=this.keyframes.length-1,c=!0;c;){if(s=this.keyframes[l],a=this.keyframes[l+1],l===h-1&&t>=a.t-n){s.h&&(s=Object.assign(Object.assign({},s),{s:s.e})),o=0;break}if(a.t-n>t){o=l;break}l<h-1?l+=1:(o=0,c=!1)}var d,u,p,m,f,g=a.t-n,v=s.t-n;if(s.to){s.bezierData||(s.bezierData=H.buildBezierData(s.s,a.s||s.e,s.to,s.ti));var y=s.bezierData;if(g<=t||t<v)for(var x=g<=t?y.points.length-1:0,w=y.points[x].point.length,b=0;b<w;b+=1)i[b]=y.points[x].point[b];else{s.__fnct?r=s.__fnct:(r=V.BezierFactory.getBezierEasing(s.o.x,s.o.y,s.i.x,s.i.y,s.n).get,s.__fnct=r);for(var C,T=r((t-v)/(g-v)),_=y.segmentLength*T,k=e.lastTime<t&&e._lastKeyframeIndex===l?e._lastAddedLength:0,P=e.lastTime<t&&e._lastKeyframeIndex===l?e._lastPoint:0,c=!0,M=y.points.length;c;){if(k+=y.points[P].partialLength,0==_||0===T||P===y.points.length-1){for(w=y.points[P].point.length,b=0;b<w;b+=1)i[b]=y.points[P].point[b];break}if(k<=_&&_<k+y.points[P+1].partialLength){for(C=(_-k)/y.points[P+1].partialLength,w=y.points[P].point.length,b=0;b<w;b+=1)i[b]=y.points[P].point[b]+(y.points[P+1].point[b]-y.points[P].point[b])*C;break}P<M-1?P+=1:c=!1}e._lastPoint=P,e._lastAddedLength=k-y.points[P].partialLength,e._lastKeyframeIndex=l}}else{var S,I,E,L,A,O,F,h=s.s.length,D=a.s||s.e;if(this.sh&&1!==s.h)g<=t?(i[0]=D[0],i[1]=D[1],i[2]=D[2]):t<=v?(i[0]=s.s[0],i[1]=s.s[1],i[2]=s.s[2]):(O=z(s.s),F=z(D),d=i,O=((t,e,i)=>{var s,a,r,n=[],o=t[0],l=t[1],h=t[2],t=t[3],c=e[0],d=e[1],u=e[2];return(r=o*c+l*d+h*u+t*(e=e[3]))<0&&(r=-r,c=-c,d=-d,u=-u,e=-e),r=1e-6<1-r?(r=Math.acos(r),s=Math.sin(r),a=Math.sin((1-i)*r)/s,Math.sin(i*r)/s):(a=1-i,i),n[0]=a*o+r*c,n[1]=a*l+r*d,n[2]=a*h+r*u,n[3]=a*t+r*e,n})(O,F,(t-v)/(g-v)),F=O[0],u=O[1],p=O[2],O=O[3],m=Math.atan2(2*u*O-2*F*p,1-2*u*u-2*p*p),f=Math.asin(2*F*u+2*p*O),O=Math.atan2(2*F*O-2*u*p,1-2*F*F-2*p*p),d[0]=m/degToRads,d[1]=f/degToRads,d[2]=O/degToRads);else for(l=0;l<h;l+=1)1!==s.h&&(T=g<=t?1:t<v?0:(s.o.x.constructor===Array?(s.__fnct||(s.__fnct=[]),s.__fnct[l]?r=s.__fnct[l]:(S=void 0===s.o.x[l]?s.o.x[0]:s.o.x[l],I=void 0===s.o.y[l]?s.o.y[0]:s.o.y[l],E=void 0===s.i.x[l]?s.i.x[0]:s.i.x[l],L=void 0===s.i.y[l]?s.i.y[0]:s.i.y[l],r=V.BezierFactory.getBezierEasing(S,I,E,L).get,s.__fnct[l]=r)):s.__fnct?r=s.__fnct:(S=s.o.x,I=s.o.y,E=s.i.x,L=s.i.y,r=V.BezierFactory.getBezierEasing(S,I,E,L).get,s.__fnct=r),r((t-v)/(g-v)))),D=a.s||s.e,A=1===s.h?s.s[l]:s.s[l]+(D[l]+j-s.s[l])*T,"multidimensional"===this.propType?i[l]=A:i=A}return e.lastIndex=o,i}function z(t){var e=t[0]*degToRads,i=t[1]*degToRads,t=t[2]*degToRads,s=Math.cos(e/2),a=Math.cos(i/2),r=Math.cos(t/2),e=Math.sin(e/2),i=Math.sin(i/2),t=Math.sin(t/2);return[e*i*r+s*a*t,e*a*r+s*i*t,s*i*r-e*a*t,s*a*r-e*i*t]}function d(t){var t=t-this.offsetTime,e=this.keyframes[0].t-this.offsetTime,i=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(t===this._caching.lastTime||this._caching.lastTime!==h&&(this._caching.lastTime>=i&&i<=t||this._caching.lastTime<e&&t<e))&&(this._caching.lastTime>=t&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0),1===this.keyframes.length?"multidimensional"===this.propType?this.pv=this.keyframes[0].s:this.pv=this.keyframes[0].s[0]:this.pv=this.interpolateValue(t,this._caching),this.mult)&&1!=this.mult)if("unidimensional"==this.propType)this.pv*=this.mult;else for(var s=0;s<this.pv.length;s++)this.pv[s]*=this.mult;return this._caching.lastTime=t,this.pv}function e(t){var e=t.mult;this.propType="unidimensional",this.keyframes=t.k,this.offsetTime=0,this.frameId=-1,this._caching={lastTime:h,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=t,this.mult=e||1,this.v=h,this.pv=h,this._isFirstFrame=!0,this.interpolateValue=c,this.getValueAtTime=d.bind(this)}function i(t){for(var e,i,s,a,r=t.mult,n=(this.propType="multidimensional",t.k.length),o=0;o<n-1;o+=1)t.k[o].to&&!t.k[o].ti&&(t.k[o].ti=[0,0,0]),!t.k[o].to&&t.k[o].ti&&(t.k[o].to=[0,0,0]),null!=(e=t.k[o].to)&&e.every(t=>0===t)&&null!=(e=t.k[o].ti)&&e.every(t=>0===t)&&(t.k[o].to=null,t.k[o].ti=null),t.k[o].to&&(t.k[o].i.x&&t.k[o].i.y&&(t.k[o].i.x=[t.k[o].i.x[0]],t.k[o].i.y=[t.k[o].i.y[0]]),t.k[o].o.x)&&t.k[o].o.y&&(t.k[o].o.x=[t.k[o].o.x[0]],t.k[o].o.y=[t.k[o].o.y[0]]),t.k[o].to&&t.k[o].s&&t.k[o+1]&&t.k[o+1].s&&(e=t.k[o].s,i=t.k[o+1].s,s=t.k[o].to,a=t.k[o].ti,(2===e.length&&(e[0]!==i[0]||e[1]!==i[1])&&H.pointOnLine2D(e[0],e[1],i[0],i[1],e[0]+s[0],e[1]+s[1])&&H.pointOnLine2D(e[0],e[1],i[0],i[1],i[0]+a[0],i[1]+a[1])||3===e.length&&(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2])&&H.pointOnLine3D(e[0],e[1],e[2],i[0],i[1],i[2],e[0]+s[0],e[1]+s[1],e[2]+s[2])&&H.pointOnLine3D(e[0],e[1],e[2],i[0],i[1],i[2],i[0]+a[0],i[1]+a[1],i[2]+a[2]))&&(t.k[o].to=null,t.k[o].ti=null),e[0]===i[0])&&e[1]===i[1]&&0===s[0]&&0===s[1]&&0===a[0]&&0===a[1]&&(2===e.length||e[2]===i[2]&&0===s[2]&&0===a[2])&&(t.k[o].to=null,t.k[o].ti=null);this.getValueAtTime=d.bind(this),this.data=t,this.keyframes=t.k,this.offsetTime=0,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=r||1,this.interpolateValue=c,this.frameId=-1;var l=t.k[0].s.length;for(this.v=R("float32",l),this.pv=R("float32",l),o=0;o<l;o+=1)this.v[o]=h,this.pv[o]=h;this._caching={lastTime:h,lastIndex:0,value:R("float32",l)}}return{getProp:function(t){return t=new(1==t.k[0].s.length?e:i)(t)}}})(),V.ShapePropertyFactory=(()=>{var a=-999999;function e(t,e,i){var s,a,r,n,o,l,h,c=i.lastIndex,d=this.keyframes;if(t<d[0].t-this.offsetTime)s=d[0].s[0],a=!0,c=0;else if(t>=d[d.length-1].t-this.offsetTime)s=(d[d.length-1].s?d[d.length-1].s:d[d.length-2].e)[0],a=!0;else{for(var u,p,m,f,g,v=c,y=d.length-1,x=!0;x&&(u=d[v],!((p=d[v+1]).t-this.offsetTime>t));)v<y-1?v+=1:x=!1;c=v,(a=1===u.h)||(f=t>=p.t-this.offsetTime?1:t<u.t-this.offsetTime?0:(u.__fnct?m=u.__fnct:(m=V.BezierFactory.getBezierEasing(u.o.x,u.o.y,u.i.x,u.i.y).get,u.__fnct=m),m((t-(u.t-this.offsetTime))/(p.t-this.offsetTime-(u.t-this.offsetTime)))),g=(p.s||u.e)[0]),s=u.s[0]}for(o=e._length,l=s.i[0].length,i.lastIndex=c,r=0;r<o;r+=1)for(n=0;n<l;n+=1)h=a?s.i[r][n]:s.i[r][n]+(g.i[r][n]-s.i[r][n])*f,e.i[r][n]=h,h=a?s.o[r][n]:s.o[r][n]+(g.o[r][n]-s.o[r][n])*f,e.o[r][n]=h,h=a?s.v[r][n]:s.v[r][n]+(g.v[r][n]-s.v[r][n])*f,e.v[r][n]=h;e.v.splice(o),e.i.splice(o),e.o.splice(o)}var t=function(t,e,i){var s=0,a=t,r=C(a);return{newElement:function(){var t;t=s?r[--s]:e();return t},release:function(t){s===a&&(r=pooling.double(r),a*=2);i&&i(t);r[s]=t,s+=1}}},n=t(8,function(){return R("float32",2)});function l(){this.c=!1,this._length=0,this._maxLength=8,this.v=C(this._maxLength),this.o=C(this._maxLength),this.i=C(this._maxLength)}l.prototype.setPathData=function(t,e){this.c=t,this.setLength(e);for(var i=0;i<e;)this.v[i]=n.newElement(),this.o[i]=n.newElement(),this.i[i]=n.newElement(),i+=1},l.prototype.setLength=function(t){for(;this._maxLength<t;)this.doubleArrayLength();this._length=t},l.prototype.doubleArrayLength=function(){this.v=this.v.concat(C(this._maxLength)),this.i=this.i.concat(C(this._maxLength)),this.o=this.o.concat(C(this._maxLength)),this._maxLength*=2},l.prototype.setXYAt=function(t,e,i,s,a){var r;switch(this._length=Math.max(this._length,s+1),this._length>=this._maxLength&&this.doubleArrayLength(),i){case"v":r=this.v;break;case"i":r=this.i;break;case"o":r=this.o;break;default:r=[]}r[s]&&(r[s],a)||(r[s]=n.newElement()),r[s][0]=t,r[s][1]=e},l.prototype.setTripleAt=function(t,e,i,s,a,r,n,o){this.setXYAt(t,e,"v",n,o),this.setXYAt(i,s,"o",n,o),this.setXYAt(a,r,"i",n,o)},l.prototype.reverse=function(){for(var t=new l,e=(t.setPathData(this.c,this._length),this.v),i=this.o,s=this.i,a=0,r=(this.c&&(t.setTripleAt(e[0][0],e[0][1],s[0][0],s[0][1],i[0][0],i[0][1],0,!1),a=1),this._length-1),n=this._length,o=a;o<n;o+=1)t.setTripleAt(e[r][0],e[r][1],s[r][0],s[r][1],i[r][0],i[r][1],o,!1),--r;return t},(r=t(4,function(){return new l},function(t){for(var e=t._length,i=0;i<e;i+=1)n.release(t.v[i]),n.release(t.i[i]),n.release(t.o[i]),t.v[i]=null,t.i[i]=null,t.o[i]=null;t._length=0,t.c=!1})).clone=function(t){var e,i=r.newElement(),s=void 0===t._length?t.v.length:t._length;for(i.setLength(s),i.c=t.c,e=0;e<s;e+=1)i.setTripleAt(t.v[e][0],t.v[e][1],t.o[e][0],t.o[e][1],t.i[e][0],t.i[e][1],e);return i};var r,i=r;function s(t){this.propType="shape",this.keyframes=t.k,this.c=t.c,this.k=!0,this.kf=!0;t=this.keyframes[0].s[0].i.length;this.offsetTime=0,this.v=i.newElement(),this.v.setPathData(this.c,t),this.pv=i.clone(this.v),this.lastTime=a,this._caching={lastTime:a,lastIndex:0},this.interpolateShape=e,this.getValueAtTime=function(t){var t=t-this.offsetTime,e=this.keyframes[0].t-this.offsetTime,i=this.keyframes[this.keyframes.length-1].t-this.offsetTime,s=this._caching.lastTime;return s!==a&&(s<e&&t<e||i<s&&i<t)||(this._caching.lastIndex=s<t?this._caching.lastIndex:0,this.interpolateShape(t,this.pv,this._caching)),this._caching.lastTime=t,this.pv}.bind(this)}return s.prototype.interpolateShape=e,t={getShapeProp:function(t){return new s(t)}}})();let u={Rectangle:"rectangle",Ellipse:"ellipse",Polystar:"polystar",Path:"path",TrimPath:"trimpath",MergePath:"mergepath"},w={Solid:0,LinearGradient:1,RadialGradient:2},L={Percent:1,Index:2},m={Char:1,CharWithoutSpace:2,Word:3,Line:4},p={Top:0,Center:1,Bottom:2};function l(){function s(t){var{an:[e,i,s],p:a,px:r,py:n,pz:o,s:[l,h,c]=[1,1,1],rx:d=0,ry:u=0,rz:p=0,o:[m,f,g]}=t.tr,r=null!=(r=null!=r?r:null==a?void 0:a[0])?r:0,n=null!=(n=null!=n?n:null==a?void 0:a[1])?n:0,a=null!=(o=null!=o?o:null==a?void 0:a[2])?o:0;let v=!0;return t.lastTransformShallowCopy&&(o=t.lastTransformShallowCopy,v=o.translateX!=r||o.translateY!=n||o.translateZ!=a||o.scaleX!=l||o.scaleY!=h||o.scaleZ!=c||o.anchorX!=e||o.anchorY!=i||o.anchorY!=i||o.oriX!=m||o.oriY!=f||o.oriZ!=g||o.rx!=d||o.ry!=u||o.rz!=p),v?(o=(new DOMMatrix).translateSelf(r,n,-a),0==m&&0==f&&0==g||o.rotateSelf(180*-(m/Math.PI),-f/Math.PI*180,g/Math.PI*180),0!=d&&o.rotateSelf(180*-(d/Math.PI),0,0),0!=u&&o.rotateSelf(0,180*-(u/Math.PI),0),0!=p&&o.rotateSelf(0,0,p/Math.PI*180),1==l&&1==h&&1==c||o.scaleSelf(l,h,c),0==e&&0==i&&0==s||o.translateSelf(-e,-i,s),t.matrix=o,t.lastTransformShallowCopy={anchorX:e,anchorY:i,anchorZ:s,translateX:r,translateY:n,translateZ:a,scaleX:l,scaleY:h,scaleZ:c,rx:d,ry:u,rz:p,oriX:m,oriY:f,oriZ:g},o):t.matrix}this.children=[],this.start=this.s,this.end=this.e,this.isDisplayed=!1,this.worldMatrixTime=-999,this.eff||(this.eff=[]),this.tr&&(this.tr.p||void 0!==this.tr.px&&void 0!==this.tr.py||(this.tr.p=[0,0,0]),this.tr.s=this.tr.s||[1,1,1],this.tr.o=this.tr.o||[0,0,0],this.tr.an=this.tr.an||[0,0,0],this.tr.rx=this.tr.rx||0,this.tr.ry=this.tr.ry||0,this.tr.rz=this.tr.rz||0,this.tr.a=this.tr.a||1),this.error="",this.isInScene=!1,this.hideLayer=function(){this.element&&(this.element.style.display="none")},this.showLayer=function(){this.element&&(this.element.style.display="block")},this.hideLayer(),this.getEaliestStart=function(){for(var t=this.start,e=0;e<this.children.length;e++){var i=this.children[e].getEaliestStart();i<t&&(t=i)}return t},this.getLatestEnd=function(){for(var t=this.end,e=0;e<this.children.length;e++){var i=this.children[e].getLatestEnd();t<i&&(t=i)}return t},this.showCalled=!1,this.update=function(t,e){this.isInScene=t>=this.sceneStart&&t<=this.sceneEnd,this.isDisplayed=t>=this.start&&(t<this.end||t===this.end&&t===1e3*this.comp.dur),this.isDisplayed?this.showCalled||(this.showCalled=!0,this.showLayer(),"Video"!==this.ty&&"Audio"!==this.ty)||e||this.play(t):this.showCalled&&(this.showCalled=!1,this.hideLayer(),"Video"!==this.ty&&"Audio"!==this.ty||this.pause(t)),this.isInScene&&this.updateProperties&&this.updateProperties(t/1e3);for(var i=0;i<this.children.length;i++)this.children[i].update(t,e)},this.updateLayerCSSTransform=function(){var t=this.matrixWorld,e=this.comp.camera.zo,e=this.is3d?`translate(${this.comp.w/2}px, ${this.comp.h/2}px) perspective(${e}px) translate(${-this.comp.w/2}px, ${-this.comp.h/2}px) `+t.toString():t.toString();this.element&&(this.element.style.transform=e,this.element.style.transformOrigin="left top")},this.updateLayerMatrixWorld=function(){if(this.worldMatrixTime!==cp_.timer){this.worldMatrixTime=cp_.timer;let t=this,e=s(this);for(;t.parent;){var i=s(t=t.parent);e=i.multiply(e)}this.matrixWorld=e}},this.stop=function(t){"Video"!==this.ty&&"Audio"!==this.ty||this.pause(t),this.isDisplayed=!1,this.isInScene=!1,this.showCalled=!1,this.drawTime=-1,this.hideLayer()}}let h={Mask:"mask",Shadow:"shadow",Fill:"fill",BoxBlur:"boxBlur",ColorOverlay:"colOver",TrkMatte:"trkmatte"},c={HorizontalAndVertical:1,Horizontal:2,Vertical:3};function d(t,e){this.inCan=t,this.outCan=e,this.inCtx=null==(t=this.inCan)?void 0:t.getContext("2d"),this.outCtx=null==(e=this.outCan)?void 0:e.getContext("2d"),this.csm=window.devicePixelRatio,this.initEffectCanvas=function(){this.inCan&&(this.outCan.width=this.inCan.width,this.outCan.height=this.inCan.height,this.outCan.style.cssText=this.inCan.style.cssText,this.outCtx.resetTransform(),this.outCtx.scale(this.csm,this.csm),this.outCtx.save())},this.initEffectCanvas(),this.isUpdated=function(){return!!this.isSpecificPropertyUpdated_||!!this.isPropertiesUpdated&&this.isPropertiesUpdated()},this.effectPointWorldToLocal=function(t,e){var i=this.parent,t=i.matrixWorld.inverse().transformPoint({x:t,y:e});return i.x&&(t.x-=i.x),i.y&&(t.y-=i.y),t},this.getExtraOffsets=function(){return{wx:0,hx:0}},this.effectDrawInCantoOutCan=function(){var t=this;t.outCtx.save(),t.outCtx.scale(1/t.parent.csm,1/t.parent.csm),t.outCtx.clearRect(0,0,t.outCan.width,t.outCan.height),t.outCtx.drawImage(t.inCan,0,0,t.outCan.width,t.outCan.height),t.outCtx.restore()}}let A=["","butt","round","square"],O=["","miter","round","bevel"];function f(t,e){t.beginPath(),t.moveTo(e.v[0][0],e.v[0][1]);for(var i=0,s=1;s<e.v.length&&e.v[s];s++){i=s;try{t.bezierCurveTo(e.v[s-1][0]+e.o[s-1][0],e.v[s-1][1]+e.o[s-1][1],e.v[s][0]+e.i[s][0],e.v[s][1]+e.i[s][1],e.v[s][0],e.v[s][1])}catch(t){}}e.c&&(s=i,t.bezierCurveTo(e.v[s][0]+e.o[s][0],e.v[s][1]+e.o[s][1],e.v[0][0]+e.i[0][0],e.v[0][1]+e.i[0][1],e.v[0][0],e.v[0][1]),t.closePath())}function F(t,e){e.fillStyle=g(t,e),e.globalAlpha=e.globalAlpha*t.a}function v(t,e){e.lineWidth=t.w,t.dashes&&(e.setLineDash(t.dashes.pattern.map(t=>t.value)),e.lineDashOffset=t.dashes.offset),e.lineCap=A[t.lc||1],e.lineJoin=O[t.lj||1],e.strokeStyle=g(t,e),e.globalAlpha=e.globalAlpha*t.a}function g(t,e){let{c:i,cs:s,e:[a,r]=[],s:[n,o]=[],hl:l=[],ha:h=[]}=t.o;t=t.t;switch(t){case w.Solid:return b(i);case w.LinearGradient:var c=e.createLinearGradient(n,o,a,r);for(let{s:t,c:e,a:i}of s)c.addColorStop(t,y(e,i));return c;case w.RadialGradient:var d=Math.atan2(r-o,a-n),u=Math.sqrt(Math.pow(a-n,2)+Math.pow(r-o,2)),p=n+u*l*Math.cos(d+h),d=o+u*l*Math.sin(d+h),m=e.createRadialGradient(p,d,0,n,o,u);for(let{s:t,c:e,a:i}of s)m.addColorStop(t,y(e,i));return m}}function b(t,e){e=e?255:1;return 3==t.length?"rgb("+parseInt(t[0]*e)+","+parseInt(t[1]*e)+","+parseInt(t[2]*e)+")":"rgba("+parseInt(t[0]*e)+","+parseInt(t[1]*e)+","+parseInt(t[2]*e)+","+t[3]+")"}function D(t){var e=document.createElement("canvas"),e=(e.width=t.canvas.width,e.height=t.canvas.height,e.getContext("2d"));return e.setTransform(t.getTransform()),e}function y(t,e){var i;return e<1?-1!=t.indexOf("#")?(i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),"rgba("+parseInt(i[1],16)+","+parseInt(i[2],16)+","+parseInt(i[3],16)+","+e+")"):t.replace(/[\d\.]+\)$/g,e+")"):t}function z(t,e){d.call(this,t,e),this.outCan=e,this.isUpdated=function(){return this.masks.some(t=>t.isPropertiesUpdated())},this.drawOnCanvas=function(){this.effectDrawInCantoOutCan(),U(this.masks,this.outCan,this.outCtx,this.parent)}}function U(t,e,i,s){var a=1/s.csm,r=document.createElement("canvas"),n=(r.width=e.width*a,r.height=e.height*a,r.getContext("2d")),o=-s.x,l=s.y;n.translate(o,l);for(var h=0;h<t.length;h++){n.save();var c=t[h],d=(n.globalAlpha=c.a,0===h&&2===c.c&&n.fillRect(-o,-l,r.width,r.height),(c.fy[0]+c.fy[1])/2);switch(0==d||(n.translate(-4*r.width,0),n.shadowColor="#000",n.shadowOffsetX=4*r.width,n.shadowBlur=d),f(n,c.path),n.fillStyle="#000",c.c){case 2:n.globalCompositeOperation="destination-out";break;case 3:n.globalCompositeOperation="destination-in";break;case 4:n.globalCompositeOperation="lighter"}n.fill(),n.restore()}i.save(),i.globalCompositeOperation="destination-in",i.drawImage(r,0,0,r.width,r.height),i.restore()}function N(t,e){d.call(this,t,e),this.a=this.a||1,this.d=this.d||0,this.n=this.n||0,this.b=this.b||0,this.updateSpecific=function(){var{d:t,n:e,b:i}=this,s=-Math.cos(e)*t,e=Math.sin(e)*t,t=(this.parent.updateLayerMatrixWorld(),this.parent.matrixWorld.inverse()),{x:a,y:r}=t.transformPoint({x:s,y:e}),{x:t,y:n}=t.transformPoint({x:0,y:0}),a=a-t,t=r-n,r=i*(Math.sqrt(Math.pow(a,2)+Math.pow(t,2))/Math.sqrt(Math.pow(s,2)+Math.pow(e,2))||1);this.isSpecificPropertyUpdated_=a!==this.offsetX||t!==this.offsetY||r!==this.blur,this.offsetX=a,this.offsetY=t,this.blur=r},this.getExtraOffsets=function(){return{wx:Math.abs(this.offsetX)+this.blur,hx:Math.abs(this.offsetY)+this.blur}},this.drawOnCanvas=function(){var{outCan:t,outCtx:e,parent:{csm:i},blur:s,a,c:r,offsetX:n,offsetY:o}=this;e.save(),e.scale(1/i,1/i),e.clearRect(-t.width/2,-t.height/2,t.width,t.height),e.restore(),e.shadowColor=`rgba(${[r.slice(0,3),a].join(",")})`,e.shadowOffsetX=n*i,e.shadowOffsetY=o*i,e.shadowBlur=s*i,this.effectDrawInCantoOutCan(),e.restore()},this.drawOnHtml=function(t){var{b:e,a:i,c:s,d:a,n:r}=this,r=[(-Math.cos(r)*a).toFixed(1)+"px",(Math.sin(r)*a).toFixed(1)+"px",e.toFixed(1)+"px "+`rgba(${[s.slice(0,3),i].join(",")})`].join(" ");t.style.filter="drop-shadow("+r+")",t.style.overflow="visible",t.style.filter||(t.style.textShadow=r)}}function W(t,o){d.call(this,t,o),this.drawOnCanvas=function(){var{inCan:t,outCan:e,outCtx:i,parent:{csm:s},a,c:r,inv:n}=this;i.save(),i.scale(1/s,1/s),i.clearRect(0,0,e.width,e.height),i.drawImage(t,0,0,e.width,e.height),i.fillStyle=`rgb(${r.slice(0,3).join(",")})`,i.globalAlpha=a,i.globalCompositeOperation=n?"source-out":"source-in",i.fillRect(0,0,o.width,o.height),i.restore()}}function $(t,n){d.call(this,t,n),this.drawOnCanvas=function(){var{inCan:t,outCan:e,outCtx:i,parent:{csm:s},a,c:r}=this;i.save(),i.scale(1/s,1/s),i.clearRect(0,0,e.width,e.height),i.drawImage(t,0,0,e.width,e.height),i.fillStyle=`rgb(${r.slice(0,3).join(",")})`,i.globalAlpha=a,i.globalCompositeOperation="source-in",i.fillRect(0,0,n.width,n.height),a<1&&(i.globalCompositeOperation="lighter",i.globalAlpha=1-a,i.drawImage(t,0,0,e.width,e.height)),i.restore()}}function X(t,e){d.call(this,t,e),this.getExtraOffsets=function(){var{radiusX:t,radiusY:e}=this;return{wx:Math.ceil(t),hx:Math.ceil(e)}},this.updateSpecific=function(){var{r:t,dim:e}=this,t=Array.isArray(t)?t[0]:t,i=e===c.Vertical?0:t,e=e===c.Horizontal?0:t,s=(this.parent.updateLayerMatrixWorld(),this.parent.matrixWorld.inverse()),{x:a,y:r}=s.transformPoint({x:i,y:e}),{x:s,y:n}=s.transformPoint({x:0,y:0}),a=a-s,s=r-n,r=t*(Math.sqrt(Math.pow(a,2)+Math.pow(s,2))/Math.sqrt(Math.pow(i,2)+Math.pow(e,2))||1);this.isSpecificPropertyUpdated_=a!==this.radiusX||s!==this.radiusY||r!==this.radiusNew,this.radiusX=a,this.radiusY=s,this.radiusNew=r},this.drawOnHtml=function(t){Math.abs(this.radiusNew)<.1?t.style.filter="":t.style.filter="blur("+this.radiusNew+"px)"},this.drawOnCanvas=function(){let{dim:t,parent:{csm:s},outCtx:e,radiusX:a,radiusY:r,radiusNew:i}=this;if(isNaN(i)||i<1)this.effectDrawInCantoOutCan();else if(t===c.HorizontalAndVertical)this.effectDrawInCantoOutCan(),l=i*s,Math.abs(l)<.1?this.outCan.style.filter="":this.outCan.style.filter="blur("+l+"px)";else{let i=20;var n=[];for(let t=0;t<i;t++){var o={x:h(a,t),y:h(r,t)};n.push(o)}var l=1/i;e.globalCompositeOperation="source-over",e.globalAlpha=l,e.save(),e.scale(1/s,1/s);for(let t=0;t<i;t++)e.drawImage(this.inCan,n[t].x,n[t].y);function h(t,e){return(-t+e*(2*t)/(i-1))*s}e.restore()}}}let x=["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"];function Y(t,e){d.call(this,t,e);let n=this,i=this.isUpdated.bind(this);this.tmLastDrawTime=-9,this.mat=new DOMMatrix,this.tm_tr_a=-1,this.tmInView=null,this.isUpdated=function(){let t=!1;n.tm.drawTime!==n.tmLastDrawTime&&(t=!0,n.tmLastDrawTime=n.tm.drawTime);var e=i()||t||n.tm_tr_a!==n.tm.tr.a||(n.tmInView=n.tm.isDisplayed);return n.tm_tr_a=n.tm.tr.a,n.tmInView=n.tm.isDisplayed,e},this.updateSpecific=function(){var t=n,e=(t.parent.updateLayerMatrixWorld(),t.tm.updateLayerMatrixWorld(),(new DOMMatrix).multiply(t.parent.matrixWorld).translate(t.parent.x,-t.parent.y).inverse().multiply(t.tm.matrixWorld).translate(t.tm.x,-t.tm.y));t.tm.tr.a,this.isSpecificPropertyUpdated_=!k.deepEqual(e.toFloat32Array(),t.mat.toFloat32Array()),t.mat=e},this.drawOnCanvas=function(){var t=n,e=t.outCtx,i=t.outCan,s=!t.tm.isDisplayed||0==t.tm.outCan.width||0==t.tm.outCan.height;if(e.save(),e.scale(1/t.parent.csm,1/t.parent.csm),e.clearRect(0,0,i.width,i.height),!s||5!=t.tmt&&8!=t.tmt){if(e.drawImage(t.inCan,0,0,i.width,i.height),e.restore(),!s||6!=t.tmt&&9!=t.tmt){if(e.save(),e.transform(t.mat.a,t.mat.b,t.mat.c,t.mat.d,t.mat.e,t.mat.f),5==t.tmt||6==t.tmt)e.globalCompositeOperation=x[t.tmt];else{for(var i=t.tm.outCan.getContext("2d"),s=i.getImageData(0,0,t.tm.outCan.width,t.tm.outCan.height),a=s.data,r=0;r<a.length;r+=4)a[r+3]=(a[r]+a[r+1]+a[r+2])/3;i.putImageData(s,0,0),8==t.tmt?e.globalCompositeOperation=x[5]:9==t.tmt&&(e.globalCompositeOperation=x[6])}e.globalAlpha=t.tm.tr.a,e.scale(1/t.parent.csm,1/t.parent.csm),e.drawImage(t.tm.outCan,0,0,t.tm.outCan.width,t.tm.outCan.height),e.restore()}}else e.restore()}}let q=["Null","Audio","Camera"],J=["shadow","boxBlur"],K=["Image","Video","Text","Html"];function P(){let e=this;var t,i;l.call(this),this.eff=this.eff||[],this.masks=this.masks||[],this.isHtml=G(this),this.calculateLayerSizeAndShiftAndUpdateLayer=function(){var t,e,i,s,a=this,{x:r,y:n,w:o,h:l,wx:h,hx:c}=a;a.w=0,a.h=0,a.x=0,a.y=0,a.wx=0,a.hx=0,a.ctx_x=0,a.ctx_y=0,null!=(t=a.updateLayerBoundaries)&&t.call(a);for(e of a.eff)e.getExtraOffsets&&({wx:i,hx:s}=e.getExtraOffsets(),a.wx+=Math.abs(2*i)||0,a.hx+=Math.abs(2*s)||0);a.x===r&&a.y===n&&a.w===o&&a.h===l&&a.hx===c&&a.wx===h||this.initContentCanvasSizeAndCtxAndLayerCSS()},this.initContentCanvasSizeAndCtxAndLayerCSS=function(){var t,e,i;this.isHtml||(this.canvas.width=(this.w+this.wx)*this.csm,this.canvas.height=(this.h+this.hx)*this.csm,this.x-=this.wx/2,this.y+=this.hx/2,this.ctx_x+=this.wx/2,this.ctx_y+=this.hx/2,t=this.canvas.width/this.csm,e=this.canvas.height/this.csm,this.canvas.style.cssText="position:absolute;width:"+t+"px;height:"+e+"px;",this.ctx=this.canvas.getContext("2d"),this.ctx.scale(this.csm,this.csm),this.ctx.save()),this.element&&(this.element.style.width=(this.isHtml?this.w:t)+"px",this.element.style.height=(this.isHtml?this.h:e)+"px",this.subElm.style.cssText="position:absolute;width:"+(this.isHtml?this.w:t)+"px;height:"+(this.isHtml?this.h:e)+"px;left:"+this.x+"px;top:"+-this.y+"px;pointer-events:auto;touch-action:auto",adParams.drawDebugBoxes)&&(this.subElm.style.outline="2px solid #8eff00",this.subElm.style.outlineOffset="outline-offset:-1px",this.subElm.style.backgroundColor="#8eff0030",this.debugElm||(this.debugElm=document.createElement("div"),this.debugElm.style.cssText="display:block;position:absolute;padding: 2px;font-size: 14px;font-family:sans-serif",this.anchorPoint=document.createElement("div"),this.anchorPoint.style.cssText="display:block;position:absolute;width:6px;height:6px;border-radius:50%;background-color:#44aa00;transform:translate(-50%,-50%)",this.debugElm.innerText="Layer "+this.i,this.debugElm.appendChild(this.anchorPoint),this.element.appendChild(this.debugElm)),this.debugElm.style.left=this.x+"px",this.debugElm.style.top=-this.y+"px",this.anchorPoint.style.top=this.tr.an[0],this.anchorPoint.style.left=this.tr.an[1]);for(i of this.eff)i.initEffectCanvas&&i.initEffectCanvas()},this.isHtml||(this.csm=window.devicePixelRatio,this.canvas=document.createElement("canvas"),this.outCan=this.canvas),!0!==this.is_tm&&(this.element=document.createElement("div"),this.subElm=document.createElement("div"),this.element.appendChild(this.subElm)),this.calculateLayerSizeAndShiftAndUpdateLayer(),this.isHtml||!0===this.is_tm||this.subElm.appendChild(this.outCan),this.element&&(this.element.attributes["data-zo"]=this.i,this.element.style.pointerEvents="none",this.element.style.touchAction="none",this.subElm.style.pointerEvents="auto",this.subElm.style.touchAction="auto"),this.clk&&this.element&&(this.subElm.style.cursor="pointer",this.subElm.onclick=function(t){if(e.clk)return k.click(e.clk,e.clkType,t),!1}),this.selected=!1,this.selected&&this.element&&(this.subElm.style.border="1px solid yellow",this.subElm.style.backgroundColor="rgba(255,248,111,1)",i='<div class="position-point" style="z-index:999999999;position:absolute;width:2px;height:2px;background:green;left:'+this.w/2+"px;top:"+this.h/2+'px"></div>',i=i,t=document.createElement("template"),i=i.trim(),t.innerHTML=i,i=t.content.firstChild,this.element.appendChild(i)),this.drawTime=-1,0<this.masks.length&&(t={ty:"mask",masks:this.masks},this.eff.push(t)),void 0!==this.has_tm&&this.tml&&(i={ty:"trkmatte",tm:this.tml,tmt:this.tmt,t:1},this.eff.unshift(i));for(let t=0;t<this.eff.length;t++){(this.eff[t].parent=this).isHtml||(s=0===t?this.canvas:this.eff[t-1].outCan,this.outCan=document.createElement("canvas"),!0!==this.is_tm&&(this.subElm.removeChild(s),this.subElm.appendChild(this.outCan)));var s,a={[h.Mask]:z,[h.Shadow]:N,[h.Fill]:W,[h.ColorOverlay]:$,[h.BoxBlur]:X,[h.TrkMatte]:Y}[this.eff[t].ty];a?a.call(this.eff[t],s,this.outCan):(delete this.eff[t],t--)}this.draw=function(e,t){if(q.indexOf(this.ty)<0)if(this.isHtml){if(this.isDisplayed){var i,s=!1;this.contentNeedRedraw(e)&&(this.drawTime=e,this.calculateLayerSizeAndShiftAndUpdateLayer(),this.drawContent(e),-1!=this.drawTime&&(s=!0),this.clk)&&k.isShowClickAreas()&&showClickableAreasNativeHtml&&showClickableAreasNativeHtml(this),this.element.style.opacity=this.tr.a;for(i of this.eff)i.updateSpecific&&i.updateSpecific(),(s||i.isUpdated(e))&&i.drawOnHtml(this.subElm)}}else{if(!this.isInScene)return;if(this.isDisplayed){var a=this.tr,r=(!0!==this.is_tm&&(this.element.style.opacity=a.a),-1);for(let t=0;t<this.eff.length;t++)this.eff[t].updateSpecific&&this.eff[t].updateSpecific();if(this.contentNeedRedraw(e))r=0;else for(let t=0;t<this.eff.length;t++)if(this.eff[t].isUpdated()){r=t+1;break}if(0<=r&&0<this.tr.a){this.drawTime=e;for(let t=0;t<=this.eff.length;t++)0===t?(this.ctx.save(),this.ctx.resetTransform(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.restore(),this.calculateLayerSizeAndShiftAndUpdateLayer(),this.drawContent(e),this.clk&&k.isShowClickAreas()&&showClickableAreas&&showClickableAreas(this)):this.eff[t-1].drawOnCanvas()}}this.is_tm&&this.d_tml&&this.d_tml.forEach(t=>{t.drawTime!==e&&t.draw(e,!1)})}if(void 0===t||!0===t)for(let t=0;t<this.children.length;t++)this.children[t].draw(e)},this.mute=function(t){"Video"===e.ty&&this.isVidPlayable()&&(this.vid.muted=t)},this.dispose=function(){},this.isVidPlayable=function(){return null!=this.vid&&this.vid.readyState>=HTMLMediaElement.HAVE_FUTURE_DATA}}function G(t){if(["Precomp","HTMLWidget","Widget"].includes(t.ty))return!0;for(var e=0;e<t.eff.length;e++)if(J.indexOf(t.eff[e].ty)<0||"boxBlur"==t.eff[e].ty&&1!=t.eff[e].dim)return!1;if(t.masks&&0<t.masks.length)return!1;if(K.indexOf(t.ty)<0)return!1;if("Text"===t.ty)for(var i of t.text.txtObj.lines)for(var s of i.parts)if(0<s.strokeWidth)return!1;return!(t.is_tm||t.has_tm)}function Z(t,e){P.call(this);var i=this;this.loaded=!1,this.loadFailed=!1,this.lastUpdateTime=-.5,this.extVol=1,this.vol=Math.pow(10,this.v/10),this.aud=document.createElement("audio"),this.aud.setAttribute("preload","auto"),this.aud.muted=!0,this.aud.preload="auto",this.aud.crossOrigin=k.crossOrigin,1===this.l&&(this.aud.loop=!0),this.aud.addEventListener("canplaythrough",function(){var t;!0!==i.loaded&&(this.pause(),.1<(t=(t=i.ls-i.ps)<=0?0:t)&&(this.currentTime=t),i.loaded=!0)},!1),this.aud.addEventListener("error",function(t){k.reportError("audio_layer_onerror"),i.loaded=!0,i.loadFailed=!0}),this.aud.src=this.url,this.aud.load(),k.isIos()&&this.aud.play(),this.update=function(t,e){e||(this.isInScene=t>=this.start&&t<this.end,this.isDisplayed=this.isInScene,t>=this.start&&t<this.end&&this.lastUpdateTime<this.start?this.play(t):t>=this.end&&this.lastUpdateTime<this.end&&this.pause(t),this.isDisplayed&&(this.vol=Math.pow(10,this.v/10),this.isAudPlayable())&&(e=this.vol*this.extVol,this.aud.volume!==(e=1<e?1:e))&&this.aud.volume,this.lastUpdateTime=t)},this.play=function(t){var e;this.isAudPlayable()&&(t<this.start?(this.aud.pause(),e=this.start/1e3-this.ps,this.aud.currentTime=(e=e<0?0:e)%this.aud.duration):((e=t/1e3-this.ps)<0&&(e=0),.2<Math.abs(this.aud.currentTime-e)&&(this.aud.currentTime=e%this.aud.duration),void 0!==(t=this.aud.play())&&t.then(function(){}).catch(function(t){})))},this.pause=function(t,e){this.isAudPlayable()&&this.aud.pause();var i=this.ls-this.ps;i<=0&&(i=0),(t>this.end||e)&&null!=this.aud&&.2<Math.abs(this.aud.currentTime-i)&&(this.aud.currentTime=i)},this.mute=function(t){this.isAudPlayable()&&(this.aud.muted=t)},this.vol=function(t){this.extVol=t;t=this.vol*this.extVol;1<t&&(t=1),this.isAudPlayable()&&(this.aud.volume=t)},this.draw=function(t){},this.stop=function(){this.isDisplayed=!1,this.isInScene=!1},this.isLoaded=function(){return this.loaded},this.setRate=function(t){this.isAudPlayable()&&(this.aud.playbackRate=t)},this.isAudPlayable=function(){return null!=this.aud&&this.aud.readyState>=HTMLMediaElement.HAVE_FUTURE_DATA}}function Q(){P.call(this);var t,e,i=this;this.loaded=!1,this.isPosterLoaded=!1,this.loadFailed=!1,cp_.options&&cp_.options.optionalVideoSlot&&(this.vid=cp_.options.optionalVideoSlot,this.videoCanAutoplay=!!cp_.options.videoCanAutoplay),this.vid=this.vid||document.createElement("video"),this.volumeMultiplier=1;let{video:s,vid:a,start:r,subElm:n}=this;s.x=s.x||0,s.y=s.y||0,a.muted=cp_.isMute(),this.vidElmIsProxy=void 0===a.removeAttribute,this.initVideoPlaybackStart=function(){var t=Math.max(0,r-s.ls)/1e3;a.currentTime!=t&&i.setVideoElmCurrentTime(t)},this.loadFootage=function(){var t,e;!i.vidElmIsProxy&&s.url&&((t=document.createElement("source")).src=s.url,t.type="video/mp4",(e=document.createElement("source")).src=s.url.replace(".mp4",".webm"),e.type="video/webm",a.appendChild(t),a.appendChild(e),a.load())},a.addEventListener("canplaythrough",function t(){i.loaded=!0,i.pause(),i.initVideoPlaybackStart(),a.removeEventListener("canplaythrough",t,!1)},!1),a.addEventListener("error",function(){k.reportError("video_layer_onerror"),i.loaded=!0,i.loadFailed=!0}),this.vidElmIsProxy?s.url?(a.src=s.url,a.load()):i.loaded=!0:(a.setAttribute("webkit-playsinline","webkit-playsinline"),a.setAttribute("playsinline","playsinline"),a.setAttribute("preload","auto"),a.preload="auto",a.crossOrigin=k.crossOrigin,a.loop=1===s.loop,!k.isVpaid()&&this.isHtml&&(a.style.width="100%",a.style.height="100%",n.appendChild(a)),s.url?(t=s.url.startsWith("//")?"https:"+s.url:s.url,t=`${k.DynImgCdnHost}/videoSnapshot/${window.adParams.clientEncId}?url=${encodeURIComponent(t)}&OutputExtension=jpg`+(window.adParams.ctx?"&ctx="+window.adParams.ctx:""),(e=new Image).onload=function(){i.isPosterLoaded=!0},e.src=t,a.poster=t,k.isIos()&&a.play()):i.loaded=!0,k.isVpaid()&&(a.style.opacity=0)),this.footageValidAndLoaded=function(){return!!s.url&&i.loaded&&!i.loadFailed&&null!=a},this.play=function(t){this.footageValidAndLoaded()&&(t<this.start?(a.pause(),this.initVideoPlaybackStart()):(this.selfStartTime=new Date,this.updateVideoTimeForDiff(t),a.play()))},this.pause=function(t,e){this.footageValidAndLoaded()&&(a.pause(),t>this.end||e)&&null!=a&&this.initVideoPlaybackStart()},this.mute=function(t){this.footageValidAndLoaded()&&i.aEn&&(a.muted=t)},this.vol=function(t){this.footageValidAndLoaded()&&(i.volumeMultiplier=t)},this.setVideoElmCurrentTime=function(t){i.vidElmIsProxy?a.setAttribute("currentTime",t):a.currentTime=t};let o=0;this.updateVideoTimeForDiff=function(t){if(i.vidElmIsProxy){if(a.currentTime==o)return;o=a.currentTime}var t=Math.max(0,(t-s.ls)/1e3),e=Math.abs(a.currentTime-t);(.2<e||cp_.IsPaused&&0!=e)&&i.setVideoElmCurrentTime(t)},this.drawContent=function(t){var e;this.updateVideoTimeForDiff(t),this.isHtml||(i.ctx.save(),i.ctx.translate(i.ctx_x,i.ctx_y),i.ctx.drawImage(a,0,0,s.w,s.h),i.ctx.restore()),i.aEn&&s.al&&(t=(s.al[0]+s.al[1])/2,t=Math.pow(10,t/10),e=Math.min(1,t*i.volumeMultiplier),Math.abs(a.volume-e)/a.volume<.02||(a.volume=Math.min(1,t*i.volumeMultiplier)))},this.stop=function(){this.isDisplayed=!1,this.isInScene=!1},this.isLoaded=function(t){return t?this.isPosterLoaded:this.loaded},this.setRate=function(t){this.footageValidAndLoaded()&&(a.playbackRate=t)},this.contentNeedRedraw=function(){return!0},this.updateLayerBoundaries=function(){var t=this;t.w=t.video.w,t.h=t.video.h,t.x=t.video.x,t.y=-t.video.y}}function tt(){P.call(this);var t=!1;this.drawContent=function(){t=!0,this.subElm.innerHTML||FB.insertAndExecute(this.subElm,this.html)},this.isLoaded=function(){return!0},this.contentNeedRedraw=function(){return!t},this.updateLayerBoundaries=function(){let e=this;var{w:t,h:i}=window.movie.comps.find(({id:t})=>t===e.precomp.compId);e.w=t,e.h=i}}function et(){var t,s=this,e=(P.call(this),this.image);function a(){return s.footage&&s.footage.url_&&s.footage.isLoaded&&!s.footage.loadFailed}e.ro=e.ro||5,e.bc=e.bc||"0a0a0a0",e.x=e.x||0,e.y=e.y||0,e.vAlign=e.vAlign||1,e.hAlign=e.hAlign||1,this.loadFootage=function(){e.url_&&(this.footage=new it(e.url_),this.img=this.footage.img)},e.url&&(this.footage={loaded:!1},3===e.ro||4===e.ro||5===e.ro&&k.isExtImg(e.url)||e.url.endsWith(".png")?(t=3,4===e.ro?t=1:3===e.ro&&(t=2),e.url_=k.getDynImgUrl(e.url,e.w,e.h,t,e.bc,e.vAlign,e.hAlign)):e.url_=e.url),this.isLoaded=function(){return!s.footage||s.footage.isLoaded},this.contentNeedRedraw=function(){return-1===this.drawTime},this.drawContent=function(){var t,e,i;s.isHtml?(i=(e=s).subElm,a()?0===i.innerHTML.length&&(t=e.img,i.appendChild(t),t.style.width=e.w+"px",t.style.height=e.h+"px",t.style.display="block",e.image.alt&&(t.alt=e.image.alt),e.image.w<e.w||e.image.h<e.h)&&(i.style.transform="translate("+(e.w-e.image.w)/2+"px,"+(e.h-e.image.h)/2+"px)"):e.drawTime=-1):(i=(t=s).ctx,0!==t.tr.a&&a()?(i.save(),i.translate(s.ctx_x,s.ctx_y),i.drawImage(t.img,0,0,t.image.w,t.image.h),i.restore()):t.drawTime=-1)},this.updateLayerBoundaries=function(){var t=this;t.w=t.image.w,t.h=t.image.h,t.x=+t.image.x,t.y=-t.image.y}}function it(t){this.url_=t,this.isLoaded=!1,this.loadFailed=!1;var e=this;this.img=document.createElement("img"),this.img.addEventListener("load",function(t){e.isLoaded=!0},!1),this.img.addEventListener("error",function(t){e.loadFailed=!0,e.isLoaded=!0;k.reportError("footage_load_error")},!1),void 0!==k.crossOrigin&&(this.img.crossOrigin=k.crossOrigin),this.img.src=t}function st(){l.call(this),this.isLoaded=function(){return!0},this.draw=function(t){if(this.isInScene)for(var e=0;e<this.children.length;e++)this.children[e].draw(t)}}function at(t){P.call(this),this.precomp.comp=Object.assign(Object.assign({},JSON.parse(JSON.stringify(movie.comps.find(({id:t})=>this.precomp.compId===t)))),{isPrecomp:!0}),t.call(this.precomp.comp);t=this.precomp.comp.innerContainer;this.subElm.appendChild(t),this.subElm.setAttribute("compId",this.precomp.compId),this.precomp.comp.setSize(this.precomp.comp.w,this.precomp.comp.h),this.drawContent=function(t){t=void 0===this.precomp.timeRemap?t-this.s:1e3*this.precomp.timeRemap;this.precomp.comp.drawFrame(t)},this.isLoaded=function(){return!this.precomp.comp.getFootageStatus().pending.length},this.contentNeedRedraw=function(){return!0},this.loadFootage=function(){this.precomp.comp.loadInitialFootages(),this.precomp.comp.loadAllFootages()},this.updateLayerBoundaries=function(){var{w:t,h:e}=this.precomp.comp||{};this.w=t,this.h=e};let e=this.stop.bind(this);this.stop=function(t){e(t),this.precomp.comp.stop()}}function T(){var g=this;P.call(this),this.shapeLayerMargin=20;for(var t=0;t<this.shape.shapes.length;t++){var e=this.shape.shapes[t],i=this.shape.shapes[t].tr;i&&(i.p=i.p||[0,0],i.s=i.s||[1,1],i.sk=i.sk||0,i.skx=i.skx||0,i.r=i.r||0,i.an=i.an||[0,0],i.a=i.a||1),e.fill=e.fill||null,e.stroke=e.stroke||null}function h(t){t=s(t);return _.fromPath(t).reduce((t,e)=>t+e.getLength(),0)}function c(r,n,o,l){var h=s(r);if(o<.01&&.99<l)return g.createShapePath(n,r);if(!(o<.01&&l<.01||.99<o)){r=[h];var c=n;h=o;n=l;let t=r.map(_.fromPath),e=t.flat().reduce((t,e)=>t+e.getLength(),0),i=e*h,s=e*n,a=0;for(var d of t){c.beginPath(),c.moveTo(d[0].p0[0],d[0].p0[1]);for(var u of d){var p=u.getLength();if(a+p<=i)c.moveTo(u.p3[0],u.p3[1]);else if(a<i&&a+p>i){var m=(i-a)/p,f=Math.max(1,(s-a)/p),m=u.getValueAtLengthPercent(m),f=1===f?1:u.getValueAtLengthPercent(f);let t=u.getSubBezier(m,!0);f<1&&(f=m*t.getLength()/u.getLength(),t=u.getSubBezier(f));var{x:f,y:m}=u.getPointAtTime(m);c.moveTo(f,m),t.draw(c)}else{if(!(a+p<=s))return void(f=(s-a)/p,m=u.getValueAtLengthPercent(f),u.getSubBezier(m).draw(c));u.draw(c)}a+=p}}}}function s(m){switch(m.ty){case u.Ellipse:return v=(e=m).p[0],t=e.p[1],i=e.s[0],e=e.s[1],{i:[[-(i/=2)*(s=.55284),0],[0,-(e/=2)*s],[i*s,0],[0,e*s],[-i*s,0]],v:[[v,t-e],[v+i,t],[v,t+e],[v-i,t],[v,t-e]],o:[[i*s,0],[0,e*s],[-i*s,0],[0,-e*s],[i*s,0]]};case u.Polystar:{v=m;let e=1===v.type?2*Math.ceil(v.pts):v.pts,t=v.r,i=v.oRad,[s,a]=v.p,r=1===v.type?v.iRad:v.oRad,n=2*Math.PI/e,o=t-Math.PI/2,l=[],h=[],c=[],d={i:h,v:l,o:c,c:1},u=s+Math.cos(o)*i,p=a+Math.sin(o)*i;l.push([u,p]);for(let t=0;t<e;t++){var f=t%2?r:i,g=s+Math.cos(o)*f,f=a+Math.sin(o)*f;c.push([0,0]),h.push([0,0]),l.push([g,f]),u=g,p=f,o+=n}return c.push([0,0]),h.unshift([0,0]),d;return}case u.Rectangle:var t=m,{p:[e,i],s:[s,a]}=t;return{i:[[-(s=s/2),0],[0,-(a=a/2)],[s,0],[0,a],[-s,0]],v:[[e+s,i-a],[e+s,i+a],[e-s,i+a],[e-s,i-a],[e+s+((null==(e=t.stroke)?void 0:e.w)||0)/2,i-a]],o:[[0,a],[-s,0],[0,-a],[s,0],[0,a]]};case u.Path:return m.path}var v,t}this.isLoaded=function(){return!0},this.contentNeedRedraw=function(t){return-1===g.drawTime||g.shape.isPropertiesUpdated()},this.createShapePath=function(o,l){switch(l.ty){case"rectangle":{var h=o;var c=l;let{p:[t,e],s:[i,s],r:a}=c,r=i/2,n=s/2;h.beginPath(),0<a?(c=Math.min(i,s),a>.5*c&&(a=.5*c),h.moveTo(t+r-a,e-n),h.arcTo(t+r,e-n,t+r,e-n+a,a),h.lineTo(t+r,e+n-a),h.arcTo(t+r,e+n,t+r-a,e+n,a),h.lineTo(t-r+a,e+n),h.arcTo(t-r,e+n,t-r,e+n-a,a),h.lineTo(t-r,e-n+a),h.arcTo(t-r,e-n,t-r+a,e-n,a)):(h.moveTo(t-r,e-n),h.lineTo(t+r,e-n),h.lineTo(t+r,e+n),h.lineTo(t-r,e+n)),h.closePath()}break;case"ellipse":c=o,t=(h=l).p[0],e=h.p[1],i=h.s[0],h=h.s[1],i/=2,h/=2,s=.55284,c.beginPath(),c.moveTo(t-i,e),c.bezierCurveTo(t-i,e-h*s,t-i*s,e-h,t,e-h),c.bezierCurveTo(t+i*s,e-h,t+i,e-h*s,t+i,e),c.bezierCurveTo(t+i,e+h*s,t+i*s,e+h,t,e+h),c.bezierCurveTo(t-i*s,e+h,t-i,e+h*s,t-i,e),c.closePath();break;case"polystar":s=l,(t=o).translate(s.p[0],s.p[1]),(1===s.type?(t,e)=>{var i,s,a=.35829,r=t.pts,n=t.r,o=t.oRad,l=t.oRo,h=t.iRad,c=t.iRo,d=(e.beginPath(),n),u=(d-=Math.PI/2,2*Math.PI/r),p=u/2,m=r-parseInt(r),f=(0!=m&&(d+=p*(1-m)),0);0!=m?(i=(f=h+m*(o-h))*Math.cos(d),s=f*Math.sin(d),e.moveTo(i,s),d+=u*m/2):(i=o*Math.cos(d),s=o*Math.sin(d),e.moveTo(i,s),d+=p);for(var g=!1,v=parseInt(2*Math.ceil(r)),y=0;y<v;y++){var x,w,b,C,T,_=g?o:h,k=0!=f&&y==v-2?u*m/2:p,P=i,M=s;i=(_=0!=f&&y==v-1?f:_)*Math.cos(d),s=_*Math.sin(d),0==c&&0==l?e.lineTo(i,s):(_=Math.atan2(M,P)-Math.PI/2,w=Math.cos(_),_=Math.sin(_),x=Math.atan2(s,i)-Math.PI/2,C=Math.cos(x),x=Math.sin(x),w=(b=g?h:o)*(T=g?c:l)*a*w,b=b*T*a*_,C=(T=g?o:h)*(_=g?l:c)*a*C,T=T*_*a*x,0!=m&&(0==y?(w*=m,b*=m):y==v-1&&(C*=m,T*=m)),e.bezierCurveTo(P-w,M-b,i+C,s+T,i,s)),d+=k,g=!g}e.closePath()}:(t,e)=>{for(var i,s,a=t.pts,r=t.r,n=t.oRad,o=t.oRo,l=(e.beginPath(),r),h=(l-=Math.PI/2,2*Math.PI/a),c=(i=n*Math.cos(l),s=n*Math.sin(l),e.moveTo(i,s),l+=h,Math.ceil(a)),d=0;d<c;d++){var u,p,m,f,g=i,v=s;i=n*Math.cos(l),s=n*Math.sin(l),0!=o?(p=Math.atan2(v,g)-Math.PI/2,u=Math.cos(p),p=Math.sin(p),f=Math.atan2(s,i)-Math.PI/2,m=Math.cos(f),f=Math.sin(f),u=n*o*.3*u,p=n*o*.3*p,m=n*o*.3*m,f=n*o*.3*f,e.bezierCurveTo(g-u,v-p,i+m,s+f,i,s)):e.lineTo(i,s),l+=h}e.closePath()})(s,t);break;case"path":f(o,l.path)}var t,e,i,s},this.drawContent=function(){if(!g.clk){let t=g.ctx,e=null,i=0;for(var s=0;s<g.shape.shapes.length;s++){var a=g.shape.shapes[s];if(a.ty===u.TrimPath)2===(e=a).tpType&&(i=g.shape.shapes.slice(s+1).reduce((t,e)=>t+h(e),0));else if(0!==a.tr.a){t.save(),t.translate(this.ctx_x,this.ctx_y),l=o=n=r=void 0;var r=t,n=a;if(null!=(n=n.tr)&&(r.globalAlpha=n.a,o=Math.tan(n.sk),l=-o*Math.abs(Math.cos(n.skx)),o=o*Math.abs(Math.sin(n.skx)),r.translate(n.p[0],n.p[1]),r.rotate(n.r),r.transform(1,o,l,1,0,0),r.transform(n.s[0],0,0,n.s[1],0,0),r.translate(-n.an[0],-n.an[1])),e){if(1===e.tpType){if(e.s===e.e){t.restore();continue}c(a,t,e.s,e.e)}else if(2===e.tpType){var o=g.shape.shapes.slice(s+1).reduce((t,e)=>t+h(e),0),l=h(a),r=i*e.s,n=i*e.e,r=e.s<.01?0:Math.max(0,Math.min(1,(r-o)/l)),n=.99<e.e?1:Math.max(0,Math.min(1,(n-o)/l));if(r===n){t.restore();continue}c(a,t,r,n)}}else g.createShapePath(t,a);o=t.globalAlpha;null!=a.fill&&(F(a.fill,t),t.fill()),null!=a.stroke&&0<a.stroke.w&&(t.globalAlpha=o,v(a.stroke,t),a.stroke.align?1===a.stroke.align?(t.clip(),t.lineWidth=2*a.stroke.w,t.stroke()):2===a.stroke.align&&(l=D(t),g.createShapePath(l,a),v(a.stroke,l),l.lineWidth=2*a.stroke.w,l.stroke(),l.globalCompositeOperation="destination-out",l.fill(),r=t.getTransform(),t.resetTransform(),t.drawImage(l.canvas,0,0),t.setTransform(r)):t.stroke()),t.restore()}}}},this.getInitialEdgeVertices=function(t){let e,i=this.getShapeBoundaries(t);if(t.stroke&&!(t.stroke.w<=0)){var s=t.stroke.w;switch(null==(e=t.stroke)?void 0:e.align){case 1:break;case 2:a(s*Math.sqrt(2));break;default:a(s*Math.sqrt(2)/2)}}return i;function a(t){i.bottom+=t,i.top-=t,i.left-=t,i.right+=t}},this.getShapeBoundaries=function(e){var{p:[i,s]=[0,0],s:[a,r]=[0,0],ty:t}=e;switch(t){case u.Rectangle:case u.Ellipse:return{left:i-a/2,top:s-r/2,right:i+a/2,bottom:s+r/2};case u.Path:let{i:n,o,v:l,c:t}=e.path;var h=l.map(([t,e])=>({x:[t],y:[e]}));return t&&(c=[0,1].map(t=>{let i=l.length-1;var e=l[i],s=l[i].map((t,e)=>+t+ +o[i][e]),a=l[0].map((t,e)=>+t+ +n[0][e]),r=l[0];return new _(e,s,a,r).getBoundaries(t)}),h.push({x:c[0],y:c[1]})),h.push(...l.slice(1).map((t,r)=>{var e=[0,1].map(t=>{var e=l[r],i=l[r].map((t,e)=>+t+ +o[r][e]),s=l[r+1].map((t,e)=>+t+ +n[r][e]),a=l[r+1];return new _(e,i,s,a).getBoundaries(t)});return{x:e[0],y:e[1]}})),h.reduce(({left:t,right:e,top:i,bottom:s},{x:a,y:r})=>({left:Math.min(t,...a),right:Math.max(e,...a),top:Math.min(i,...r),bottom:Math.max(s,...r)}),{left:1/0,right:-1/0,top:1/0,bottom:-1/0});case u.Polystar:var{p:[c,h],oRad:d}=e;return{left:c-d,right:c+d,top:h-d,bottom:h+d};default:return{left:0,top:0,right:800,bottom:800}}},this.updateLayerBoundaries=function(){var t=this,e=t.shape.shapes.map(t=>{if("trimpath"===t.ty)return null;var{tr:{an:[e,i],p:[s,a]=[0,0],s:[r,n]=[0,0],r:o=0}}=t,{left:t,top:l,right:h,bottom:c}=this.getInitialEdgeVertices(t);let d=(new DOMMatrix).translateSelf(s,a).rotateSelf(0,0,o/Math.PI*180).skewXSelf(0).skewYSelf(0).scaleSelf(r,n).translateSelf(-e,-i);var[s,a,o,r]=[[l,t],[l,h],[c,t],[c,h]].map(([t,e])=>new DOMPoint(e,t).matrixTransform(d)),n=[s.x,a.x,o.x,r.x],e=[s.y,a.y,o.y,r.y];return{left:Math.min(...n),right:Math.max(...n),top:Math.min(...e),bottom:Math.max(...e)}}).filter(t=>!!t),i=Math.min(...e.map(t=>t.left)),s=Math.max(...e.map(t=>t.right)),a=Math.min(...e.map(t=>t.top)),e=Math.max(...e.map(t=>t.bottom));t.w=Math.ceil(s-i+g.shapeLayerMargin),t.h=Math.ceil(e-a+g.shapeLayerMargin),t.x=Math.floor(i-g.shapeLayerMargin/2),t.y=Math.floor(-a+g.shapeLayerMargin/2),t.ctx_x=-t.x,t.ctx_y=t.y}}class _{constructor(t,e,i,s){this.accuracy=100,this.lengthsArr=null,this.length=null,this.p0=t,this.p1=e,this.p2=i,this.p3=s}getValueAtTime(t,e){return Math.pow(1-t,3)*this.p0[e]+Math.pow(1-t,2)*t*3*this.p1[e]+(1-t)*Math.pow(t,2)*3*this.p2[e]+Math.pow(t,3)*this.p3[e]}getPointAtTime(t){return{x:this.getValueAtTime(t,0),y:this.getValueAtTime(t,1)}}getLength(){if(!this.length){this.lengthsArr||(this.lengthsArr=[]);let e=this.getPointAtTime(0);this.length=0;for(let t=1;t<=this.accuracy;t++){var i=t/this.accuracy,i=this.getPointAtTime(i),s=Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2));this.length+=s,this.lengthsArr.push(s),e=i}}return this.length}getValueAtLengthPercent(t){this.length&&this.lengthsArr||this.getLength();var i=this.length*t;let s=0;for(let e=0;e<this.accuracy;e++){var a=this.lengthsArr[e];if((s+=a)>=i){let t=(s-i)/a;return(e+t)/this.accuracy}}return 1}getCriticalPointsByDimension(t){var e=-3*this.p0[t]+9*this.p1[t]-9*this.p2[t]+3*this.p3[t],i=6*this.p0[t]-12*this.p1[t]+6*this.p2[t],s=-3*this.p0[t]+3*this.p1[t],a=(-i+Math.sqrt(Math.pow(i,2)-4*e*s))/2*e,i=(-i-Math.sqrt(Math.pow(i,2)-4*e*s))/2*e,s=[this.p0[t],this.p3[t]];return isNaN(a)||s.push(a),isNaN(a)||s.push(i),s}getCriticalPoints(){return{x:this.getCriticalPointsByDimension(0),y:this.getCriticalPointsByDimension(1)}}getSubBezierByDim(t,e,i){var s=(1-t)*this.p0[e]+t*this.p1[e],a=(1-t)*this.p1[e]+t*this.p2[e],r=(1-t)*this.p2[e]+t*this.p3[e],n=(1-t)*s+t*a,a=(1-t)*a+t*r,t=(1-t)*n+t*a;return i?[t,a,r,this.p3[e]]:[this.p0[e],s,n,t]}getSubBezier(t,e){var i=this.getSubBezierByDim(t,0,e),t=this.getSubBezierByDim(t,1,e);return new _([i[0],t[0]],[i[1],t[1]],[i[2],t[2]],[i[3],t[3]])}draw(t){t.bezierCurveTo(this.p1[0],this.p1[1],this.p2[0],this.p2[1],this.p3[0],this.p3[1])}getBoundaries(t){var e=-3*this.p0[t]+9*this.p1[t]+-9*this.p2[t]+3*this.p3[t],i=6*this.p0[t]-12*this.p1[t]+6*this.p2[t],s=-3*this.p0[t]+3*this.p1[t],a=(-i+Math.sqrt(Math.pow(i,2)-4*e*s))/(2*e),i=(-i-Math.sqrt(Math.pow(i,2)-4*e*s))/(2*e),s=this.getValueAtTime(Math.min(1,Math.max(0,a)),t),e=this.getValueAtTime(Math.min(1,Math.max(0,i)),t),a=[];return isNaN(s)||a.push(s),isNaN(e)||a.push(e),a}static fromPath(s){var t,e=s.v.slice(1).map(([t,e],i)=>new _(s.v[i],[s.o[i][0]+s.v[i][0],s.o[i][1]+s.v[i][1]],[s.i[i+1][0]+t,s.i[i+1][1]+e],[t,e]));return s.c&&(t=s.v.length-1,e.push(new _([s.v[t][0],s.v[t][1]],[s.v[t][0]+s.o[t][0],s.v[t][1]+s.o[t][1]],[s.v[0][0]+s.i[0][0],s.v[0][1]+s.i[0][1]],[s.v[0][0],s.v[0][1]]))),e}}let rt=["alphabetic","top","hanging","middle","ideographic","bottom"],nt=["","miter","round","bevel"];function ot(){var T=this,i=(this.failedFonts=new Set,P.call(this),cp_.containerDiv.ownerDocument);let _=/[\u4E00-\u9FFF]/;T.isHtml||(i=document);var y=!1;function x(e,i,t,s,a,r){let n=t;for(let t=0;t<i.length;t++){var o=i[t],o=(r?e.fillText(o,n,s):e.strokeText(o,n,s),e.measureText(o).width);n+=o+a}}function u(t){var e,i;for(e of t.parts.map(t=>t.text).join(""))if(/\p{L}/u.test(e))return i=e,/^[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF]$/.test(i);return!1}function o(e,i){for(let t=0;t<e.parts.length;t++){var s=e.parts[t];s.w_*=i,s.size_use*=i,s.font_=k.getCtxFont(s.style,s.weight,s.size_use,s.family),s.x_*=i,s.y_*=i}e.h_*=i,e.w_*=i}"true"!==adParams.custom.enableServeDynamicFont&&k.loadFonts(T.text.txtObj.fonts),T.text.aeSrcTxt.isBoxText=null!=T.text.aeSrcTxt.boxTxtS,this.isLoaded=function(){if(i.fonts&&i.fonts.load){for(var e of T.text.txtObj.fonts){let t="true"===adParams.custom.enableServeDynamicFont?k.getFontShorthandString(e.family):k.getCtxFont(e.italic,e.weight,10,e.family);if(!this.failedFonts.has(t)&&!i.fonts.check(t))return i.fonts.load(t).catch(()=>{this.failedFonts.add(t)}),!1}return y=!0}return!1},this.contentNeedRedraw=function(){return-1===T.drawTime||!!T.text.isPropertiesUpdated&&T.text.isPropertiesUpdated()},this.drawContent=function(){var t=T,e=t.subElm;e&&(e.style.webkitFontSmoothing="antialiased"),t.isHtml||(t.ctx.save(),t.ctx.translate(t.ctx_x,t.ctx_y));try{var i,s=t,a=t.ctx,r=e,n=s.text.linesToDraw,o=Math.max(...n.map(t=>t.h_));s.isHtml?i="":a.textBaseline=rt[0],adParams.drawDebugBoxes&&(a?(a.rect(0,0,T.text.textBox.w,T.text.textBox.h),a.lineWidth=2,a.strokeStyle="#fab400",a.setLineDash([6,14]),a.stroke(),a.setLineDash([])):i+='<div style="position: absolute;width:'+T.text.textBox.w+"px;height:"+T.text.textBox.h+'px;outline: 2px dashed #fab400;outline-offset:-2px;"></div>');for(let t=0;t<n.length;t++){var l=n[t];for(let t=0;t<l.parts.length;t++){var h,c,d,u,p,m,style,f,g=l.parts[t],v=(+g.letterSpacing||0)*g.size_use/1e3;a?(a.font=g.font_,a.fillStyle=g.color,g.strokeWidth&&(void 0!==g.strokeOpacity&&(g.strokeColor=((t,e)=>{var i=9===t.length?parseInt(t.slice(7,9),16):255,i=Math.round(i/255*e*255);return""+t.slice(0,7)+i.toString(16).padStart(2,"0")})(g.strokeColor,g.strokeOpacity)),a.strokeStyle=g.strokeColor,a.lineWidth=g.strokeWidth,a.lineJoin=nt[(null==(h=s.text.stroke)?void 0:h.lj)||1]),0==v||void 0!==a.letterSpacing?(a.letterSpacing=v+"px",0<g.strokeWidth&&!g.strokeOverFill&&a.strokeText(g.text,g.drawX,g.drawY),a.fillText(g.text,g.drawX,g.drawY),0<g.strokeWidth&&g.strokeOverFill&&a.strokeText(g.text,g.drawX,g.drawY)):(0<g.strokeWidth&&!g.strokeOverFill&&x(a,g.text,g.drawX,g.drawY,v,!1),x(a,g.text,g.drawX,g.drawY,v,!0),0<g.strokeWidth&&g.strokeOverFill&&x(a,g.text,g.drawX,g.drawY,v,!1)),g.strikeThrough&&a.fillRect(g.drawX,g.drawY-(.5*g.size_use+g.strikeThrough)/2,g.w_,g.strikeThrough)):(h=parseInt(o),c=g.drawY-o,d=g.drawX,u=parseInt(g.size_use),p=g.text,m=g.weight,style=g.style,f=g.strikeThrough?"text-decoration: line-through;"+`text-decoration-thickness: ${g.strikeThrough}px;`:"",i+='<div data-w="'+g.w_+'" style="position: absolute;width:100%;height:'+h+"px;top:"+c+"px;left:"+d+'px"><div style="height:'+h+"px;font-size: "+u+"px;letter-spacing:"+v+"px;line-height: "+u+"px;overflow: visible;white-space: nowrap;text-overflow: visible;color:"+g.color+";font-weight:"+m+";font-style:"+style+";font-synthesis: none;"+f+"font-family:'"+g.family+"';\">"+k.htmlEncode(p)+'<div style="height: '+h+'px;display: inline-block;"></div></div></div>')}}s.isHtml&&(r.innerHTML=i,r.style.overflow="visible")}catch(t){k.reportExceptionError("text_layer_draw",t)}t.isHtml||t.ctx.restore(),y||(T.drawTime=-1)},this.calcPartsAndLinesWidthAndHeight=function(t){for(var e=0;e<t.length;e++){var i=t[e];i.w_=0;for(var s=i.h_=0;s<i.parts.length;s++){var a=i.parts[s],r=a.text;u(i)&&(r=""+r+""),a.text=r,a.size_use=parseInt(a.size),a.font_=k.getCtxFont(a.style,a.weight,a.size_use,a.family),a.w_=k.measureText(a.text,a.family,a.size_use,a.weight,a.style,a.letterSpacing||0,s<i.parts.length-1,!T.isHtml),a.x_=a.x_shift,a.y_=a.y_shift,i.w_+=a.w_,a.size_use>i.h_&&(i.h_=a.size_use)}}},this.calcPartsDrawPositions=function(i,s){if(0!==i.length){let e=((t,e,i=p.Top)=>{var s,a=T.getActualDrawingHeight(e),r=t-a,n=T.text.aeSrcTxt.isBoxText?.7*(null==(t=e[0])?void 0:t.h_):.7*T.text.aeSrcTxt.size;switch(i){case p.Top:return n;case p.Center:return Math.abs(r/2)+.7*(null==(s=e[0])?void 0:s.h_);case p.Bottom:return r+.7*(null==(s=e[0])?void 0:s.h_)}})(T.text.textBox.h,i,T.text.txtObj.verticalAlign);for(var a=0;a<i.length;a++){var r=i[a],n={l:"left",r:"right",c:"center",o:s.justif.toLowerCase()}[r.align];let t=0;for(var o=1,l=("center"===n?t=T.text.textBox.w/2-r.w_/2:"right"===n&&(t=T.text.textBox.w,o=-1),u(r)),h=!l&&"right"===n||l&&"right"!==n,c=0;c<r.parts.length;c++){var d=h?r.parts.length-1-c:c,d=r.parts[d];d.drawX="right"===n?t-d.w_+d.x_:t+d.x_,d.drawY=e+d.y_,t+=o*d.w_}a<i.length-1&&(l=i[a+1],e+=r.h_*r.lead*.3+l.h_*l.lead*.7)}}},this.resizeOverflowingLines=function(t){for(var e of t){var i,s;e.w_>T.text.textBox.w&&(i=T.getMinAllowedScale([e]),s=T.text.textBox.w/e.w_,s=Math.max(s,i),o(e,s))}},this.globalResizeForOverflow=function(t){var e=T.getMinAllowedScale(t),i=Math.max(e,Math.min(...t.map(t=>T.text.textBox.w/t.w_)));if(i<1)for(var s of t)o(s,i)},this.resizeOverflowingHeight=function(t){var{aeSrcTxt:e,textBox:i}=T.text,s=T.getActualDrawingHeight(t),a=T.getMinAllowedScale(t);let r;if(r=e.isBoxText?i.h/s:(i.h-.7*e.size)/(s-.7*(null==(i=t[0])?void 0:i.h_)),(r=Math.max(r,a))<1)for(var n of t)o(n,r)},this.applyAnimators=function(t,e){if(null!=e&&e.length)for(var{fillColor:i,opacity:s,position:a,tracking:r,rangeSelectors:n}of e)for(var{start:o,end:l,units:h,offset:c,basedOn:d,smoothness:u}of n){var p=((t,e)=>{switch(e){case m.Char:return t.reduce((t,e)=>t+e.parts.flatMap(t=>t.text.split("")).length,0);case m.CharWithoutSpace:return t.reduce((t,e)=>t+e.parts.flatMap(t=>t.text.match(/\s*[^\s]\s*/g)).length,0);case m.Word:return t.reduce((t,e)=>t+e.parts.flatMap(t=>t.text.match(/\s*[^\s]+\s*/g)).length,0);case m.Line:return t.length}})(t,d);p=p,h=h,c=c,o=o,l=l,u=u/100,h===L.Percent&&(o=p*o/100,l=p*l/100,c=p*c/100),o+=c,l+=c,h=[],1<=Math.floor(o)&&h.push({offset:Math.floor(o),effect:0}),0<u&&1-u<o%1&&(p=1-(o%1-(1-u))/u,h.push({offset:Math.max(0,Math.floor(o)+1),effect:p})),Math.floor(l)>Math.floor(o)&&h.push({offset:Math.max(0,Math.floor(l)),effect:1}),0<u&&1-u<l%1&&(c=(l%1-(1-u))/u,h.push({offset:Math.max(0,Math.floor(l)+1),effect:c})),((t,r,n,o,l)=>{t.forEach(({part:e,effect:i,isLineStart:s})=>{if(e.text){e.color||(e.color="#000000");let t=e.color.startsWith("rgba")?e.color.replace(/rgba\((.+)\)/,"$1").split(",").map(t=>+t):lt(e.color);var a;(t=r?t.map((t,e)=>Math.round(t+(r[e]-t)*i)):t).push(1),void 0!==n&&(t[3]*=1-(1-n/100)*i,e.strokeOpacity=t[3]),e.color=b(t),o&&(e.x_shift+=o[0]*i,e.y_shift+=o[1]*i),l&&(a=20*l.trackingAmount/(e.size/50)*i,e.letterSpacing+=a,s||(e.x_shift+=a/1e3*e.size*(l.trackingType/2)))}})})(((o,l,t)=>{let h=0,c=0,d=[];function e(e){for(var i of o)for(let t=0;t<i.parts.length;t++){var s=i.parts[t],a=l[c];if(!a)break;var r=s.text.match(e),n=(null==r?void 0:r.length)||0;h+n<=a.offset?(a.effect&&d.push({part:s,effect:a.effect,isLineStart:0===t}),h+n===a.offset&&c++,h+=n):(i.parts.splice(t+1,0,Object.assign(Object.assign({},s),{text:r.slice(a.offset-h).join("")})),s.text=r.slice(0,a.offset-h).join(""),a.effect&&d.push({part:s,effect:a.effect,isLineStart:0===t}),h+=a.offset-h,c++)}}switch(t){case m.Char:e(/./gs);break;case m.CharWithoutSpace:e(/\s*[^\s]\s*/gs);break;case m.Word:e(/\s*[^\s]+\s*/gs);break;case m.Line:h=1;for(let t=0;t<o.length;t++){let e=l[c];var i=o[t];if(!e)break;e.effect&&d.push(...i.parts.map(t=>({part:t,effect:e.effect,isLineStart:!0}))),h===e.offset&&c++,h++}}return d})(t,h,d),i,s,a,r)}},this.removeTrailingSpaces=function(t){for(var e of t){var i=e.parts.length;0<i&&((e=e.parts[i-1]).text=e.text.replace(/\s+$/,""))}},this.getMinAllowedScale=function(t){var e=T.text.txtObj;return(e.minFontSize||5)/t.reduce((t,{parts:e})=>e.reduce((t,{size:e})=>Math.min(t,e),t),1/0)},this.wrapLinesToDrawAndScaleDownFontSizeToFitBox=function(t,a,l){if(!t.text||!a)return[];let r=t.text;var n=r.aeSrcTxt;let u=1,p=[];for(var m=T.getMinAllowedScale(a);u>=m;){let e=0;var f,g=(t=>{let n=[];for(let e of t){let a=t.findIndex(t=>t===e),r=(n[a]=Object.assign(Object.assign({},e),{parts:[]}),[]);for(let s of e.parts){let i=s.text.split(/[ \t\n\r\f\v\u2028\u2029]/g).map(t=>t.replace("&nbsp;"," "));i.forEach((t,e)=>{e<i.length-1?(r.push(Object.assign(Object.assign({},s),{text:i[e]+" "})),n[a].parts.push(r),r=[]):i[e]&&(r.push(Object.assign(Object.assign({},s),{text:i[e]})),_.test(i[e]))&&(n[a].parts.push(r),r=[])})}r.length&&n[a].parts.push(r)}return n})(a);let i=0,s=!(p=[]),d=t.text.textBox.w;for(l.HScaleUse98&&(d*=.98);f=g.shift();){let o=0,t=0;for(let c=0;c<f.parts.length;c++){let r=0,h=0,n=0;for(let{size:t,text:e,weight:i,style,letterSpacing:s=0,family:a}of f.parts[c]){var v=t*u,y=(o=Math.max(v,o),h+=k.measureText(e,a,v,i,style,s,!1,!T.isHtml),l.HScaleUse98?e:e.replace(/\s+$/,""));r+=k.measureText(y,a,v,i,style,s,!1,!T.isHtml),n=s*t/1e3}if(t+r>d){if(0===t){if(u<=m||_.test(f.parts[c][0].text)){var x=f.parts[c];let o=0,l=!1;for(let n=x.length-1;0<=n;n--){let{text:e,size:i,family:s,style,weight:a,letterSpacing:r}=x[n];for(let t=e.length-1;0<t;t--){w=e;var w=(b=t)<w.length&&[""].includes(w[b])&&0<b?b-1:b,b=e.substring(w),b=k.measureText(b,s,i*u,a,style,r,!1,!T.isHtml);if(h-o-b<=d){p.push(Object.assign(Object.assign({},f),{parts:[...f.parts[c].slice(0,n),Object.assign(Object.assign({},f.parts[c][n]),{text:e.substring(0,w)})]})),g.unshift(Object.assign(Object.assign({},f),{parts:[[Object.assign(Object.assign({},f.parts[c][n]),{text:e.substring(w)}),...f.parts[c].slice(n+1)],...f.parts.slice(c+1)]})),l=!0;break}}if(l)break;o+=k.measureText(e,s,i*u,a,style,r,!1,!T.isHtml)}break}s=!0;break}var C=f.parts[c-1],C=C[C.length-1];C.text=C.text.replace(/\s+/g,""),p.push(Object.assign(Object.assign({},f),{parts:f.parts.slice(0,c).flat()})),g.unshift(Object.assign(Object.assign({},f),{parts:f.parts.slice(c)}));break}t+=h+n,c>=f.parts.length-1&&p.push(Object.assign(Object.assign({},f),{parts:f.parts.flat()}))}if(s)break;e?e+=i*p[p.length-1].lead*.3+o*f.lead*.7:e+=.7*(n.isBoxText?o:n.size),i=o}if(!s&&(l.noVerticalScaleDownToFitHeight||e<=r.textBox.h))break;if(s=!1,u===m)break;u=Math.max(u-.05,m)}return this.combineSimilarParts(p),p.forEach(t=>t.parts.forEach(t=>{t.size*=u,t.x_shift*=u,t.y_shift*=u})),p},this.combineSimilarParts=function(t){var e,s=["color","size","style","weight","x_shift","y_shift","letterSpacing","strikeThrough","family"];for(e of t){var a=[];for(let i of e.parts){let e=a[a.length-1];e&&s.every(t=>i[t]===e[t])?e.text+=i.text:a.push(i)}e.parts=a}return t},this.getActualDrawingHeight=function(r){return r.reduce((t,{h_:e,lead:i},s)=>{var a;return 0===s?.7*(null==(a=r[0])?void 0:a.h_):t+e*i*.7+r[s-1].h_*r[s-1].lead*.3},0)},this.trimOverflowedHeight=function(a){if(a.length){var{aeSrcTxt:t,textBox:r}=T.text;if(r.w<=0||r.h<=0)a.length=0;else{var n=t.isBoxText?r.h:r.h-.7*t.size+.7*(null==(t=a[0])?void 0:t.h_);if(!(T.getActualDrawingHeight(a)-n<.1)){for(;a.pop(),T.getActualDrawingHeight(a)>n;);var o=a[a.length-1];let t=o.parts[o.parts.length-1],e=o.w_;var l="...";let i=k.measureText(l,t.family,t.size_use,t.weight,t.style,t.letterSpacing||0,!1,!T.isHtml);for(;e-t.w_+i>r.w;)e-=t.w_,o.parts.pop(),t=o.parts[o.parts.length-1],i=k.measureText(l,t.family,t.size_use,t.weight,t.style,t.letterSpacing||0,!1,!T.isHtml);let s;for(;(s=k.measureText(t.text+l,t.family,t.size_use,t.weight,t.style,t.letterSpacing||0,!1,!T.isHtml))>r.w;)t.text=t.text.substring(0,t.text.length-1);t.text+=l,t.w_=s}}}},this.scaleDownFontSizeToFitBoxNoWrap=function(t,e){var i=T.text.txtObj.globalScale;if(e.noVerticalScaleDownToFitHeight||T.resizeOverflowingHeight(t),i?T.globalResizeForOverflow(t):T.resizeOverflowingLines(t),e.legacyYCorrectionComplexTextBoxTxt&&0<t.length&&T.isHtml){let e=Math.max(...t.map(t=>t.h_))-t[0].h_;t.forEach(t=>{t.parts.forEach(t=>{t.y_+=e})})}},this.updateLinesToDraw=function(){var t=this,{aeSrcTxt:e,animators:i,txtObj:s}=t.text,{allCaps:a,wrapText:r,lines:n,features:o}=s;a&&n.forEach(t=>{t.parts.forEach(t=>{t.text=t.text.toUpperCase()})});let l;r?(l=t.wrapLinesToDrawAndScaleDownFontSizeToFitBox(t,n,o),t.removeTrailingSpaces(l),t.applyAnimators(l,i),this.combineSimilarParts(l),t.calcPartsAndLinesWidthAndHeight(l)):(l=JSON.parse(JSON.stringify(n)),t.removeTrailingSpaces(l),t.applyAnimators(l,i),this.combineSimilarParts(l),t.calcPartsAndLinesWidthAndHeight(l),t.scaleDownFontSizeToFitBoxNoWrap(l,o)),s.features.noTrimOverflowedHeight||t.trimOverflowedHeight(l),t.calcPartsDrawPositions(l,e),t.text.linesToDraw=l},this.updateLayerBoundaries=function(){var t,e=this,i=e.text.textBox;e.updateLinesToDraw(),e.w=i.w,e.h=i.h,e.x=i.x,e.y=-i.y;let s=0,a=0,r=i.w,n=i.h;for(t of e.text.linesToDraw)for(var o of t.parts){var l=o.drawX,h=o.drawX+o.w_,c=o.drawY-+o.size_use,o=o.drawY+.5*o.size_use;l<s&&(s=l),h>r&&(r=h),c<a&&(a=c),o>n&&(n=o)}e.wx=2*Math.max(-s,r-e.w),e.hx=2*Math.max(-a,n-e.h)}}function lt(t){t=t.match(/[\da-fA-F]{2}/g).map(t=>parseInt(t,16));return 3<t.length&&(t[3]/=255),t}function ht(){("Shape"===this.originalType?T:P).call(this),this.script=document.createElement("script"),this.script.setAttribute("data-args",JSON.stringify(this.widget.args)),this.script.src=this.widget.scriptUrl,this.loadFonts=function(){var t=Object.values(this.widget.args).filter(t=>"Font"===(null==t?void 0:t.type));if("true"===adParams.custom.enableServeDynamicFont){var e,i=k.getCurrentDoc(),s=i.createElement("style");i.head.appendChild(s);for(e of t){var a=e.languages||"english,spanish",a=`@font-face {font-family: '${e.family}';src: url('https://${adParams.fontHost}/font/${adParams.clientEncId}/${k.extractEncodedFontKeyFromFontUrl(e.url)}/languages?l=${a}') format('woff2');}`;s.sheet.insertRule(a),k.loadFontByFamily(e.family)}}else k.loadFonts(t)},this.loadFonts();var t,e=!1;this.drawContent=function(){e=!0,this.subElm.style.webkitFontSmoothing="antialiased",this.subElm.innerHTML||this.subElm.appendChild(this.script)},this.isLoaded=function(){return!0},this.contentNeedRedraw=function(){return!e};let s=null==(t=this.updateLayerBoundaries)?void 0:t.bind(this);this.updateLayerBoundaries=function(){var t=this;switch(t.originalType){case"Text":var e=t.text.textBox;t.w=e.w,t.h=e.h,t.x=e.x,t.y=-e.y;break;case"Image":t.w=t.image.w,t.h=t.image.h,t.x=+t.image.x,t.y=-t.image.y;break;case"Video":t.w=t.video.w,t.h=t.video.h,t.x=t.video.x,t.y=-t.video.y;break;case"Shape":t.shapeLayerMargin=0,s();break;case"Precomp":var{w:e,h:i}=this.precomp.comp||{};t.w=e,t.h=i}}}function ct(t,i){M.call(this);var s=this;this.update=function(t,e){for(var i=0;i<this.children.length;i++)this.children[i].update(t,e);a,!0!==this.camera.isDefaultCam&&this.camera.update(),this.lastTime=t},this.updateLayersWorldMatrixCSSTransformAndAddRemoveFromDOM=function(){!0!==this.camera.isDefaultCam&&this.camera.isPropertiesUpdated()&&this.camera.updateMatrix();let i=s.innerContainer;s.l.forEach(t=>{var e;t.element&&("Video"===t.ty&&k.isVpaid()?t.vidElmIsProxy||(t.vid.style.opacity=t.isDisplayed?1:0):t.isDisplayed?(t.updateLayerMatrixWorld(),t.updateLayerCSSTransform(),t.element.parentElement||((e=document.createElement("div")).style.cssText="position:absolute;transform: translateZ(0px)",e.id="layer_"+t.i,e.style.pointerEvents="none",e.style.touchAction="none",e.style.zIndex=5*-t.i,e.appendChild(t.element),i.appendChild(e),t.midDiv=e)):t.element.parentElement&&(t.element.remove(),t.midDiv.remove(),t.midDiv=null))})},this.draw=function(t,e){for(var i=0;i<this.children.length;i++)this.children[i].draw(t)},this.play=function(t){for(var e=0;e<this.l.length;e++)"Video"!==this.l[e].ty&&"Audio"!==this.l[e].ty||this.l[e].play(t)},this.setRate=function(t){for(var e=0;e<this.l.length;e++)"Video"!==this.l[e].ty&&"Audio"!==this.l[e].ty||this.l[e].setRate(t)},this.pause=function(t,e){for(var i=0;i<this.l.length;i++)"Video"!==this.l[i].ty&&"Audio"!==this.l[i].ty||this.l[i].pause(t,e)},this.stop=function(){for(var t=0;t<this.l.length;t++)this.l[t].stop();this.lastTime=-999999},this.goTo=function(t,e){if(s.stop(),s.drawFrame(t,e),e)for(var i=0;i<this.l.length;i++)"Video"!==this.l[i].ty&&"Audio"!==this.l[i].ty||this.l[i].pause(t)},this.mute=function(t){for(var e=0;e<this.l.length;e++)this.l[e].mute!==i&&this.l[e].mute(t)},this.vol=function(t){for(var e=0;e<this.l.length;e++)this.l[e].vol!==i&&this.l[e].vol(t)},this.loadAllFootages=function(){for(var t of s.l)t.loadFootage&&0<t.start&&t.loadFootage()},this.loadInitialFootages=function(){for(var t of s.l)t.loadFootage&&t.start<=0&&t.loadFootage()},this.getFootageStatus=function(t){try{for(var e=[],i=0;i<this.l.length;i++){var s=this.l[i];if(!(t&&0<s.start)&&!s.isLoaded(t))switch(s.ty){case"Image":e.push(s.image.url);break;case"Text":e.push("font: "+s.text.aeSrcTxt.fontFamily+" "+s.text.aeSrcTxt.weight);break;case"Precomp":e.push(...s.precomp.comp.getFootageStatus().pending);break;case"Video":e.push(s.video.url);break;case"Audio":e.push(s.audio.url)}}return{pending:e,failed:[]}}catch(t){return k.reportExceptionError("getFootageStatus",t),{pending:[],failed:[]}}},this.getCameraLayerAtTime=function(e){return this.l.find(t=>"Camera"===t.ty&&t.s>=e&&t.s<e)},this.setClearColor=function(t,e){var i,s="transparent";1<=e?(i=t.toString(16),s="#"+Array(6-i.length+1).join("0")+i):0<e&&(s="rgba("+((i=Math.floor(t))>>16&255)+","+(i>>8&255)+","+(255&i)+","+e+")"),this.innerContainer.style.backgroundColor=s},this.setSize=function(t,e){this.innerContainer.style.width=t+"px",this.innerContainer.style.height=e+"px"};let a=this.l.find(t=>"Camera"===t.ty);this.l.forEach(e=>{var t;e.has_tm&&e.en&&(t=this.l.find(t=>t.i===e.has_tm))&&((e.tml=t).d_tml||(t.d_tml=[]),t.is_tm=!0,t.d_tml.push(e))}),comp.l=comp.l.filter(t=>{function s(t){return!t.en&&!t.is_tm}return s(t)&&(t.ty="Null"),!function t(e){return s(e)&&(i=e.i,comp.l.filter(t=>+t.pi===i).every(t));var i}(t)}).sort((t,e)=>t.is_tm?-1:e.is_tm?1:+e.i-t.i);for(var e=0;e<s.l.length;e++)switch((s.l[e].comp=s).l[e].ty){case"Null":st.call(s.l[e]);break;case"Image":et.call(s.l[e]);break;case"Text":ot.call(s.l[e]);break;case"Shape":T.call(s.l[e]);break;case"Precomp":at.call(s.l[e],ct);break;case"Video":Q.call(s.l[e]);break;case"Audio":Z.call(s.l[e]);break;case"HTMLWidget":tt.call(s.l[e]);break;case"Widget":ht.call(s.l[e])}this.children=[];for(var r=0;r<this.l.length;r++)if(this.l[r].pi===i)this.children.push(this.l[r]),this.l[r].parent=null;else for(e=0;e<this.l.length;e++)if(this.l[e].i==this.l[r].pi){this.l[r].parent=this.l[e],this.l[e].children.push(this.l[r]);break}for(e=0;e<this.l.length;e++)this.l[e].sceneStart=this.l[e].getEaliestStart(),this.l[e].sceneEnd=this.l[e].getLatestEnd();this.clickableLayers_=[];for(e=0;e<this.l.length;e++)this.l[e].clk&&this.clickableLayers_.push(this.l[e]);this.innerContainer=document.createElement("div"),this.innerContainer.style.cssText="position:absolute;z-index:0;top:0px;left:0px;overflow:hidden;opacity:1;background-color:transparent",this.innerContainer.className="domElement innerContainer";var n=((1<<24)+(parseInt(255*this.bgC[0])<<16)+(parseInt(255*this.bgC[1])<<8)+parseInt(255*this.bgC[2])).toString(16).slice(1);this.bgA=this.bgA||1,this.isPrecomp||adParams.custom.isVpaid||this.setClearColor(n,this.bgA),this.camera=this.getCameraLayerAtTime(0)||new dt(this),Math.atan(this.h/(2*this.camera.zo)),Math.PI,this.w,this.h,this.drawFrame=function(t,e){try{this.update(t,e),this.updateLayersWorldMatrixCSSTransformAndAddRemoveFromDOM(),this.draw(t)}catch(t){k.reportExceptionError("drawFrame",{adParams:JSON.stringify(adParams),stage:"",exception:JSON.stringify(t)})}}.bind(this),this.parentPlayer=t,this.lastTime=-999999}function M(){var t,n=[],o=[],e=!1;for(t in this)if(this[t]instanceof Array)for(var i=this[t],s=0;s<i.length;s++)"object"==typeof i[s]&&M.call(i[s])&&o.push(i[s]);else if("object"==typeof this[t]){var a,r=this[t];if(null!=r)if(r.k&&r.k instanceof Array)e=!0,r="path"==t?V.ShapePropertyFactory.getShapeProp(r):V.PropertyFactory.getProp(r),n.push({key:t,data:r});else if(r.val&&r.val instanceof Array){if(r.mult&&1!=r.mult)for(s=0;s<r.val.length;s++)r.val[s]*=r.mult;1===r.val.length&&(r.val=r.val[0]),this[t]=r.val}else"path"==t&&r.val?(a=this[t].c,this[t]=r.val,this[t].c=a):M.call(r)&&o.push(r)}if(this.isPropertyUpdated_=!1,this.isPropertiesUpdated=()=>!1,e||0<o.length){for(var l of n)this[l.key]=l.data.getValueAtTime(0);return this.isPropertiesUpdated=()=>this.isPropertyUpdated_||o.some(t=>t.isPropertiesUpdated()),this.updateProperties=function(t){let e=!1;for(var i=0;i<n.length;i++){var s=n[i].key,a=JSON.parse(JSON.stringify(this[s])),r=n[i].data.getValueAtTime(t);e=e||!k.deepEqual(a,r),this[s]=r}this.isPropertyUpdated_=e;for(i=0;i<o.length;i++)o[i].updateProperties(t)}.bind(this),!0}return!1}function dt(t){this.zo=1.38888*t.w,this.p=[t.w/2,t.h/2,-this.zo],this.an=[t.w/2,t.h/2,0],this.o=[0,0,0],this.rx=0,this.ry=0,this.rz=0,this.isDefaultCam=!0,this.t=!1}let B={COMP:ct},ut={default:"Default","items[0].clickUrl":"Item_1","items[1].clickUrl":"Item_2","items[2].clickUrl":"Item_3","items[3].clickUrl":"Item_4","items[4].clickUrl":"Item_5","items[5].clickUrl":"Item_6","items[6].clickUrl":"Item_7","items[7].clickUrl":"Item_8"};class pt extends PlayerBase{init(t,a,e,i){var r;this.comp=t.comps[0],this.movie=t,window.comp=this.comp,this.B=B,t.comps.forEach(t=>{t.l.forEach(t=>{t.i=+t.i})}),this.mergeMapping(),this.refactorTextData(),"true"===a.custom.enableServeDynamicFont&&(t=this.extractDistinctCharsPerFont(this.movie),r=e.ownerDocument.createElement("style"),e.ownerDocument.head.appendChild(r),t.forEach(({url:i,families:t,chars:s})=>{t.forEach(t=>{var e;s&&(e=this.getUnicodeRangesOrChars(s),r.sheet.insertRule(`@font-face {font-family: '${t}'; src: url('https://${a.fontHost}/font/${a.clientEncId}/${FB.extractEncodedFontKeyFromFontUrl(i)}/${e}') format('woff2');}`),FB.loadFontByFamily(t))})})),super.init(this.comp,a,e,i),this.scheduleSubLoad()}scheduleSubLoad(){comp.loadInitialFootages(),!0!==this.isVpaid&&adParams.subLoadDelay?-1===adParams.subLoadDelay?FB.sendMsgToHost("getLoadStatus"):setTimeout(()=>{this.initSubLoad()},1e3*adParams.subLoadDelay):this.initSubLoad()}getUnicodeRangesOrChars(t){var i,s=[[65,90],[97,122],[160,255],[256,383],[384,591],[7680,7935],[880,1023],[1024,1279],[1280,1327],[1328,1423],[1424,1535],[1536,1791],[1872,1919],[2304,2431],[2432,2559],[2560,2687],[2944,3071],[3584,3711],[12352,12447],[12448,12543],[32,64],[91,96],[123,127],[8192,8303],[8304,8351],[8352,8399],[8448,8527],[8528,8591]],a=[];for(i of t){let e=i.codePointAt(0);if(!(e<=31)&&!a.some(t=>e>=t[0]&&e<=t[1])){var r=s.find(t=>e>=t[0]&&e<=t[1]);if(!r)return"chars/"+encodeURIComponent(t);a.push(r)}}return"unicode-ranges/"+a.map(t=>t[0].toString(16).padStart(4,"0")+"-"+t[1].toString(16).padStart(4,"0")).join("_")}extractDistinctCharsPerFont(t){let h={};return t.comps.forEach(t=>{t.l.forEach(l=>{if("Text"===l.ty){let o=l.text.txtObj;o.lines.forEach(t=>{t.parts.forEach(t=>{let e,i,{family:s,text:a}=t;o.allCaps&&(a=a.toUpperCase());var r,n=(null==(i=null==(e=l.text.txtObj.fonts)?void 0:e.find(t=>t.family==s))?void 0:i.url)||l.text.fontFileUrl;h[n]||(h[n]={families:new Set,charsSet:new Set}),h[n].families.add(s);for(r of a)"\n"!==r&&h[n].charsSet.add(r)})})}})}),Object.entries(h).map(([t,{families:e,charsSet:i}])=>({url:t,families:e,chars:Array.from(i).sort().join("")}))}initSubLoad(){this.fire("sub_load_initiated"),comp.loadAllFootages()}mergeMapping(){var v,y,x;if("undefined"!=typeof mapping){this.isPlatformMapped="true"===adParams.custom.isPlatformMapped;let t=mapping.dynamicMapping;for(let{compId:f,layerId:g,dynamicDataObj:o}of t)try{let{conditions:e,colorOverlay:s,clickUrl:a,widget:r,alt:n,fillColor:l,isValid:t,strokeColor:h,txtData:c,url:d,html:u,mappingId:i,font:p,qr:m}=o;if(t){let o,t=null==(v=this.movie.comps.find(({id:t})=>+t==+f))?void 0:v.l;if(o=this.isPlatformMapped?null==t?void 0:t.find(t=>t.mappingId===i):null==t?void 0:t.find(({i:t})=>+t==+g),o)if(this.isPassConditions(e)){let{ty:t,eff:e}=o;switch(t){case"Shape":o.shape.shapes.forEach(t=>{l&&t.fill&&this.eval(l)&&(t.fill.o.c.val=this.hexToRgb(this.eval(l)),t.fill.t=w.Solid),h&&t.stroke&&this.eval(h)&&(t.stroke.o.c.val=this.hexToRgb(this.eval(h)),t.stroke.t=w.Solid)});break;case"Image":if(n&&(o.image.alt=this.eval(n)),d&&(o.image.url=this.eval(d)),m){let{v:t,dpSourceType:e}=style[m.paramKey],{backgroundColor:i,foregroundColor:s,eccLevel:a,text:r}=t,n=e?eval(r)(m.index):r;n&&"default"!==n||(n=adParams.clickUrl||adParams.fbClickUrl),o.image.url=`${FB.DynImgCdnHost}/qrCode/${adParams.clientEncId}/${s.slice(1)}/${i.slice(1)}/${a}?u=`+encodeURIComponent(n)+(adParams.ctx?"&ctxKey="+adParams.ctx:"")+(null!=(y=adParams.custom)&&y.clkCtx?"&clkCtx="+(null==(x=adParams.custom)?void 0:x.clkCtx):"")}break;case"Video":d&&(o.video.url=this.eval(d));break;case"Text":if(c&&(o.text.txtData=Object.assign(Object.assign(Object.assign({},o.text.txtData),c),{parts:c.parts.map(t=>Object.assign(Object.assign({},t),{val:t.isStatic?t.val:this.evalText(t.val)}))})),l&&this.eval(l)&&(o.text.aeSrcTxt.fColArr=this.hexToRgb(this.eval(l)).map(t=>t/255)),h&&this.eval(h)&&(o.text.aeSrcTxt.sColArr=this.hexToRgb(this.eval(h)).map(t=>t/255)),p){let t=this.eval(p);t&&(o.text.fontFileUrl=t,o.text.aeSrcTxt.fontFamily=FB.hashCode(t).toString())}break;case"Precomp":u&&(o.html=this.eval(u),o.ty="HTMLWidget")}if(a&&(o.clk="default"!==a&&this.eval(a)||"default",this.isPlatformMapped?o.clkType=style[a.paramKey].includes("items")?"Item_"+(a.index+1):"Custom":o.clkType=ut[a]||"Custom"),r&&!o.tm&&!["Null","Audio"].includes(t)){let s=style[r.paramKey];for(let[t,{value:i,isDynamic:e}]of Object.entries(s.args))s.args[t]=e?eval(style[i])(r.index):i,items&&e&&(s.args[t+"_items"]=items.map((t,e)=>eval(style[i])(e)));o.widget=s,o.originalType=o.ty,o.ty="Widget"}let i=e.find(t=>"colOver"===t.ty);i&&s&&(i.c=this.hexToRgb(this.eval(s)))}else this.removeLayerWithChildren(+o.i,f)}}catch(t){FB.reportError(`Failed to map layer ${g}. (comp ${f})`,t)}}}hexToRgb(t){return t.substring(1).match(/.{2}/g).map(t=>parseInt(t,16))}rgbToHex(t){return"#"+t.map(t=>Math.round(255*+t).toString(16).padStart(2,"0")).join("")}removeLayerWithChildren(e,i){var t,s,a,r=movie.comps.find(t=>t.id===i);r.l=r.l.filter(t=>+t.i!=+e);for({i:t,pi:s,has_tm:a}of r.l)s!==e&&a!==e||this.removeLayerWithChildren(t,i)}eval(i){if(this.isPlatformMapped){let{paramKey:t,index:e}=i;return eval(style[t])(e)}return eval(i)}evalText(t){let i=t.index||0,s=this.eval(t)||"",e=t=>{s.startsWith("JSON3=")&&(t=JSON.parse(`"${t}"`));let e=eval(t.replace(/\u241E/g,""))(i);return s.startsWith("JSON3=")&&(e=JSON.stringify(e).replace(/(^")|("$)/g,"")),e};return s.replace(/\u241E.+?\u241E/gs,e)}isPassConditions(t){return null!=t&&t.length?this.isPlatformMapped?t.every(({index:t,value:e,paramKey:i})=>e?i?eval(style[i])()===e:eval(e)(t):!0):eval(t.join(" && ")):!0}getFontFamily(t){var e=t.replace(/^(.+)-.*$/,"$1");return["arial","times","times new roman"].includes(e.toLowerCase())?e.toLowerCase():t}refactorTextData(){var t,c=/\r\n|\n|\r|\u0003|\$\$/;for(t of this.movie.comps)for(var e of t.l)if("Text"===e.ty||"Text"===e.originalType){let o=e.text.aeSrcTxt;var d=(e.text.txtData||{}).parts,u=o.txtObj?o.txtObj.verticalAlign:o.verticalAlign||0,p=o.txtObj?o.txtObj.minFontSize:null!=(p=o.minFontSize)?p:5,i=null!=(i=o.strikeThrough)?i:0;let l=(o.lead||1.2*o.size)/o.size;var m=[{url:"",family:o.fontFamily,weight:o.weight,italic:o.italic}];let h={color:this.rgbToHex(o.fColArr),size:o.size,sizeUnits:"px",style:o.italic?"italic":"normal",text:"",weight:o.weight,x_shift:0,y_shift:o.blShift,letterSpacing:o.trk||0,strikeThrough:i,strokeWidth:o.sColArr?o.sWidth:0,strokeColor:o.sColArr?this.rgbToHex(o.sColArr):null,strokeOverFill:o.sOverF,family:o.fontFamily};if(null!=d&&d.length)if(null!=(i=d[0].val)&&i.startsWith("JSON3=")){let a=JSON.parse(d[0].val.substring(6)),r=(void 0===(a=Array.isArray(a)?{allCaps:!1,wrapText:!1,globalScale:!1,verticalAlign:0,minFontSize:p,lines:a}:a).verticalAlign&&(a.verticalAlign=0),a.source="complexText",[]),n=null;a.lines.forEach(s=>{s.lead||(s.lead=1),n=Object.assign(Object.assign({},s),{parts:[]}),s.parts.forEach(e=>{"original"===e.weight&&(e.weight=o.weight),"original"===e.style&&(e.style=!0===o.italic?"italic":"normal"),"rel_px"===e.sizeUnits&&(e.size=o.size+e.size),void 0===e.letterSpacing&&(e.letterSpacing=a.letterSpacing||0),e.family||(e.family=o.fontFamily);var[t,...i]=e.text.split("\n");n.parts.push(Object.assign(Object.assign({},e),{text:t})),i.forEach(t=>{r.push(n),n=Object.assign(Object.assign({},s),{parts:[Object.assign(Object.assign({},e),{text:t})]})})}),r.push(n)}),a.fonts||(a.fonts=m),e.text.txtObj=Object.assign(Object.assign({},a),{lines:r})}else{let i=d.some(({blShift:t})=>0!==t),s=o.justif.toLowerCase()[0],a=t=>{var e;return Object.assign(Object.assign({},h),{size:null!=(e=t.size)?e:o.size,text:t.val,y_shift:i?-t.blShift:o.blShift})},r=[],n={align:s,lead:l,parts:[]};for(let e of d){var[f,...g]=e.val.split(c);n.parts.push(a(Object.assign(Object.assign({},e),{val:f}))),g.forEach(t=>{r.push(n),(n={align:s,lead:l,parts:[]}).parts.push(a(Object.assign(Object.assign({},e),{val:t})))})}r.push(n),e.text.txtObj={allCaps:12<=adParams.format.ver&&o.allCaps,wrapText:!0,globalScale:!0,verticalAlign:u,minFontSize:p,lines:r,fonts:m}}else o.txtObj?e.text.txtObj=o.txtObj:e.text.txtObj={allCaps:12<=adParams.format.ver&&o.allCaps,wrapText:!0,globalScale:!0,verticalAlign:u,minFontSize:p,fonts:m,lines:o.txt.split(c).map(t=>({align:o.justif.toLowerCase()[0],lead:l,parts:[Object.assign(Object.assign({},h),{text:t})]}))};e.text.txtObj.fonts||(e.text.txtObj.fonts=m),e.text.txtObj.fonts.forEach(t=>t.family=this.getFontFamily(t.family)),e.text.txtObj.lines.forEach(t=>t.parts.forEach(t=>t.family=this.getFontFamily(t.family))),e.text.txtObj.ver||(e.text.txtObj.ver=0);i={};if(0===e.text.txtObj.ver&&adParams.format.ver<14&&("complexText"===e.text.txtObj.source&&(i.noVerticalScaleDownToFitHeight=!0,o.boxTxtS)&&(i.legacyYCorrectionComplexTextBoxTxt=!0),i.noTrimOverflowedHeight=!0,i.HScaleUse98=!0),e.text.txtObj.features=i,o.boxTxtS)e.text.textBox={x:o.boxTxtP.x,y:o.boxTxtP.y,w:o.boxTxtS.w,h:o.boxTxtS.h};else{var s={x:0,y:.7*-o.size,w:e.text.pointTextWidth,h:.7*o.size+(o.txt.split(c).length-1)*(l*o.size)};switch(o.justif.toLowerCase()){case"left":s.x=0;break;case"right":s.x=-s.w;break;default:s.x=-s.w/2}e.text.textBox=s}}}}function S(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t===e&&s:e.has(t))return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t);throw new TypeError("Cannot read private member from an object whose class did not declare it")}function I(t,e,i,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t===e&&a:e.has(t))return"a"===s?a.call(t,i):a?a.value=i:e.set(t,i),i;throw new TypeError("Cannot write private member to an object whose class did not declare it")}window.clinchPlayer=pt,window.ClinchViewability=function(){this._id=null,this._options={rootMargin:"0px",threshold:[.5]},this._observer,this._undetermined=!1,this._previousIntersectionRatio=null,this._isInView=null,this._inViewDefinition=.5,this._events={},this._viewableImpression={startTime:void 0,timeoutHandler:void 0,fired:!1,minDuration:void 0},this._unsubscribeHandlers=[];function i(){this._viewableImpression.startTime=(new Date).getTime(),this._viewableImpression.timeoutHandler=setTimeout(function(){this._viewableImpression.fired=!0,a.call(this,s["viewable.impression"],{})}.bind(this),this._viewableImpression.minDuration)}this.init=function(t,e){this._id=t,this._viewableImpression.minDuration=e;try{this._observer=new IntersectionObserver(function(t,e){this._previousIntersectionRatio?this._previousIntersectionRatio>t[0].intersectionRatio?(this._viewableImpression.startTime=void 0,clearTimeout(this._viewableImpression.timeoutHandler),this._viewableImpression.timeoutHandler=void 0,a.call(this,s["container.hidden"],{ratio:t[0].intersectionRatio})):(this._viewableImpression.fired||i.call(this),a.call(this,s["container.shown"],{ratio:t[0].intersectionRatio})):(this._isInView=t[0].intersectionRatio>=this._inViewDefinition,this._isInView&&!this._viewableImpression.fired&&(i.call(this),a.call(this,s["container.shown"],{ratio:t[0].intersectionRatio}))),this._previousIntersectionRatio=t[0].intersectionRatio}.bind(this),this._options)}catch(t){return void(this._undetermined=!0)}e="undefined"!=typeof cp_&&(null==(t=null==cp_?void 0:cp_.containerDiv)?void 0:t.ownerDocument)||document;this._observer.observe(e.querySelector("#"+this._id))},this.listen=function(t,e){var i;this._undetermined||(this._events[t]||(this._events[t]=[]),this._events[t].push(e),i=function(){this._events[t]=this._events[t].filter(function(t){return e!==t})}.bind(this),this._unsubscribeHandlers.push(i))},this.unsubscribeAll=function(){for(var t=0;t<this._unsubscribeHandlers.length;t++)this._unsubscribeHandlers[t]()},this.stopObserving=function(){this._observer.unobserve(document.querySelector("#"+this._id))};var s={"container.shown":"container.shown","container.hidden":"container.hidden","viewable.impression":"viewable.impression"},a=function(t,e){t=this._events[t];t&&t.forEach(function(t){t.call(null,e)})}},window.clinchSdk={multiLineSeperatorsStrs:["$$","\r","\n","<br>","<br />","<br/>"],multiLineReplaces:["$$","\r\n","\n\r","\r","\n","<br/>","<br />"],getAdStatus:function(){return cp_.getStatus()},pause:function(){cp_.Pause()},play:function(){cp_.Play()},goTo:function(t){cp_.goTo(t)},mute:function(){cp_.Mute(!0)},unmute:function(){cp_.Mute(!1)},setVolume:function(t){cp_.Volume(t)},addEventListener:function(t,e){cp_.addListener(t,e)},removeEventListener:function(t,e){cp_.removeListener(t,e)},click:function(params){var t=params.type||"",e=params.tags||"",i=params.clickPixels||[];let s=null;adParams.InAdclk&&(a=adParams.InAdclk.trkPerLabel[t||"main"])&&a.lp&&(s=a.lp);var a=params.url||s||adParams.clickUrl||adParams.fbClickUrl,params={x:params.x||0,y:params.y||0},a=k.genClkChain(a);k.reportClick(a,t,e,i,params),k.isMraid()?k.sendMsgToHost("open,"+a):window.open(a,"_blank")},engage:function(params){var t={x:params.x||0,y:params.y||0};k.reportEngage(params.type,params.tags,params.clickPixels,t)},getAdContainer:function(){var t;return null==(t=null==cp_?void 0:cp_.comp)?void 0:t.innerContainer},getExtAdContainer:function(){return cp_.containerDiv},getAdFonts:function(){return[]},getDynImgUrl:function(t,e,i,s,a){return k.getDynImgUrl(t,e,i,s,a)},resizeFontToFitWidth:function(t){try{var e=document.getElementsByClassName(t);if(0!==e.length){var i=document.createElement("canvas").getContext("2d");i.save();for(let t=0;t<e.length;t++){var s=e[t],a=s.children;if(0<a.length){let e=0;for(let t=0;t<a.length;t++){var r,n,o,l,h,c=a[t].innerText;c&&(r=window.getComputedStyle(a[t]))&&(h=r.getPropertyValue("font-size")||"20px",n=r.getPropertyValue("font-weight")||400,o=r.getPropertyValue("font-style")||"normal",l=r.getPropertyValue("font-family")||"",h=parseInt(h),i.font=k.getCtxFont(o,n,h,l),e+=i.measureText(c).width)}if(e){var d=window.getComputedStyle(s).getPropertyValue("width")||"",d=parseInt(d);if(e>.95*d)for(let t=0;t<a.length;t++){var u,p,m=window.getComputedStyle(a[t]),f=(style=>{try{var t,e,i=style.transform||style.webkitTransform||style.mozTransform;return"none"===i?{x:0,y:0,z:0}:(t=i.includes("3d")?"3d":"2d",e=i.match(/matrix.*\((.+)\)/)[1].split(", "),"2d"==t?{x:e[4],y:e[5],z:0}:"3d"==t?{x:e[12],y:e[13],z:e[14]}:void 0)}catch(t){return{x:0,y:0,z:0}}})(m)||{x:0,y:0,z:0};m&&(u=.95*d/e,p=m.getPropertyValue("font-size")||"20px",p=parseInt(p),a[t].style.fontSize=p*u+"px",(f.x||f.y||f.z)&&(a[t].style.transform=""),f.x&&(a[t].style.transform+=" translateX("+f.x*u+"px)"),f.y)&&(a[t].style.transform+=" translateY("+f.y*u+"px)")}}}else{var g,v,y,x,w,b,C,T=s.innerText;T&&(g=window.getComputedStyle(s))&&(v=g.getPropertyValue("font-weight")||400,y=g.getPropertyValue("font-style")||"normal",x=g.getPropertyValue("font-size")||"20px",w=g.getPropertyValue("font-family")||"",b=g.getPropertyValue("width")||"")&&(b=parseInt(b),x=parseInt(x),i.font=k.getCtxFont(y,v,x,w),.95*b<(C=i.measureText(T).width))&&(s.style.fontSize=parseInt(x*(.95*b)/C)+"px")}}}}catch(t){}},resizeFontToFitWidthForMultiLine:function(t){try{var e=document.getElementsByClassName(t),o=document.createElement("canvas").getContext("2d");if(o.save(),0!==e.length)for(let t=0;t<e.length;t++){var l=e[t],i=window.getComputedStyle(l);if(i){let a,r,n;l.dataset.originTxt?(a=l.dataset.originTxt,r=parseInt(l.dataset.originFontSize),n=parseFloat(l.dataset.originLineHeight)):(a=l.innerHTML,r=i.getPropertyValue("font-size")||"20px",r=parseInt(r),n=i.getPropertyValue("line-height"),n=parseFloat(n)||r,l.dataset.originTxt=a,l.dataset.originFontSize=r,l.dataset.originLineHeight=n);var h=parseInt(l.dataset.minFontSize)||10,c=i.getPropertyValue("font-weight")||400,d=i.getPropertyValue("font-style")||"normal",u=i.getPropertyValue("font-family")||"",p=i.getPropertyValue("width")||"",m=l.dataset.maxHeight||i.getPropertyValue("height")||"";if(p&&m){p=parseInt(p),m=parseInt(m);let s=parseFloat(n/r),e=(s<1&&(s=1),!1);for(let t=0;t<clinchSdk.multiLineSeperatorsStrs.length;t++)if(-1<a.indexOf(clinchSdk.multiLineSeperatorsStrs[t])){e=!0;for(let t=0;t<clinchSdk.multiLineReplaces.length;t++)a=a.replace(new RegExp(clinchSdk.multiLineReplaces[t],"g"),"<br>");break}if(e){var f=a.split("<br>");if(f&&0<f.length){var g=f[0];let e=o.measureText(g).width;for(let t=1;t<f.length;t++){var v=f[t],y=o.measureText(v).width;y>e&&(e=y,0)}let t=1;e>.95*p&&(t=e/(.95*p));var x,w=n*f.length;.98*m<w&&(x=w/(.98*m))>t&&(t=x),l.innerHTML=f.join("<br>"),Math.floor(r/t)<h&&(t=r/h),l.style.fontSize=Math.floor(r/t)+"px",l.style.lineHeight=n/t+"px"}}else{let e={status:"ok",lines:[a]};var b=a;let i=r;r<=h&&k.log("ClinchSdk: resizeFontToFitWidthForMultiLine font size smaller than minimum font size."),m<r&&k.log("ClinchSdk: resizeFontToFitWidthForMultiLine div height is less then font size.");for(let t=r;t>=h;t--){var C=Math.floor(m/(t*s)),T=(i=t)===h;if(o.font=k.getCtxFont(d,c,t,u),"ok"===(e=k.wrapText(o,b,p,C,!0,T)).status)break}l.innerHTML=e.lines.join("<br>"),l.style.fontSize=i+"px",l.style.lineHeight=n*(i/r)+"px"}}}}}catch(t){}},isMobile:function(){return k.isMobile()}};class mt{constructor(){e.add(this),s.set(this,[]),i.set(this,null),a.set(this,null),r.set(this,null),n.set(this,!1),this.fireMouseEnter=this.fireMouseEnter.bind(this),this.fireMouseLeave=this.fireMouseLeave.bind(this),this.handleVisibilityChange=this.handleVisibilityChange.bind(this)}init(){window.addEventListener("load",()=>{var t=clinchSdk.getAdContainer();if(!(!1 in window)&&t)try{t.addEventListener("mouseenter",this.fireMouseEnter),t.addEventListener("mouseleave",this.fireMouseLeave),document.addEventListener("visibilitychange",this.handleVisibilityChange),I(this,r,new IntersectionObserver(t=>{var t=t[0].intersectionRatio,e=!!S(this,a,"f"),t=.5<=t;e&&!t&&this.fireOutOfView(),!e&&t&&this.fireInView()},{threshold:[.5]}),"f"),S(this,r,"f").observe(t),window.addEventListener("beforeunload",()=>{this.fireSummery()}),setTimeout(()=>this.fireSummery(),6e5)}catch(t){S(this,e,"m",o).call(this,{stype:"error",message:t.message})}})}fireInView(){I(this,a,(new Date).getTime(),"f"),S(this,e,"m",o).call(this,{stype:"in_view"})}fireOutOfView(){var t;S(this,a,"f")&&(t=((new Date).getTime()-S(this,a,"f"))/1e3,I(this,a,null,"f"),S(this,e,"m",o).call(this,{stype:"out_of_view",duration:t}))}fireMouseEnter(){I(this,i,(new Date).getTime(),"f"),S(this,e,"m",o).call(this,{stype:"hover_in"})}fireMouseLeave(){var t;S(this,i,"f")&&(t=((new Date).getTime()-S(this,i,"f"))/1e3,I(this,i,null,"f"),S(this,e,"m",o).call(this,{stype:"hover_out",duration:t}))}handleVisibilityChange(){document.hidden&&this.fireSummery()}fireSummery(){try{var t;S(this,n,"f")||(I(this,n,!0,"f"),(t=clinchSdk.getAdContainer()).removeEventListener("mouseenter",this.fireMouseEnter),t.removeEventListener("mouseleave",this.fireMouseLeave),document.removeEventListener("visibilitychange",this.handleVisibilityChange),S(this,r,"f").disconnect(),S(this,i,"f")&&this.fireMouseLeave(),S(this,a,"f")&&this.fireOutOfView(),S(this,e,"m",o).call(this,{stype:"aggregate",allevents:JSON.stringify(S(this,s,"f"))}))}catch(t){S(this,e,"m",o).call(this,{stype:"error",message:t.message})}}}s=new WeakMap,i=new WeakMap,a=new WeakMap,r=new WeakMap,n=new WeakMap,e=new WeakSet,o=function(t){var e,i,params=new URLSearchParams(FB.pxlDims);S(this,s,"f").push(t);for([e,i]of Object.entries(t))params.set(e,i);(new Image).src=FB.trkHost+"/att?"+params.toString()};let ft=new mt;"toJSON"in Error.prototype||Object.defineProperty(Error.prototype,"toJSON",{value:function(){let e={};return Object.getOwnPropertyNames(this).forEach(function(t){e[t]=this[t]},this),e},configurable:!0,writable:!0}),window.addEventListener("message",k.receiveMsg);try{Element.prototype.hasClass=function(t){return new RegExp(" "+t+" ").test(" "+this.className+" ")},Element.prototype.addClass=function(t){this.hasClass(t)||(this.className+=" "+t)},Element.prototype.removeClass=function(t){let e=" "+this.className.replace(/[\t\r\n]/g," ")+" ";if(this.hasClass(t)){for(;0<=e.indexOf(" "+t+" ");)e=e.replace(" "+t+" "," ");this.className=e.replace(/^\s+|\s+$/g,"")}},Element.prototype.remove=function(){null!=this.parentNode&&this.parentNode.removeChild(this)},Element.prototype.offset=function(){var t,e=this&&this.ownerDocument,i={top:0,left:0};if(e)return t=e.documentElement,null==this.parentNode?i:(i=this.getBoundingClientRect(),e=9===e.nodeType&&e.defaultView,{top:i.top+e.pageYOffset-t.clientTop,left:i.left+e.pageXOffset-t.clientLeft})}}catch(t){k.reportExceptionError("elements_proto_declare",t)}"true"===adParams.custom.attentionEvents&&ft.init();
