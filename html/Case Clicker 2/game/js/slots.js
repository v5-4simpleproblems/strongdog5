import{user as i,goToPreviousPage as s}from"/script.js?v=2.19";import{game as e}from"/js/game.js?v=2.19";import{openWithdrawPrompt as t,tradeIn as n}from"./casino.js?v=2.19";import{addStat as l}from"/js/stats.js?v=2.19";import{getRandomRarity as c,giveItem as o}from"./items.js?v=2.19";import{Pages as r}from"/js/pages.js?v=2.19";import{global as a}from"/script.js?v=2.19";import{getCurrency as d}from"/js/prefs.js?v=2.19";const g=r.createPage("slots").q(".center");g.q(".roulette-fade-overlay");g.q("h1",{text:"Slot Machine"});const m=g.q(".coins",{text:"You have x chips."});const p=g.q();p.q("button.button",{text:"Back",onclick(){s()}});const u=p.q("button.button",{text:"Trade in Skins to Chips",onclick(){n()}});p.q("button.button",{text:"Withdraw Chips to "+d(),onclick(){t()}});e.on("update",(()=>{m.innerText=`You have ${Math.floor(i.tokens).toLocaleString()} chips.`;u.classList.toggle("btn-arrow-highlight",i.tokens<10)}));const h={KNIFE:{},SEVEN:{2:7,3:77,4:777,5:77777},DICE:{2:2,3:20,4:200,5:2e3,jackpot:2e4},HEART:{3:2,4:4,5:10},DIAMOND:{3:2,4:6,5:20},SPADES:{3:5,4:25,5:250},CLUBS:{3:7,4:30,5:300}};function w(){const i=Math.random();if(i<.015)return"KNIFE";if(i<.015+.05)return"SEVEN";if(i<.065+.115)return"DICE";if(i<.18+.25)return"HEART";if(i<.43+.21)return"DIAMOND";if(i<.64+.18)return"SPADES";return"CLUBS"}const v=g.q(".slots-columns");const f=g.q(".slots-win-text");let x=false;let b=true;function _(s){a.noSpoilers=true;b=true;const t=document.body.q(".dice-throw-popup");let n=s*(h.DICE.jackpot-h.DICE[5]);t.q(".dice-throw-popup-title",{text:"Dice Throw!"});t.q(".dice-throw-popup-description",{text:"If the dice lands on 6, you win "+n+" extra chips!"});const c=t.q(".dice-throw-dice-container");const o=c.q(".dice-throw-dice",{html:`\n      <div class="dice-face dice-front">\n        <div class="dice-dot dice-dot-1"></div>\n      </div>\n      <div class="dice-face dice-back">\n        <div class="dice-dot dice-dot-2"></div>\n        <div class="dice-dot dice-dot-3"></div>\n      </div>\n      <div class="dice-face dice-right">\n        <div class="dice-dot dice-dot-1"></div>\n        <div class="dice-dot dice-dot-2"></div>\n        <div class="dice-dot dice-dot-3"></div>\n      </div>\n      <div class="dice-face dice-left">\n        <div class="dice-dot dice-dot-2"></div>\n        <div class="dice-dot dice-dot-3"></div>\n        <div class="dice-dot dice-dot-4"></div>\n        <div class="dice-dot dice-dot-5"></div>\n      </div>\n      <div class="dice-face dice-top">\n        <div class="dice-dot dice-dot-1"></div>\n        <div class="dice-dot dice-dot-2"></div>\n        <div class="dice-dot dice-dot-3"></div>\n        <div class="dice-dot dice-dot-4"></div>\n        <div class="dice-dot dice-dot-5"></div>\n      </div>\n      <div class="dice-face dice-bottom">\n        <div class="dice-dot dice-dot-2"></div>\n        <div class="dice-dot dice-dot-3"></div>\n        <div class="dice-dot dice-dot-4"></div>\n        <div class="dice-dot dice-dot-5"></div>\n        <div class="dice-dot dice-dot-6"></div>\n        <div class="dice-dot dice-dot-7"></div>\n      </div>\n    `});function r(){return Math.floor(Math.random()*2+2)*360}o.style.transform=`translateZ(500px)`;setTimeout((()=>{let s=Math.floor(Math.random()*6);let c=0;let d=0;let g=0;if(s===0){c=r();d=0;g=Math.random()*90}else if(s===1){c=r();d=180;g=Math.random()*90}else if(s===2){c=90+r();d=Math.random()*90;g=90}else if(s===3){c=270+r();d=Math.random()*90;g=90}else if(s===4){c=270+r();d=Math.random()*90;g=0}else if(s===5){c=90+r();d=Math.random()*90;g=0}o.style.transform=`translateZ(0px) rotateX(${c}deg) rotateY(${d}deg) rotateZ(${g}deg)`;setTimeout((()=>{if(s===5){t.q(".dice-throw-result","Wow! You won "+n+" chips!");i.tokens+=n;t.q(".button","Go back!",{onclick(){document.body.removeChild(t)}});l("win_chips",n);l("win_chips_on_slotmachine",n);l("win_dice_throw_on_slotmachine",1);a.noSpoilers=false;e.emit("update")}else{t.q(".dice-throw-result","Dang!");t.q(".button","Go back",{onclick(){document.body.removeChild(t)}})}}),3100)}),100)}function k(s){if(s===0)return;if(i.tokens>=s){i.tokens-=s;l("spend_chips",s);l("spend_chips_on_slotmachine",s)}else return;a.noSpoilers=false;e.emit("update");v.innerHTML="";let t=[];for(let i=0;i<5;i++){t.push([w(),w(),w()])}let n=[];let r=0;for(let i=0;i<3;i++){let e=t[0][i];for(let s=0;s<5;s++){if(t[s][i]==="KNIFE")r++}let l=0;for(let s=0;s<5;s++){if(e===t[s][i])l+=1;else break}let c=h[e][l]?h[e][l]/(i===1?1:2):0;let o=c*s;n[i]={winIcon:e,winLength:l,win:c,winAmount:o}}r=s>0&&r>=3;if(r)b=true;let d=[0,0,0];for(let i=0;i<5;i++){const s=v.q(".slots-column");for(let e=0;e<3;e++){const l=s.q(".slots-slot.slots-slot-"+t[i][e]);if(t[i][e]==="DICE")l.classList.add("slots-slot-DICE-"+ ++d[e]);setTimeout((()=>{l.classList.add("slots-animate-in-now")}),100*i+50*e);if(n[e].win&&i<n[e].winLength||r&&t[i][e]==="KNIFE")setTimeout((()=>{l.classList.add("slots-win-jumping")}),100*i+50*e+450);else setTimeout((()=>{l.classList.add("slots-fade-out")}),100*i+50*e+450)}}setTimeout((()=>{if(s<=0)return;let t=0;let d=0;let g=0;n.forEach(((i,e)=>{t+=i.winAmount;d+=i.win;if(i.win&&i.winLength===5)l("get_5_in_a_row_on_slotmachine",1);if(i.winIcon==="DICE"&&i.winLength===5)g+=s*(e===1?1:.5)}));if(g)_(g);i.tokens+=t;l("win_chips",t);l("win_chips_on_slotmachine",t);if(d>100)l("win_100x_on_slotmachine",1);f.innerText="You won "+t+" chips!";e.emit("update");if(r){l("win_special_on_slotmachine",1);o(c(6),1,true)}a.noSpoilers=false}),1e3)}k(0);let I=0;const M=g.q(".casino-bet-amount-selector-simple",{style:{margin:"20px"}});M.q("button.button",{text:"Min",onclick(){T(10)}});M.q("button.button",{text:"-",onclick(){T(I/2)}});const E=M.q("input.input",{onfocus(){this.value=I;this.previousValue=parseInt(this.value)},oninput(){T(Number.isFinite(parseInt(this.value))?parseInt(this.value):this.previousValue,false)},onblur(){T(Number.isFinite(parseInt(this.value))?parseInt(this.value):this.previousValue)}});M.q("button.button",{text:"+",onclick(){T(I*2)}});M.q("button.button",{text:"Max",onclick(){T(i.tokens)}});const S=g.q("button.button",{onclick(){k(I)}});function T(s=10,e=true){if(s<10)s=10;if(s>i.tokens)s=i.tokens;if(i.upgrades.maxbet!==-1&&s>Math.floor(i.upgrades.maxbet/100*8))s=Math.floor(i.upgrades.maxbet/100*8);I=Math.floor(s/10)*10;S.innerText=`Spin for ${I} chips!`;if(e)E.value=I>=100?I:I+" chips"}function D(){b=false;x=true;j.innerText="Stop Auto Spin";k(I);let i=setInterval((()=>{if(b){clearInterval(i);x=false;j.innerText="Auto Spin"}else k(I)}),1e3)}e.on("showPage",(i=>{if(i.page!=="slots")b=true}));const j=g.q("button.button",{text:"Auto Spin",style:{marginTop:"20px"},onclick(){if(x)b=true;else D()}});T();g.q("",{style:{textAlign:"center",marginTop:"20px"},children:["Get as many icons as possible in a row, from the first column.",q("br"),"Minimum bet: 10 chips — Bet interval: 10 chips",q(".slots-win-table",{children:[q(".slots-win-table-title","Possible Winnings:"),q(".slots-win-row",{children:[q(".slots-win-cell",{children:[q("img",{src:"images/sevens.png"}),q("img",{src:"images/sevens.png"}),q(".slots-win-cell-multiplier",{text:"= 7x"})]}),q(".slots-win-cell",{children:[q("img",{src:"images/sevens.png"}),q("img",{src:"images/sevens.png"}),q("img",{src:"images/sevens.png"}),q(".slots-win-cell-multiplier",{text:"= 77x"})]}),q(".slots-win-cell",{children:[q("img",{src:"images/sevens.png"}),q("img",{src:"images/sevens.png"}),q("img",{src:"images/sevens.png"}),q("img",{src:"images/sevens.png"}),q(".slots-win-cell-multiplier",{text:"= 777x"})]}),q(".slots-win-cell",{children:[q("img",{src:"images/sevens.png"}),q("img",{src:"images/sevens.png"}),q("img",{src:"images/sevens.png"}),q("img",{src:"images/sevens.png"}),q("img",{src:"images/sevens.png"}),q(".slots-win-cell-multiplier",{text:"= 77.777x"})]})]}),q(".slots-win-row",{children:[q(".slots-win-cell",{children:[q("img",{src:"images/dice_1.png"}),q("img",{src:"images/dice_2.png"}),q(".slots-win-cell-multiplier",{text:"= 2x"})]}),q(".slots-win-cell",{children:[q("img",{src:"images/dice_1.png"}),q("img",{src:"images/dice_2.png"}),q("img",{src:"images/dice_3.png"}),q(".slots-win-cell-multiplier",{text:"= 20x"})]}),q(".slots-win-cell",{children:[q("img",{src:"images/dice_1.png"}),q("img",{src:"images/dice_2.png"}),q("img",{src:"images/dice_3.png"}),q("img",{src:"images/dice_4.png"}),q(".slots-win-cell-multiplier",{text:"= 200x"})]}),q(".slots-win-cell",{children:[q("img",{src:"images/dice_1.png"}),q("img",{src:"images/dice_2.png"}),q("img",{src:"images/dice_3.png"}),q("img",{src:"images/dice_4.png"}),q("img",{src:"images/dice_5.png"}),q(".slots-win-cell-multiplier",{text:"= 2.000x"})]})]}),q(".slots-win-row",{children:[q(".slots-win-cell",{children:[q("img",{src:"images/hearts.png"}),q("img",{src:"images/hearts.png"}),q("img",{src:"images/hearts.png"}),q(".slots-win-cell-multiplier",{text:"= 2x"})]}),q(".slots-win-cell",{children:[q("img",{src:"images/hearts.png"}),q("img",{src:"images/hearts.png"}),q("img",{src:"images/hearts.png"}),q("img",{src:"images/hearts.png"}),q(".slots-win-cell-multiplier",{text:"= 4x"})]}),q(".slots-win-cell",{children:[q("img",{src:"images/hearts.png"}),q("img",{src:"images/hearts.png"}),q("img",{src:"images/hearts.png"}),q("img",{src:"images/hearts.png"}),q("img",{src:"images/hearts.png"}),q(".slots-win-cell-multiplier",{text:"= 10x"})]})]}),q(".slots-win-row",{children:[q(".slots-win-cell",{children:[q("img",{src:"images/diamonds.png"}),q("img",{src:"images/diamonds.png"}),q("img",{src:"images/diamonds.png"}),q(".slots-win-cell-multiplier",{text:"= 2x"})]}),q(".slots-win-cell",{children:[q("img",{src:"images/diamonds.png"}),q("img",{src:"images/diamonds.png"}),q("img",{src:"images/diamonds.png"}),q("img",{src:"images/diamonds.png"}),q(".slots-win-cell-multiplier",{text:"= 6x"})]}),q(".slots-win-cell",{children:[q("img",{src:"images/diamonds.png"}),q("img",{src:"images/diamonds.png"}),q("img",{src:"images/diamonds.png"}),q("img",{src:"images/diamonds.png"}),q("img",{src:"images/diamonds.png"}),q(".slots-win-cell-multiplier",{text:"= 20x"})]})]}),q(".slots-win-row",{children:[q(".slots-win-cell",{children:[q("img",{src:"images/spades.png"}),q("img",{src:"images/spades.png"}),q("img",{src:"images/spades.png"}),q(".slots-win-cell-multiplier",{text:"= 5x"})]}),q(".slots-win-cell",{children:[q("img",{src:"images/spades.png"}),q("img",{src:"images/spades.png"}),q("img",{src:"images/spades.png"}),q("img",{src:"images/spades.png"}),q(".slots-win-cell-multiplier",{text:"= 25x"})]}),q(".slots-win-cell",{children:[q("img",{src:"images/spades.png"}),q("img",{src:"images/spades.png"}),q("img",{src:"images/spades.png"}),q("img",{src:"images/spades.png"}),q("img",{src:"images/spades.png"}),q(".slots-win-cell-multiplier",{text:"= 250x"})]})]}),q(".slots-win-row",{children:[q(".slots-win-cell",{children:[q("img",{src:"images/clubs.png"}),q("img",{src:"images/clubs.png"}),q("img",{src:"images/clubs.png"}),q(".slots-win-cell-multiplier",{text:"= 7x"})]}),q(".slots-win-cell",{children:[q("img",{src:"images/clubs.png"}),q("img",{src:"images/clubs.png"}),q("img",{src:"images/clubs.png"}),q("img",{src:"images/clubs.png"}),q(".slots-win-cell-multiplier",{text:"= 30x"})]}),q(".slots-win-cell",{children:[q("img",{src:"images/clubs.png"}),q("img",{src:"images/clubs.png"}),q("img",{src:"images/clubs.png"}),q("img",{src:"images/clubs.png"}),q("img",{src:"images/clubs.png"}),q(".slots-win-cell-multiplier",{text:"= 300x"})]})]}),q(".slots-win-row",{children:[q(".slots-win-cell",{children:[q("img",{src:"images/dice_1.png"}),q("img",{src:"images/dice_2.png"}),q("img",{src:"images/dice_3.png"}),q("img",{src:"images/dice_4.png"}),q("img",{src:"images/dice_5.png"}),q(".slots-win-cell-text","& dice throw on "),q("img",{src:"images/dice_6.png"}),q(".slots-win-cell-multiplier",{text:"= 20.000x"})]}),q(".slots-win-cell",{children:[q("img",{src:"images/special-item.png"}),q("img",{src:"images/special-item.png"}),q("img",{src:"images/special-item.png"}),q(".slots-win-cell-text","at any position"),q(".slots-win-cell-multiplier",{text:"= RANDOM KNIFE"})]})]}),q(".slots-win-table-title","Top and bottom row gives ½x Winnings")]})]});